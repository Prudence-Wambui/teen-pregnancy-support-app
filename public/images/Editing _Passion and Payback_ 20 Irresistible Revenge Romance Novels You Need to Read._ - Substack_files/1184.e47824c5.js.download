"use strict";(self.webpackChunksubstack=self.webpackChunksubstack||[]).push([["1184"],{83234:function(e,t,i){i.d(t,{Z:()=>n});let n={unreadDot:"unreadDot-O7Wu_7"}},16104:function(e,t,i){i(16584),i(64515)},32582:function(e,t,i){i.d(t,{G6:()=>F,PH:()=>O});var n=i(7409),l=i(99282),r=i(16584),o=i(6400),a=i(30396),s=i(85564),c=i.n(s),d=i(84753),u=i.n(d),h=i(43174),p=i.n(h),m=i(89734),b=i.n(m),v=i(45578),g=i.n(v),f=i(20042),w=i(80569),Z=i.n(w),_=i(20253),y=i(39535),N=i(94499),k=i(30363),S=i(32261),B=i(98914),E=i(15771),I=i(43570),C=i(98012),R=i(60308),P=i(26111),A=i(47929);let D=e=>{let{onClick:t,checked:i}=e;return(0,r.BX)("div",{className:"select-all",children:[(0,r.tZ)("input",{name:"all",type:"checkbox",onInput:t,checked:i}),(0,r.BX)("label",{for:"all",onClick:t,children:["Select ",i?"none":"all"]})]})},X=e=>{let{disabled:t,onClick:i,children:n}=e;return(0,r.tZ)(E.zx,{type:"submit",priority:"primary",size:"lg",disabled:t,onClick:i,children:n})},O=e=>{let{extraProps:t={},linkType:i=null,discoverable:o=null,text:a,icon:s=!0,onClick:c=null}=e,d={};null!==i&&(d.type=i),null!==o&&(d.discoverable=o);let u=(0,R.nRe)(d);return(0,r.tZ)("div",(0,l._)((0,n._)({className:"twitter-discover"},t),{children:(0,r.tZ)("a",(0,l._)((0,n._)({className:"twitter-link",href:u},c&&{onClick:c}),{native:!0,children:(0,r.BX)("div",{className:"inner",children:[s&&(0,r.tZ)(y.Z,{fill:"white"}),(0,r.tZ)("span",{className:"twitter-link-text",children:a||"Find writers and creators I follow"})]})}))}))},T=e=>{let{pub:t,checked:i,onToggle:n,isSubscribed:l,author:o,screenName:a}=e;return(0,r.tZ)("li",{className:"linked-pub",children:(0,r.BX)("div",{className:"linked-pub",children:[(0,r.BX)("div",{className:"photo",children:[(0,r.tZ)("div",{className:"subscribed-status",children:(0,r.tZ)("input",{type:"checkbox",checked:i||l,disabled:l,onInput:()=>n(t.id)})}),(0,r.tZ)(S.fi,{size:60,photo_url:o.photo_url}),(0,r.BX)("div",{className:"twitter-handle",children:[(0,r.tZ)("span",{className:"author",children:null==o?void 0:o.name}),(0,r.BX)("span",{className:"handle",children:[" @",a]})]})]}),(0,r.tZ)("div",{className:"info",children:(0,r.tZ)("div",{className:"publication-row",children:(0,r.tZ)("a",{className:"publication",href:(0,R.rhs)("".concat((0,R.SVA)(t),"/"),{utm_source:A.b3.substack,utm_medium:A.lP.web,utm_content:A.fZ.discoverTwitter}),target:"_blank",native:!0,children:(0,r.tZ)(k.ZP,{publication:t,logo_size:30,children:l?(0,r.tZ)("div",{className:"subscribed",children:(0,r.tZ)(I.Vp,{children:"Subscribed"})}):null})})})})]})})},x=e=>{var t;let{result:i,selectedPubs:n,onToggle:l}=e,{publicationAuthor:o,screen_name:a,publication_id:s}=i,{name:c,ownedPublications:d}=o,u=g()(d,e=>e.id),h=b()(u,e=>{var t;return(null===(t=e.latestPost)||void 0===t?void 0:t[0])?(0,C.Z)(e.latestPost[0].post_date).toDate():C.Z.unix(1).toDate()}).reverse(),p=o.photo_url||(null===(t=d.find(e=>e.id===s))||void 0===t?void 0:t.logo_url);return h.map(e=>{var t;let i=!!(null===(t=e.subscriptions)||void 0===t?void 0:t.length);return(0,r.tZ)(T,{author:o,screenName:a,authorName:c,showLogo:p!==o.photo_url,pub:e,checked:n.has(e.id),onToggle:l,isSubscribed:i})})},z=e=>{let{user:t,freeSignupEmail:i,twitterEmail:n,twitterToken:l,onConfirmed:o,onSubscribed:s,formAction:c,pubIds:d,subscribeToken:u,redirect:h,showDiscover:p,editable:m,showLogout:b}=e,v=(null==t?void 0:t.email)||i||n,[g,f]=(0,a.eJ)(!1),[w,Z]=(0,a.eJ)(!0),[y,N]=(0,a.eJ)(v);h=d?(0,R.rhs)(h,{pubIds:d,t:l}):(0,R.rhs)(h,{t:l,d:w});let k=e=>{let{userExists:t,subscribed:i}=e.body;i?null==s||s(i):t?t&&(0,B.uX)((0,R.n1t)("".concat((0,R.ZJn)(),"/sign-in"),{with_password:!1,email:y,redirect:h})):null==o||o()};return(0,r.tZ)("div",{className:"twitter-publications container",children:(0,r.tZ)("section",{children:(0,r.tZ)("div",{className:"terms-check",children:(0,r.BX)(_.ZP,{onSuccess:e=>k(e),method:"post",action:c,loading:!1,autoLock:!0,children:[(0,r.tZ)("input",{name:"t",type:"hidden",value:l}),d&&(0,r.tZ)("input",{name:"pubIds",type:"hidden",value:d}),u&&(0,r.tZ)("input",{name:"subscribeToken",type:"hidden",value:u}),(0,r.tZ)("input",{name:"email",type:"text",disabled:!m&&!!v,value:y,onInput:e=>{N(e.target.value)}}),(0,r.BX)("label",{children:[(0,r.tZ)("input",{type:"checkbox",checked:g,onInput:()=>f(!g)}),"I accept the"," ",(0,r.tZ)("a",{href:"/tos",target:"_blank",native:!0,children:"Terms of Use"})]}),p&&(0,r.BX)("label",{children:[(0,r.tZ)("input",{name:"allow_discover",type:"checkbox",checked:w,onInput:()=>Z(!g)}),"Allow people to find my publications via Twitter"]}),b&&(0,r.tZ)("label",{children:(0,r.tZ)("a",{className:"login-button",href:(0,R.ZPN)(),native:!0,children:"Not you?"})}),(0,r.tZ)(X,{disabled:!g,children:"Next â†’"})]})})})})},F=e=>{let t,{user:i,stage:n,twitterEmail:l,freeSignupEmail:s,twitterToken:d,buttonText:u=null,onSignup:h=null,requireSignup:p=!0,needsEmailConfirm:m=!0,renderIfNoneFound:b=null,useProfilePrefix:v=!1}=e,[g,w]=(0,a.eJ)(null),[_,y]=(0,a.eJ)(null),[N,k]=(0,a.eJ)(null),[S,B]=(0,a.eJ)(null),[E,I]=(0,a.eJ)(!m),[C,R]=(0,a.eJ)(null),[A,D]=(0,a.eJ)(!1),[X,T]=(0,a.eJ)(new Set),[x,F]=(0,a.eJ)(null),J=(0,P.x)("subscribed"),j=v?"/profile":"";J?h?h():(k(J.split(",")),(0,f.route)("/discover-twitter/success")):!n||"connect"===n||g||N||(0,f.route)("/discover-twitter");let G=e=>c()(e.map(e=>{var t;return(null===(t=e.publicationAuthor)||void 0===t?void 0:t.ownedPublications)||[]}));(0,a.d4)(()=>{(async()=>{if(!A){D(!0);try{let e=(await Z().get("/api/v1/twitter/publications")).body;if("needsConnect"in e&&e.needsConnect)(0,f.route)("/discover-twitter/connect");else{let t;let{results:i,subscribeToken:n,needsTwitterConfirm:l}=e,r=G(i),o=new Set(r.filter(e=>{var t;return(null===(t=e.subscriptions)||void 0===t?void 0:t.length)===0}).map(e=>e.id));t=o.size<=30?new Set(o):new Set,w(i),R(!1),F(n),y(o),T(t),B(!l)}}catch(e){R(e)}D(!1)}})()},[]),g&&(g.length>0?t=S?"We found ".concat(g.length," account").concat(g.length>1?"s":""," you follow on Twitter"):"Confirm your email to see ".concat(g.length," account").concat(g.length>1?"s":""," you follow on Twitter"):S||(t="Confirm your email to continue")),"confirm"===n&&(t="Confirm your email"),N&&(t="Success!");let W=g?G(g):null,M=async()=>{D(!0);try{let e=await Z().post("/api/v1/twitter/subscribe").send({pubIds:[...X].join(","),t:d,subscribeToken:x});if(h)h();else{let{subscribed:t}=e.body;k(t),(0,f.route)("/discover-twitter/success")}}catch(e){console.error("error subscribing",e)}D(!1)};return(0,r.BX)("div",{className:"twitter-publications pub-list",children:[(0,r.tZ)("h2",{className:n,children:t}),A&&(0,r.tZ)("p",{className:"loading",children:"Loading..."}),C&&(0,r.BX)(o.Fragment,{children:[(0,r.tZ)("p",{className:"error",children:"Sorry, there was an error getting your results!"}),(0,r.tZ)("div",{className:"banner",children:(0,r.tZ)(O,{})})]}),(0,r.BX)(f.default,{children:[g&&!N&&S&&!A&&(0,r.tZ)(L,{path:"".concat(j,"/discover-twitter"),results:g,selectedPubs:X,subscribablePubs:null!=_?_:new Set([]),onToggleChecked:e=>{let t=new Set(X);X.has(e)?t.delete(e):t.add(e),T(t)},onToggleAll:e=>{let t;T(e?new Set(_):new Set)},onNext:()=>{!m||E?M():(0,f.route)("/discover-twitter/confirm")},loading:A,buttonText:u,requireSignup:p,renderIfNoneFound:b}),!1==S&&(0,r.tZ)(z,{path:"".concat(j,"/discover-twitter"),formAction:"/api/v1/twitter/confirm",redirect:"/api/v1/twitter/continue-confirm",user:i,onConfirmed:()=>{I(!0),B(!0)},twitterEmail:l,twitterToken:d,freeSignupEmail:s,pubIds:[...X],showDiscover:!0}),!E&&(0,r.tZ)(z,{path:"".concat(j,"/discover-twitter/confirm"),redirect:"/api/v1/twitter/continue-subscribe",formAction:"/api/v1/twitter/subscribe",user:i,onSubscribed:e=>{k(e),(0,f.route)("/discover-twitter/success")},twitterEmail:l,twitterToken:d,freeSignupEmail:s,pubIds:[...X],subscribeToken:x,editable:!1,showLogout:!0}),g&&N&&(0,r.tZ)(U,{path:"".concat(j,"/discover-twitter/success"),user:i,subscribed:N,pubs:null!=W?W:[],results:g})]})]})},J=e=>{let{pub:t,result:i}=e,{hero_text:n,stripeAccount:l,logo_url:o}=t,{screen_name:a,publicationAuthor:{name:s,photo_url:c}}=i,d=null==l?void 0:l.plans;return(0,r.tZ)("li",{className:"linked-pub subscribed",children:(0,r.BX)("div",{className:"linked-pub",children:[(0,r.tZ)("div",{className:"photo",children:(0,r.tZ)(S.fi,{size:60,photo_url:o||c})}),(0,r.tZ)("div",{className:"info",children:(0,r.BX)("div",{className:"publication-row",children:[(0,r.BX)("div",{className:"publication",children:[(0,r.BX)("div",{className:"name",children:["@",a," - ",s]}),(0,r.tZ)("div",{className:"description",children:n})]}),(0,r.tZ)("div",{children:d&&(0,r.tZ)(N.Z,{className:"outline small button",href:"".concat((0,R.SVA)(t),"/subscribe"),target:"_blank",children:"Upgrade"})})]})})]})})},U=e=>{let{subscribed:t,pubs:i,results:n}=e,l=g()(i.filter(e=>t.find(t=>t===e.subdomain)),e=>e.id),[a,s]=p()(l,e=>{var t;return null===(t=e.stripeAccount)||void 0===t?void 0:t.plans}),c=[...a,...s].length>1,d=a.length>1;return(0,r.BX)("ul",{children:[(0,r.tZ)("div",{className:"sign-up",children:a.length>0?(0,r.BX)(o.Fragment,{children:[d?"".concat(a.length," of the newsletters"):c?"One of the newsletters":"The newsletter"," ","you subscribed to ",d?"have":"has"," a paid version. You can upgrade"," ",d?"those subscriptions":"that subscription"," now or later."]}):"You're subscribed to the free version of ".concat(c?"these newsletters":"this newsletter",".  Happy reading!")}),[...a,...s].map(e=>{let t=n.find(t=>{var i;return t.screen_name===(null===(i=e.twitterAccount)||void 0===i?void 0:i.screen_name)});return t?(0,r.tZ)(J,{pub:e,result:t}):null})]})},j=e=>{let{onNext:t}=e;return(0,r.tZ)("div",{children:(0,r.BX)("ul",{children:[(0,r.tZ)("p",{children:"It doesn't appear anyone you follow on Twitter has a Substack yet. We'll let you know if that changes."}),(0,r.tZ)(N.Z,{className:"primary button",onClick:()=>{t()},children:"Continue"})]})})},L=e=>{let{results:t,selectedPubs:i,onNext:n,onToggleChecked:l,onToggleAll:a,subscribablePubs:s,loading:c,buttonText:d,requireSignup:h,renderIfNoneFound:m}=e;if(0===t.length)return m||(0,r.tZ)(j,{onNext:n});let v=b()(t,e=>{var t,i,n;let l;return(null==(l=(null===(t=e.publicationAuthor)||void 0===t?void 0:t.ownedPublications)?u()(e.publicationAuthor.ownedPublications,e=>{var t;return(null===(t=e.latestPost)||void 0===t?void 0:t[0])?(0,C.Z)(e.latestPost[0].post_date).toDate():null}):null)?void 0:null===(i=l.latestPost)||void 0===i?void 0:i[0])?(0,C.Z)(null===(n=l.latestPost[0])||void 0===n?void 0:n.post_date).toDate():C.Z.unix(1).toDate()}).reverse(),[g,f]=p()(v,e=>(e.publicationAuthor.ownedPublications||[]).some(e=>{var t;return(null===(t=e.subscriptions)||void 0===t?void 0:t.length)===0})),w=s.size===i.size,Z=(!h||i.size>0)&&!c,_=!h||s.size>0?(0,r.tZ)(X,{onClick:n,disabled:!Z,children:d?(i.size>0?"Subscribe and ":"")+d:"Sign up â†’"}):null;return(0,r.BX)("div",{children:[(0,r.tZ)("section",{className:"sign-up",children:"Subscribe to free newsletters from the people you already follow on Twitter"}),(0,r.BX)("ul",{children:[(!h||s.size>0)&&(0,r.BX)(o.Fragment,{children:[(s.size>3||!h)&&_,(0,r.tZ)("li",{children:s.size<30&&(0,r.tZ)(D,{checked:w,onClick:()=>{w?a(!1):a(!0)}})})]}),[...g,...f].map(e=>(0,r.tZ)(x,{result:e,selectedPubs:i,onToggle:l})),_]})]})}},39341:function(e,t,i){i(16584);var n=i(6400);i(30396),(0,n.createContext)({}).displayName="WWWContext"},62514:function(e,t,i){i(30396),i(20042),i(39341),i(68833),i(48980)},30378:function(e,t,i){i.d(t,{Z:()=>y});var n=i(58865),l=i(16584),r=i(30396),o=i(82569),a=i.n(o),s=i(80569),c=i.n(s),d=i(20160),u=i(57391),h=i(95441),p=i(68833),m=i(52384),b=i(15771),v=i(307),g=i(94827),f=i(76560),w=i(54093);function Z(){let e=(0,n._)(["Select "," more to continue"]);return Z=function(){return e},e}let _=(e,t,i,n)=>{var l,r;let o=Object.entries(e).filter(e=>{let[t]=e;return"promoted"!==t&&"suggested"!==t}).map(e=>{let[t,i]=e;return i}),s=new Set,c=Math.max(...o.map(e=>e.length)),d=[];for(let e=0;e<c;e+=1)for(let i of o){let n=i[e];!n||s.has(n.id)||(null==t?void 0:t.includes(n.id))||(s.add(n.id),d.push(n))}e.suggested&&(d=a()(d,...e.suggested)).unshift(...e.suggested);let u=(!i||0===i.length)&&(null==n?void 0:n.includes("treatment")),h=d.slice(0,w.p),p=null===(l=e.promoted)||void 0===l?void 0:l[0];return e.promoted&&p&&!s.has(null===(r=e.promoted[0])||void 0===r?void 0:r.id)&&(u?h.unshift(p):h.length===w.p?h[w.p-1]=p:h.push(p)),h},y=e=>{let{onCategoriesFinalized:t=null,setStep:i,handleError:n,categories:o,pub:a=null,entry:s,user:w,setPreviousStepData:y,recommendationsSource:N=null,canBeSkipped:k=!1,suggestPubIds:S}=e,[B,E]=(0,r.eJ)([]),[I,C]=(0,r.eJ)({}),[R,P]=(0,r.eJ)(null),[A,D]=(0,r.eJ)(!1),[X,O]=(0,r.eJ)([]),[T,x]=(0,r.eJ)(!1),{getExperimentVariant:z,exposeExperiment:F,refreshExperimentVariants:J}=(0,u.jc)(),U=z("web_reader_onboarding_min_3_categories"),{iString:j,iTemplate:L}=(0,h.M1)();F("web_reader_onboarding_min_3_categories");let G=z("reader_onboarding_model_recs_categories_skipped");(0,r.d4)(()=>{J({ignoreDownsampling:!0})},[]),(0,r.d4)(()=>{let e=async()=>{if(!N)return;let e=await c().get(N);C({personalized:e.body}),P("personalized"),O(_({personalized:e.body},[null==a?void 0:a.id],[],"control").map(e=>{let{id:t}=e;return t})),D(!0)};N&&e()},[N,s,null==a?void 0:a.id]);let W=(0,m.Q)({pathname:"/api/v1/categories",auto:!o,initialResult:o,deps:[]}).result||[],M=async()=>{let e;try{let t=B.length?B:W.slice(0,3).map(e=>e.id),i={categoryIds:JSON.stringify(t),userDidSelectCategories:!!B.length};S&&(i.suggestedPubIds=S);let n=await c().get("/api/v1/category/public/multiple").query(i);C(n.body),P("leaderboard"),e=_(n.body,[null==a?void 0:a.id],B,G).map(e=>{let{id:t}=e;return t})}catch(e){n(e,{ignore:!0}),i(f.c.PROFILE);return}for(let e of((0,p.j)(p.FP.READER_ONBOARDING_CATEGORIES_FINALIZED,{entry:s,numberOfCategories:B.length}),B))(0,p.j)(p.FP.READER_ONBOARDING_CATEGORY_REQUESTED,{entry:s,categoryId:e});(null==B?void 0:B.length)?(F("reader_onboarding_model_recs_categories_selected",{ignoreDownsampling:!0}),O(e)):(F("reader_onboarding_model_recs_categories_skipped",{ignoreDownsampling:!0}),O((null==G?void 0:G.includes("treatment"))?[e[0]]:e)),D(!0),null==t||t()},Y=async()=>{let e=w?w.profile_set_up_at?w.has_publication?f.c.APP_UPSELL:f.c.START_WRITING:f.c.PROFILE:f.c.SIGNUP;if(X.length>0)try{x(!0),(0,p.j)(p.FP.READER_ONBOARDING_BULK_SUBSCRIBE_SELECTED_IN_UI,{entry:s,numberOfSubscriptions:X.length,recommendationsFrom:"categories"}),w?(await c().post("/api/v1/bulk_signup").send({publications:X,visibility:"public",source:"".concat("reader2-profile"===s?"reader2":s,"-reader-onboarding")}),(0,p.j)(p.FP.READER_ONBOARDING_BULK_SUBSCRIBED,{entry:s,numberOfSubscriptions:X.length,recommendationsFrom:"categories"})):y(f.c.CATEGORIES,{publications:X,selectedCategoryIds:B}),i(e)}catch(e){n(e,{ignore:!1})}else w?(0,p.j)(p.FP.READER_ONBOARDING_BULK_SUBSCRIBE_SKIPPED,{entry:s,recommendationsFrom:"categories"}):y(f.c.CATEGORIES,{publications:[],selectedCategoryIds:B}),i(e)},H="treatment"===U&&B.length<3;return A||N?(0,l.BX)("div",{className:"categories-step",children:[(0,l.BX)("div",{className:"categories-header",children:[(0,l.tZ)("h3",{children:"Creators you may like"}),(0,l.tZ)("p",{children:N?"We found some writers based on your interests.":B.length>0?"Based on your interests, here are some writers you might enjoy.":"Here are some writers you might enjoy."})]}),(0,l.tZ)(v.Z,{publications:_(I,[null==a?void 0:a.id],B,G),selected:X,setSelected:O,onRecommendationFirstVisible:(e,t)=>{(0,p.j)(p.FP.READER_ONBOARDING_PUB_RECOMMENDED,{entry:s,publication_id:e.id,recommendationFrom:R,suggestion_rank:t})}}),(0,l.BX)("div",{className:"modal-ctas",children:[k&&(0,l.tZ)("p",{className:"skip",children:(0,l.tZ)("a",{className:"small",onClick:e=>{if(T){e.preventDefault();return}(0,p.j)(p.FP.READER_ONBOARDING_BULK_SUBSCRIBE_SKIPPED,{entry:s,recommendationsFrom:"categories"}),i(f.c.APP_UPSELL)},children:"Skip for now"})}),(0,l.BX)(b.zx,{priority:"primary",type:"submit",onClick:Y,disabled:T,children:[X.length>0&&"Subscribe to ".concat(X.length," and continue"),0===X.length&&"Continue without subscribing"]})]})]}):(0,l.BX)("div",{className:"categories-step",children:[(0,l.BX)("div",{style:{overflowY:"auto",height:"100%",position:"relative"},children:[(0,l.BX)("div",{className:"categories-header",children:[(0,l.BX)("h3",{children:[a?(0,l.BX)(l.HY,{children:["You're subscribed!",(0,l.tZ)("br",{}),"Now dive"]}):"Dive"," ","into your interests"]}),(0,l.tZ)("p",{children:"We'll recommend top publications based on the topics you select."})]}),(0,l.tZ)(d.W,{children:(0,l.tZ)(g.Rj,{hasFeatured:!1,categories:W,categoryIds:B,onCategoryClicked:e=>{let{categoryId:t}=e;if(B.includes(t)){var i;let e=null===(i=W.find(e=>e.id===t))||void 0===i?void 0:i.subcategories;E(B.filter(i=>i!==t&&!(null==e?void 0:e.some(e=>e.id===i))))}else E([...B,t])},ranking:"all",defaultExpanded:!0})})]}),(0,l.tZ)("div",{className:"spacer"}),(0,l.tZ)("div",{className:"modal-ctas",children:(0,l.tZ)(b.zx,{disabled:H,priority:"primary",onClick:M,children:"treatment"!==U?j("Continue"):B.length<3?L(Z(),3-B.length):j("Continue")})})]})}},79567:function(e,t,i){i.d(t,{k:()=>s});var n=i(58865),l=i(95441),r=i(60308),o=i(63651);function a(){let e=(0,n._)(["Join link:\n","\n\n---\n\nTo join this live video from your mobile device, download the Substack app from one of the links below. You can also join in your desktop browser using Chrome of Safari.\n\niOS:\n","\n  \nAndroid:\n",""]);return a=function(){return e},e}let s=e=>{let{iTemplate:t}=(0,l.M1)();if(!e)return null;let i=(0,o.bHR)({liveStreamId:e.id,utm_source:"live-stream-calendar-invite"}),n=t(a(),i,(0,r.RMm)(),(0,r.AaB)());return{title:e.title,description:n,start:e.scheduled_at&&new Date(e.scheduled_at),duration:[1,"hour"],location:i}}},94827:function(e,t,i){i.d(t,{Rj:()=>h});var n=i(16584);i(6400);var l=i(30396),r=i(94184),o=i.n(r),a=i(32224),s=i(1852);i(16104),i(35047),i(94499),i(32582);var c=i(95441);i(62514),i(68833),i(98914);var d=i(15771);i(10510),i(60308);let u={desktop:15,mobile:6},h=e=>{let{className:t,hasFeatured:i,categories:r,categoryId:h,categoryIds:p,loadingCategoryId:m,ranking:b,onCategoryClicked:v,defaultExpanded:g}=e,[f,w]=(0,l.eJ)(g||!1),[Z,_]=(0,l.eJ)(new Set),y=u[(0,s.useMediaQuery)({query:"only screen and (max-width: 650px)"})?"mobile":"desktop"],{iString:N}=(0,c.M1)(),k=r?f?r:r.slice(0,y):[],S=e=>e.id===h||(null==p?void 0:p.includes(e.id)),B=e=>{_(t=>{let i=new Set(t);return i.has(e)?i.delete(e):i.add(e),i})};return(0,n.BX)("div",{className:o()("categories",t),children:[i&&(0,n.tZ)(d.zx,{priority:"featured"!==h||m&&"featured"!==m?"secondary":"primary-mono",loading:"featured"===m&&"featured"!==h,onClick:()=>{v({categoryId:"featured",ranking:"all",categories:r})},children:N("Featured")}),k.map(e=>{var t;let i=Z.has(e.id),l=e.subcategories&&e.subcategories.length>0,o=S(e)&&(!m||m===e.id),a=m===e.id&&h!==e.id;return(0,n.BX)(n.HY,{children:[(0,n.tZ)(d.zx,{priority:o?"primary-mono":"secondary-outline",loading:a,onClick:()=>{v({categoryId:e.id,ranking:b,categories:r}),l&&B(e.id)},className:o?"test-active":"test-inactive",children:N(e.name||"")}),i&&l&&(null==e?void 0:null===(t=e.subcategories)||void 0===t?void 0:t.map(e=>{let t=S(e)&&(!m||m===e.id),i=m===e.id&&h!==e.id;return(0,n.tZ)(d.zx,{priority:t?"primary-mono":"secondary",loading:i,onClick:()=>v({categoryId:e.id,ranking:b,categories:r}),children:N(e.name)},e.id)}))]})}),r&&r.length>y&&!f&&(0,n.tZ)(d.hU,{priority:"secondary-outline",onClick:()=>w(!0),children:(0,n.tZ)(a.Z,{size:20})})]})}}}]);