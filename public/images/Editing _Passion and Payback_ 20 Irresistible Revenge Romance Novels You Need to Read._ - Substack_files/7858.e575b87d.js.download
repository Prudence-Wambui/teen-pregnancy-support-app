"use strict";(self.webpackChunksubstack=self.webpackChunksubstack||[]).push([["7858"],{59101:function(e,t,n){n.d(t,{Z:()=>i});let i={container:"container-KbMeLj",themed:"themed-EbT4uD",saveButton:"saveButton-bEqkhJ",text:"text-RPsawq",short:"short-ZM5yW_",imageText:"imageText-mhB5o2",backdrop:"backdrop-Xjlnco",imageBackdrop:"imageBackdrop-mwjQFt",tinted:"tinted-Vm3IqP",blurred:"blurred-UbnY7U",tint:"tint-HtqWIV",header:"header-ndGPw6",restack:"restack-YSzWKs",permalink:"permalink-bijGJH",footer:"footer-0EQTsv",swatchesContainer:"swatchesContainer-TDgd_R",swatchContainer:"swatchContainer-IIrOXq",selected:"selected-how610",alignmentSwatchContainer:"alignmentSwatchContainer-_cyt17",swatch:"swatch-otVp71"}},26935:function(e,t,n){n.d(t,{Z:()=>i});let i={buttonBase:"buttonBase-GK1x3M",buttonText:"buttonText-X0uSmG",grow:"grow-R0h_fk",size_xs:"size_xs-Q62jAa",sizeXs:"size_xs-Q62jAa",size_sm:"size_sm-G3LciD",sizeSm:"size_sm-G3LciD",size_md:"size_md-gCDS3o",sizeMd:"size_md-gCDS3o",size_lg:"size_lg-A_bUNK",sizeLg:"size_lg-A_bUNK",buttonStyle:"buttonStyle-r7yGCK",loading:"loading-ddiesl",rounded:"rounded-SYxRdz",priority_primary:"priority_primary-RfbeYt",priorityPrimary:"priority_primary-RfbeYt","priority_primary-mono":"priority_primary-mono-P_CW5x",priorityPrimaryMono:"priority_primary-mono-P_CW5x",priority_secondary:"priority_secondary-S63h9o",prioritySecondary:"priority_secondary-S63h9o","priority_secondary-accent":"priority_secondary-accent-WwlIuq",prioritySecondaryAccent:"priority_secondary-accent-WwlIuq","priority_secondary-destructive":"priority_secondary-destructive-xg9221",prioritySecondaryDestructive:"priority_secondary-destructive-xg9221","priority_secondary-outline":"priority_secondary-outline-MgyjoK",prioritySecondaryOutline:"priority_secondary-outline-MgyjoK",priority_tertiary:"priority_tertiary-rlke8z",priorityTertiary:"priority_tertiary-rlke8z","priority_tertiary-accent":"priority_tertiary-accent-_S602l",priorityTertiaryAccent:"priority_tertiary-accent-_S602l",priority_quaternary:"priority_quaternary-kpMibu",priorityQuaternary:"priority_quaternary-kpMibu",priority_destructive:"priority_destructive-NKsm9Q",priorityDestructive:"priority_destructive-NKsm9Q",media:"media-XfKJl4",textButton:"textButton-CeUBxU",iconButtonBase:"iconButtonBase-dJGHgN buttonBase-GK1x3M",iconButton:"iconButton-mq_Et5 iconButtonBase-dJGHgN buttonBase-GK1x3M",buttonSpinner:"buttonSpinner-GMiUY5"}},96046:function(e,t,n){n.d(t,{Z:()=>i});let i={container:"container-mGB5uQ"}},26725:function(e,t,n){n.d(t,{Z:()=>i});let i={placeholder:"placeholder-sSVwvu",travel:"travel-p2Byd8",bar:"bar-WF2dWN",circle:"circle-qbcUfs",elevated:"elevated-ckoliU"}},69047:function(e,t,n){n.d(t,{ZP:()=>M});var i=n(7409),o=n(99282),r=n(16584),a=n(6400),s=n(30396),l=n(36808),c=n(95441),d=n(14952),u=n(40647),p=n(60807),m=n(48980),h=n(15771),_=n(82402),y=n(19081),f=n(6490),v=n(65523),g=n(58175),b=n(70379),Z=n(31742),C=n(63651),k=n(36162);class w extends a.Component{componentDidCatch(e,t){console.error(e)}render(){return this.props.children}}let S=Z.Ic.CHATBOT_TERMS_LAST_ACCEPTED_AT,E=()=>{let[e,t]=(0,s.eJ)(""),[n,i]=(0,s.eJ)(null),o=(0,p.SE)(),r=async()=>{if(o.user)try{let[e,n]=await Promise.all([(0,m.rd)("/api/v1/decagon_user_token",{method:"GET"}),(0,m.rd)("/api/v1/decagon_signature_token",{method:"GET"})]);t(e),i({signature:n.signature,epoch:n.epoch})}catch(e){console.error("Error fetching authentication tokens for Decagon:",e)}};return(0,s.d4)(()=>{r();let e=setInterval(r,162e4);return()=>clearInterval(e)},[]),{apiToken:e,signatureToken:n}},P=e=>{let[t,n]=(0,s.eJ)(!1);return(0,s.d4)(()=>{if("undefined"!=typeof window&&!window.duet){n(!0);let t=document.createElement("script");t.setAttribute("id","decagon-snippet"),t.setAttribute("src","https://decagon.ai/loaders/substack.js"),t.onload=()=>{window.duet.setUserId(null==e?void 0:e.id),window.duet.hide(),n(!1)},document.body.appendChild(t)}},[e]),t},N=e=>{let{user:t,pub:n,tokens:r,loading:a}=e;(0,s.d4)(()=>{var e,s,c,d,u;if((null===(e=window.duet)||void 0===e?void 0:e.setMetadata)&&!a){let e,a,p,m;window.duet.unhide();try{let t=document.createElement("div");t.style.fontSize="initial",e=window.getComputedStyle(t).fontSize,p=null===(s=window.screen)||void 0===s?void 0:s.width,a=null===(c=window.screen)||void 0===c?void 0:c.height,m=null===(u=window.screen)||void 0===u?void 0:null===(d=u.orientation)||void 0===d?void 0:d.type}catch(t){e="failed to get font size",p="failed to get screen width",a="failed to get screen height",m="failed to get screen orientation"}window.duet.setMetadata((0,o._)((0,i._)({email:null==t?void 0:t.email,url:window.location.href,subdomain:null==n?void 0:n.subdomain},r.apiToken&&{token:r.apiToken}),{windowWidth:window.innerWidth,windowHeight:window.innerHeight,windowFontSize:e,windowDevicePixelRatio:window.devicePixelRatio,windowScreenWidth:p,windowScreenHeight:a,windowScreenOrientation:m})),r.signatureToken&&window.duet.setUserIdAuth(r.signatureToken.signature,r.signatureToken.epoch),function(){let e=l.get(S);return e&&(new Date().getTime()-new Date(e).getTime())/1e3<=5}()&&window.duet.open()}},[t,n,r,a])};function T(){let e=(0,p.aF)(),t=(0,d.Ij)(),n=E(),i=P(e);return N({user:e,pub:t,tokens:n,loading:i}),(0,s.d4)(()=>()=>{"undefined"!=typeof window&&window.duet&&window.duet.hide()},[]),(0,r.tZ)("span",{id:"decagon-widget-loader"})}function x(e){let{modalOpen:t,setModalOpen:n,setShowDecagon:i}=e,[o,a]=(0,s.eJ)(!1),d=(0,p.SE)(),{iString:u}=(0,c.M1)(),b=()=>{n(!1)},Z=async()=>{l.set(S,new Date().toJSON(),{expires:3650}),d.user&&await (0,m.rd)("/api/v1/settings",{method:"POST",json:{settingName:"chatbotTermsLastAcceptedAt",settingValue:new Date}}),i(!0),b()};return(0,r.BX)(f.u_,{isOpen:t,onClose:b,width:480,overflow:"hidden",renderOverReactLaagPortal:!0,children:[(0,r.tZ)(f.xB,{icon:(0,r.tZ)(v.ZN,{}),onClose:b,title:u("Terms & conditions"),showClose:!0,showDivider:!0,alignItems:"center",description:(0,r.tZ)(r.HY,{children:(0,r.BX)(g.xv,{translated:!0,children:["In order to use the Substack chatbot, please first review the"," ",(0,r.tZ)(g.hh,{href:"".concat((0,C.ZJn)(),"/chatbot-tos"),color:"substack",decoration:"underline",target:"_blank",children:I18N.p("Terms & Conditions")}),"."]})})}),(0,r.tZ)(f.fe,{children:(0,r.BX)(y.M5,{gap:12,children:[(0,r.tZ)(_.X,{autoFocus:!0,size:"sm",onChange:()=>a(!o),checked:o}),(0,r.tZ)(g.xv.B4,{translated:!0,children:"I have read, understood, and agree to the Terms & Conditions."})]})}),(0,r.tZ)(f.mz,{showDivider:!0,direction:"column",primaryButton:(0,r.tZ)(h.zx,{priority:"primary",onClick:Z,disabled:!o,children:u("Continue")})})]})}function I(e){let{setShowDecagon:t}=e,[n,i]=(0,s.eJ)(!1),{iString:o}=(0,c.M1)();return(0,r.BX)("div",{className:k.Z.disclaimerBackground,children:[(0,r.tZ)(x,{modalOpen:n,setModalOpen:i,setShowDecagon:t}),(0,r.tZ)("div",{className:k.Z.disclaimerInner,onClick:()=>i(!0),tabIndex:1,role:"button","aria-label":o("Open Chatbot"),children:(0,r.BX)("div",{className:k.Z.disclaimerText,children:[(0,r.BX)("span",{role:"img","aria-label":"message",className:k.Z.disclaimerIcon,children:[(0,r.tZ)("svg",{viewBox:"64 64 896 896",focusable:"false","data-icon":"message",width:"1em",height:"1em",fill:"currentColor","aria-hidden":"true",children:(0,r.tZ)("path",{d:"M464 512a48 48 0 1096 0 48 48 0 10-96 0zm200 0a48 48 0 1096 0 48 48 0 10-96 0zm-400 0a48 48 0 1096 0 48 48 0 10-96 0zm661.2-173.6c-22.6-53.7-55-101.9-96.3-143.3a444.35 444.35 0 00-143.3-96.3C630.6 75.7 572.2 64 512 64h-2c-60.6.3-119.3 12.3-174.5 35.9a445.35 445.35 0 00-142 96.5c-40.9 41.3-73 89.3-95.2 142.8-23 55.4-34.6 114.3-34.3 174.9A449.4 449.4 0 00112 714v152a46 46 0 0046 46h152.1A449.4 449.4 0 00510 960h2.1c59.9 0 118-11.6 172.7-34.3a444.48 444.48 0 00142.8-95.2c41.3-40.9 73.8-88.7 96.5-142 23.6-55.2 35.6-113.9 35.9-174.5.3-60.9-11.5-120-34.8-175.6zm-151.1 438C704 845.8 611 884 512 884h-1.7c-60.3-.3-120.2-15.3-173.1-43.5l-8.4-4.5H188V695.2l-4.5-8.4C155.3 633.9 140.3 574 140 513.7c-.4-99.7 37.7-193.3 107.6-263.8 69.8-70.5 163.1-109.5 262.8-109.9h1.7c50 0 98.5 9.7 144.2 28.9 44.6 18.7 84.6 45.6 119 80 34.3 34.3 61.3 74.4 80 119 19.4 46.2 29.1 95.2 28.9 145.8-.6 99.6-39.7 192.9-110.1 262.7z"})})," "]})," ",o("Ask a question")]})})]})}let M=function(){let e=(0,p.SE)(),[t,n]=(0,s.eJ)(!!(e.user&&e.userSettings.chatbotTermsLastAcceptedAt||l.get(S))),i=(0,b.pm)();return(0,s.d4)(()=>(i.addOffset(-64),()=>i.addOffset(64)),[]),(0,r.tZ)(w,{children:(0,u.xR)().getConfigFor("enable_decagon_chat")&&void 0!==e.userSettings.chatbotTermsLastAcceptedAt?t?(0,r.tZ)(T,{}):(0,r.tZ)(I,{setShowDecagon:n}):(0,r.tZ)(a.Fragment,{})})}},96726:function(e,t,n){n.d(t,{X:()=>l,h:()=>c});var i=n(16584),o=n(6400),r=n(98661),a=n(30396);let s=(0,o.createContext)(null);function l(e){let{root:t,children:n}=e,o=(0,a.sO)(t);return(0,i.BX)(s.Provider,{value:o,children:[n,!t&&(0,i.tZ)("div",{ref:o})]})}function c(e){let{children:t}=e,n=(0,a.qp)(s).current;return n?(0,r.createPortal)(t,n):null}},20253:function(e,t,n){n.d(t,{GP:()=>y,Rx:()=>v,ZP:()=>b});var i=n(27412),o=n(7409),r=n(99282),a=n(98848),s=n(16584),l=n(6400),c=n(94184),d=n.n(c),u=n(37168),p=n(68833),m=n(48980),h=n(58175),_=n(84864);class y extends l.Component{componentDidMount(){!this.props.disabled&&(this.props.element&&this.props.element.mount(this.elementContainer),this.props.addressElement&&this.props.addressElement.mount(this.addressContainer))}componentDidUpdate(e){this.props.disabled||(this.props.element&&!e.element&&this.props.element.mount(this.elementContainer),this.props.addressElement&&!e.addressElement&&this.props.addressElement.mount(this.addressContainer))}componentWillUnmount(){try{this.props.element&&this.props.element.unmount(this.elementContainer),this.props.addressElement&&this.props.addressElement.unmount(this.addressContainer)}catch(e){}}render(e){let{className:t,element:n,isPaymentElement:i,addressElement:o,disabled:r}=e;return n||i?(0,s.BX)("div",{className:d()("fancy-stripe",t,{"payment-element":i}),children:[o&&(0,s.tZ)("div",{ref:this.assignAddressContainer,style:{paddingBottom:"24px"}}),(0,s.tZ)("div",{ref:this.assignElementContainer}),r&&(0,s.tZ)(h.xv.B4,{translated:!0,color:"error",children:"This type of purchase is currently unavailable in your region."})]}):null}constructor(...e){super(...e),(0,i._)(this,"elementContainer",void 0),(0,i._)(this,"addressContainer",void 0),(0,i._)(this,"assignElementContainer",e=>{this.elementContainer=e}),(0,i._)(this,"assignAddressContainer",e=>{this.addressContainer=e})}}class f extends l.Component{async componentDidMount(){let e=!1;if(this.state.paymentRequest){try{let t=await this.state.paymentRequest.canMakePayment();t&&t.applePay&&(e=!0)}catch(e){console.error(e)}(0,p.j)(p.FP.APPLE_PAY_SETUP_FINISHED,{success:e})}if(await this.setState({canMount:e}),e){if(this.button||await new Promise(e=>setTimeout(e,0)),!this.state.stripeButton){console.error("stripeButton not ready");return}if(this.state.stripeButton.mount(this.button),!this.state.paymentRequest){console.error("paymentRequest not ready");return}this.state.paymentRequest.on("token",e=>this.onTokenReceived(e)),this.state.paymentRequest.update({currency:this.props.plan.currency,total:this.getPaymentTotal()})}else this.props.onVisibilityChanged&&this.props.onVisibilityChanged(!1)}componentDidUpdate(e){let t=!1;for(let o of["pub","plan","quantity","coupon","notRecurring","variableAmount"]){var n,i;if(e[o]!==this.props[o]||"coupon"===o&&e[o]&&(null===(n=e[o])||void 0===n?void 0:n.loading)&&(!this.props[o]||!(null===(i=this.props[o])||void 0===i?void 0:i.loading))){t=!0;break}}t&&this.state.paymentRequest&&this.state.paymentRequest.update({currency:this.props.plan.currency,total:this.getPaymentTotal()})}componentWillUnmount(){if(this.state.paymentRequest&&this.state.paymentRequest.off("token"),this.state.stripeButton)try{this.state.stripeButton.unmount(this.button)}catch(e){}}async onTokenReceived(e){(0,p.j)(p.FP.APPLE_PAY_ATTEMPED);try{if(!this.props.onSuccess){console.error("No onSuccess handler for Apple Pay");return}await this.props.onSuccess({email:e.payerEmail,name:e.payerName,stripe_token:e.token}),e.complete("success"),(0,p.j)(p.FP.APPLE_PAY_SUCCEEDED)}catch(t){console.error("Apple Pay submission failed:",e,t),e.complete("fail"),(0,p.j)(p.FP.APPLE_PAY_FAILED,{reason:t.message})}}getPaymentTotal(){var e,t,n,i;let o;let{pub:r,plan:a,quantity:s,coupon:l,notRecurring:c,variableAmount:d}=this.props,u=0,p=Math.max(0,a.trial_period_days||0,l&&!l.error&&!l.loading&&l.trial_period_days||0,r.trial_end_override&&Math.ceil((r.trial_end_override-Date.now()/1e3)/60/60/24));c&&(p=0);let m=((null===(e=a.metadata)||void 0===e?void 0:e.founding)?null!==(t=d||a.amount)&&void 0!==t?t:0:null!==(n=a.amount)&&void 0!==n?n:0)*(s||1),h=m;return l&&!l.error&&!l.loading&&(l.percent_off?h=Math.round(h*(1-(l.percent_off_precise||l.percent_off)/100)):l.amount_off&&(h=Math.max(0,h-l.amount_off)),h<=0&&(h=m,"once"===l.duration?"year"===a.interval?u+=12*a.interval_count:u+=a.interval_count:"repeating"===l.duration&&(u+=null!==(i=l.duration_in_months)&&void 0!==i?i:0))),c?o="one-time":(o="".concat(this.props.plan.interval,"ly"),this.props.quantity>1&&(o+=" per person"),u?(p>15&&(u+=Math.floor(p/30)),o+=" with ".concat(u,"-month trial")):p&&(o+=" with ".concat(p,"-day trial"))),{label:o,amount:h}}render(e,t){let{children:n,className:i,error:o}=e,{canMount:r}=t;return void 0===r||r||"undefined"==typeof window?(0,s.BX)("div",{className:"apple-pay-parent-container",children:[r?(0,s.tZ)("div",{className:"apple-pay-element ".concat(i||""),ref:this.assignButton}):(0,s.tZ)("p",{className:"apple-pay-loader ".concat(i||""),children:"Loading…"}),o&&(0,s.tZ)("div",{className:"error",children:o}),n]}):null}constructor(e,t){if(super(e,t),(0,i._)(this,"button",void 0),(0,i._)(this,"assignButton",e=>{this.button=e}),e.stripe&&e.pub.stripe_country){(0,p.j)(p.FP.APPLE_PAY_SETUP_STARTED);try{let t=e.stripe.paymentRequest({country:this.props.pub.stripe_country,currency:this.props.plan.currency,total:this.getPaymentTotal(),requestPayerName:!0,requestPayerEmail:!0}),n=e.stripe.elements().create("paymentRequestButton",{paymentRequest:t});this.state={paymentRequest:t,stripeButton:n}}catch(e){console.error(e),(0,p.j)(p.FP.APPLE_PAY_SETUP_FINISHED,{success:!1})}}}}class v extends l.Component{render(e,t){var{children:n,ref:i,defaultValue:r}=e,l=(0,a._)(e,["children","ref","defaultValue"]);return(0,s.BX)("div",{className:"fancy-input",children:[(0,s.tZ)("input",(0,o._)({ref:this.assignInput,defaultValue:r},l)),n]})}blur(){this._input&&this._input.blur()}constructor(...e){super(...e),(0,i._)(this,"_input",void 0),(0,i._)(this,"assignInput",e=>{this._input=e})}}class g extends l.Component{getInputs(){let e=[];if(this.base)for(let t of Array.from(this.base.getElementsByTagName("*")))["INPUT","TEXTAREA","SELECT"].includes(t.nodeName)&&t.getAttribute("name")&&"g-recaptcha-response"!==t.id&&e.push(t);return e}resetErrors(){this.setState({_paramErrors:{},_otherErrors:[]})}clear(){for(let e of(this.resetErrors(),this.getInputs()))e.blur&&e.blur(),"checkbox"===e.type?e.checked=!1:"select"===e.type?e.selectedIndex=-1:"radio"===e.type?e.checked=!1:"target"in e&&e.target?e.target.value="":e.value=""}handleStripeChange(e){let{error:t}=e;t?this.setState({_stripeError:t.message}):this.setState({_stripeError:null})}componentDidMount(){this._mountTime=new Date,this._stripeCardOrPaymentElement&&this._stripeCardOrPaymentElement.addEventListener("change",e=>this.handleStripeChange(e))}componentDidUpdate(e){let{country:t,currency:n,email:i,name:r,pub:a,stripeClientSecret:s,stripeElementAppearance:l,themeVariables:c,useStripePaymentElement:d}=this.props;if(d){var u,p;if(e.useStripePaymentElement||(null===(u=this._stripeCardOrPaymentElement)||void 0===u||u.destroy(),this._stripeCardOrPaymentElement=null),s!==e.stripeClientSecret){if(s){this.setState({loading:!0});let e=this.props.isPlatformCustomer?this._stripe:this._connectedStripe;if(!e){console.error("Stripe instance not available in componentDidUpdate");return}({elements:this._stripeElements,addressElement:this._stripeAddressElement,paymentElement:this._stripeCardOrPaymentElement}=function(e,t){let{withAddressElement:n=!1,currency:i,email:r,name:a,country:s,stripeElementAppearance:l={},themeVariables:{color_theme_accent:c,color_theme_bg_contrast_1:d,print_on_pop:u,print_on_web_bg_color:p,print_secondary_on_web_bg_color:m}={},disableWallets:h}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},_={clientSecret:t,currency:i,appearance:(0,o._)({theme:"flat",variables:{borderRadius:"8px",colorBackground:d||void 0,colorPrimary:c||"rgb(255, 103, 25)",accessibleColorOnColorPrimary:u||void 0,colorText:p||void 0,colorTextPlaceholder:m||void 0,colorTextSecondary:m||void 0}},l),locale:window._preloads&&window._preloads.language||"auto"},y=e.elements(_);return{elements:y,addressElement:n?y.create("address",{mode:"billing",defaultValues:{name:a,address:{country:s}}}):void 0,paymentElement:y.create("payment",{layout:{type:"tabs",defaultCollapsed:!1},defaultValues:{billingDetails:{email:r,name:a,address:{country:s}}},wallets:h?{applePay:"never",googlePay:"never"}:void 0,terms:{card:"never",applePay:"never",googlePay:"never"}})}}(e,s,{withAddressElement:(null==a?void 0:a.stripe_country)==="IN",currency:n,email:i,name:null!=r?r:void 0,country:t,stripeElementAppearance:l,themeVariables:c,disableWallets:!1})),this.setState({loading:!1})}else e.stripeClientSecret&&(null===(p=this._stripeCardOrPaymentElement)||void 0===p||p.destroy(),this._stripeCardOrPaymentElement=null)}}}componentWillUnmount(){this._stripeCardOrPaymentElement&&this._stripeCardOrPaymentElement.destroy()}onInputBlur(e){this.props.analyticsName&&this._mountTime&&new Date().getTime()-this._mountTime.getTime()>1e3&&e.target&&e.target.value&&!e.target._blurTracked&&((0,p.j)("".concat(this.props.analyticsName," Input Filled"),{name:e.target.name}),e.target._blurTracked=!0)}async onPaymentRequestAttempt(e){let t=await this.handleSubmitAsync(null,e);if(t)throw t}handleSubmit(e){e&&e.preventDefault(),this.handleSubmitAsync(e).catch(e=>{console.error(e)})}async handleSubmitAsync(e){let t,n,i,o,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e&&e.preventDefault(),this.props.analyticsName&&(0,p.j)("".concat(this.props.analyticsName," Submit Pressed")),this.props.loading||this.state.loading||this.props.disableSubmit)return;this.resetErrors(),this.setState({loading:!0});let a=null;if(this.stripeElement&&!r.stripe_token&&!this.props.useStripePaymentElement){let{token:e=null,error:t}=this._stripe?await this._stripe.createToken(this._stripeCardOrPaymentElement):{error:{message:""}};if(e)a=e;else{this.setState({loading:!1,_stripeError:t&&t.message}),this.props.analyticsName&&(console.log("error",t),(0,p.j)("".concat(this.props.analyticsName," Missing Payment"),{type:t&&t.type,code:t&&t.code,decline_code:t&&t.decline_code,reason:t&&t.message}));return}}if(this.stripeElement&&this.props.useStripePaymentElement){var s,l,c,d=this;if(t=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=d.props.isPlatformCustomer?d._stripe:d._connectedStripe;if(!t){console.error("Stripe instance not available");return}if(!d._stripeElements){console.error("Stripe elements not available");return}return t.confirmSetup({elements:d._stripeElements,redirect:"if_required",confirmParams:e})},!this.props.performSubmit){let{setupIntent:e}=await t();if(e)n=e.payment_method;else{this.setState({loading:!1});return}}}let u={};for(let e of this.getInputs())if(e.blur&&e.blur(),"checkbox"==e.type)u[e.name]=!!e.checked;else if("radio"==e.type)e.checked&&(u[e.name]=e.value);else if("select"===e.type){let t=e.options[e.selectedIndex];t?u[e.name]=t.value:console.error("No selected option in select element")}else u[e.name]=e.value;if(Object.keys(r).forEach(e=>{!u[e]&&r[e]&&(u[e]=r[e])}),a?u.stripe_token=a:n&&(u.paymentMethodId=n),this.props.prepareData)try{let t=await this.props.prepareData(u,e);t&&(u=t)}catch(e){throw this.setState({loading:!1}),e}this.props.onChangeLoadingState&&this.props.onChangeLoadingState(!0);try{this.props.performSubmit?i=this.props.useStripePaymentElement?await this.props.performSubmit(u,{confirmSetup:t}):await this.props.performSubmit(u):this.props.action?i=this.props.method&&"get"===this.props.method?{body:await (0,m.rd)(this.props.action,{query:u,method:this.props.method})}:{body:await (0,m.rd)(this.props.action,{json:u,method:this.props.method||"POST"})}:this.props.onSubmit&&this.props.onSubmit(u)}catch(t){let e=t.response&&t.response.body instanceof ReadableStream;t.response&&t.body&&e?t.response={body:t.body,status:null===(l=t.response)||void 0===l?void 0:l.status}:t.response&&t.body&&!t.response.body&&(t.response.body=t.body),o=t}if((null==i?void 0:null===(s=i.body)||void 0===s?void 0:s.confirmPaymentUrl)&&i.body.clientSecret&&this._connectedStripe){(0,p.j)(p.FP.PAYMENT_CONFIRMATION_STARTED);let e=await this._connectedStripe.confirmCardPayment(i.body.clientSecret);if(e.error){(0,p.j)(p.FP.PAYMENT_CONFIRMATION_FAILED,{error:null===(c=e.error)||void 0===c?void 0:c.message});let t={error:e.error.message||"Failed to confirm payment"};o={response:{body:t,text:JSON.stringify(t)}}}else(0,p.j)(p.FP.PAYMENT_CONFIRMATION_SUCCEEDED)}if(this.setState({loading:!1}),this.props.onChangeLoadingState&&this.props.onChangeLoadingState(!1),o){if(this.processErrors(o.response),this.props.onError&&this.props.onError(o,u),!o.response)throw o}else this.props.onSuccess&&this.props.onSuccess(i,u);return o}processErrors(e){let t={},n=[];if(e&&e.body&&e.body.errors){let i=this.getInputs();e.body.errors.forEach(e=>{!0!==this.props.noInlineErrors&&e.param&&i.filter(t=>t.getAttribute("name")===e.param).length>0?t[e.param]?(console.log("Discarding repeated error"),console.log(e)):t[e.param]=e:n.push(e)})}else e&&e.body&&"string"==typeof e.body.error?n.push({msg:e.body.error}):n.push({msg:"Something went wrong"});this.setState({_paramErrors:t,_otherErrors:n}),this.props.analyticsName&&(0,p.j)("".concat(this.props.analyticsName," Error"),{paramErrors:JSON.stringify(t),otherErrors:JSON.stringify(n)})}render(e,t){let n=e.autoLock&&t.loading||e.loading,i=!1,a=!1,c=e.getConfigFor("disable_card_element_in_europe")&&!e.useStripePaymentElement&&e.pub&&_.EEA_COUNTRIES.includes(e.pub.stripe_country)&&(!e.currency||"eur"===e.currency),u=p=>{let m=[];return(0,l.toChildArray)(p).forEach(p=>{if(!p)return null;if("object"==typeof p&&(p.type===v||"input"===p.type||"textarea"===p.type||"select"===p.type)&&p.props&&"name"in p.props&&p.props.name){let e=p.props.name;if(m.push((0,l.cloneElement)(p,{disabled:n||"disabled"in p.props&&p.props.disabled,onChange:e=>{let t=p.props&&"onChange"in p.props&&p.props.onChange||p.props&&"onInput"in p.props&&p.props.onInput;t&&"function"==typeof t&&t(e),this.props.onChange&&this.props.onChange(e)},onInput:e=>{p.props&&"onInput"in p.props&&p.props.onInput&&"function"==typeof p.props.onInput&&p.props.onInput(e),this.props.onInput&&this.props.onInput(e)},onBlur:e=>{this.onInputBlur(e),p.props&&"onBlur"in p.props&&p.props.onBlur&&"function"==typeof p.props.onBlur&&p.props.onBlur(e)}})),t._paramErrors[null!=e?e:"undefined"]&&!n){let n=t._paramErrors[null!=e?e:"undefined"];if(!n){console.error("No error for",e);return}n.msgHTML?m.push((0,s.tZ)("div",(0,r._)((0,o._)({className:"error"},e&&{name:e}),{dangerouslySetInnerHTML:{__html:n.msgHTML}}))):m.push((0,s.tZ)("div",(0,r._)((0,o._)({className:"error"},e&&{name:e}),{children:n.msg||"Invalid"})))}}else if("object"==typeof p&&p.props&&"type"in p.props&&"submit"===p.props.type)m.push((0,l.cloneElement)(p,{disabled:n||"disabled"in p.props&&p.props.disabled,onClick:e=>{p.props&&"onClick"in p.props&&p.props.onClick&&"function"==typeof p.props.onClick&&!1!==p.props.onClick(e)&&this.handleSubmit(e)}}));else if("object"==typeof p&&p.props&&"id"in p.props&&"error-container"===p.props.id){if(t._otherErrors&&!n){let e=t._otherErrors.map(e=>e.msgHTML?(0,s.tZ)("div",{className:"error other-error",dangerouslySetInnerHTML:{__html:e.msgHTML}}):(0,s.tZ)("div",{className:"error other-error",children:e.msg})).concat(p.props&&p.props.children?(0,l.toChildArray)(p.props.children):[]);m.push((0,l.cloneElement)(p,{},e))}}else if("object"==typeof p&&"type"in p&&p.type===y){if(i)throw Error("Can only handle one stripe element");i=!0,m.push((0,l.cloneElement)(p,{ref:e=>{p.props&&p.props.ref&&p.props.ref(e),this.stripeElement=e},element:this._stripeCardOrPaymentElement,isPaymentElement:this.props.useStripePaymentElement,addressElement:this._stripeAddressElement,disabled:c})),!t._stripeError&&this._stripeCardOrPaymentElement||n||"undefined"==typeof window||m.push((0,s.tZ)("div",{className:d()("error",e.stripeErrorClassName),role:"alert",children:t._stripeError||"Stripe payments not loaded. Are there blocked scripts?"}))}else if("object"==typeof p&&"type"in p&&p.type===f){if(a)throw Error("Can only handle one stripe payment request button");a=!0,m.push((0,l.cloneElement)(p,{ref:e=>{p.props&&p.props.ref&&p.props.ref(e),this.stripePaymentRequestButton=e},stripe:this._stripe,onSuccess:e=>(p.props&&"onSuccess"in p.props&&p.props.onSuccess&&"function"==typeof p.props.onSuccess&&p.props.onSuccess(e),this.onPaymentRequestAttempt(e))}))}else"object"==typeof p&&"props"in p&&p.props&&p.props.children?m.push((0,l.cloneElement)(p,{},u(p.props.children))):m.push(p)}),m};return(0,s.tZ)("form",(0,r._)((0,o._)({className:"form ".concat(e.className||""),action:e.noJsAction||e.action,method:e.method&&["get","post"].includes(e.method.toLowerCase())&&e.method.toLowerCase()||"post",autoComplete:e.autoComplete,onSubmit:e=>this.handleSubmit(e),noValidate:!0},e.enctype&&{enctype:e.enctype}),{children:u(e.children)}))}constructor(e,t){super(e,t),(0,i._)(this,"_stripe",void 0),(0,i._)(this,"_connectedStripe",void 0),(0,i._)(this,"_stripeCardOrPaymentElement",void 0),(0,i._)(this,"_mountTime",void 0),(0,i._)(this,"_stripeElements",void 0),(0,i._)(this,"_stripeAddressElement",void 0),(0,i._)(this,"stripeElement",void 0),(0,i._)(this,"stripePaymentRequestButton",void 0),this.state={_paramErrors:{},_otherErrors:[],_stripeError:null,loading:!1},this.props.stripe_publishable_key&&(this._stripe=function(e,t){if("undefined"==typeof window||void 0===window.Stripe)return null;let n={};return t&&t.stripe_user_id?_.NO_PLATFORM_CUSTOMER_CLONE_COUNTRIES.includes(t.stripe_country)&&(n.stripeAccount=t.stripe_user_id):console.warn("No publication passed for Stripe connection"),window.Stripe(e,n)}(this.props.stripe_publishable_key,this.props.pub),this._stripe)&&(!this.props.useStripePaymentElement&&(this._stripeCardOrPaymentElement=this._stripe.elements({locale:window._preloads&&window._preloads.language||"auto"}).create("card",{style:{base:{fontSize:"14px",lineHeight:"40px",fontFamily:'-apple-system, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"'}},disableLink:!0})),this._connectedStripe=function(e,t){if("undefined"==typeof window||void 0===window.Stripe||!(null==t?void 0:t.stripe_user_id))return null;let n={stripeAccount:t.stripe_user_id};return window.Stripe(e,n)}(this.props.stripe_publishable_key,this.props.pub))}}let b=(0,u.hO)(g)},31852:function(e,t,n){n.d(t,{Z:()=>l});var i=n(7409),o=n(99282),r=n(98848),a=n(16584),s=n(64515);let l=e=>{var{size:t=24,color:n="var(--color-fg-primary)"}=e,l=(0,r._)(e,["size","color"]);return(0,a.tZ)(s.l,(0,o._)((0,i._)({},l),{name:"BigQuoteIcon",svgParams:{viewBox:"0 0 27 17"},stroke:"none",width:t,height:t,fill:n,children:(0,a.tZ)("path",{d:"M11.7188 10.6172C11.7188 7.5 9.41016 5.01562 6.43359 5.01562C5.03906 5.01562 3.71484 5.56641 2.74219 6.64453H2.42578C3.10547 4.42969 5.16797 2.57812 7.73438 1.81641C8.09766 1.69922 8.36719 1.59375 8.53125 1.45312C8.71875 1.30078 8.82422 1.11328 8.82422 0.84375C8.82422 0.351562 8.44922 0.0117188 7.89844 0.0117188C7.53516 0.0117188 7.25391 0.0820312 6.75 0.246094C5.13281 0.773438 3.67969 1.69922 2.55469 2.88281C0.972656 4.52344 0 6.71484 0 9.31641C0 13.7109 2.78906 16.2539 6.05859 16.2539C9.28125 16.2539 11.7188 13.793 11.7188 10.6172ZM25.793 10.6172C25.793 7.5 23.4727 5.01562 20.5078 5.01562C19.1133 5.01562 17.7773 5.56641 16.8164 6.64453H16.5C17.1797 4.42969 19.2422 2.57812 21.7969 1.81641C22.1602 1.69922 22.4414 1.59375 22.6055 1.45312C22.793 1.30078 22.8867 1.11328 22.8867 0.84375C22.8867 0.351562 22.5234 0.0117188 21.9727 0.0117188C21.5977 0.0117188 21.3281 0.0820312 20.8125 0.246094C19.207 0.773438 17.7422 1.69922 16.6172 2.88281C15.0469 4.52344 14.0742 6.71484 14.0742 9.31641C14.0742 13.7109 16.8633 16.2539 20.1328 16.2539C23.3555 16.2539 25.793 13.793 25.793 10.6172Z"})}))}},21465:function(e,t,n){n.d(t,{Z:()=>l});var i=n(7409),o=n(99282),r=n(98848),a=n(16584),s=n(64515);let l=e=>{var{size:t=20,stroke:n="var(--color-fg-primary)",strokeWidth:l=1.5}=e,c=(0,r._)(e,["size","stroke","strokeWidth"]);return(0,a.tZ)(s.l,(0,o._)((0,i._)({},c),{name:"NoteCommentIcon",svgParams:{viewBox:"0 0 20 20"},width:t,height:t,stroke:n,strokeWidth:l,strokeLinecap:"round",strokeLinejoin:"round",children:(0,a.tZ)("path",{d:"M18.7502 11V7.50097C18.7502 4.73917 16.5131 2.50033 13.7513 2.50042L6.25021 2.50044C3.48848 2.5004 1.25017 4.73875 1.2502 7.50048L1.25021 10.9971C1.2502 13.749 3.47395 15.9836 6.22586 15.9971L6.82888 16V19.0182L12.1067 16H13.7502C16.5116 16 18.7502 13.7614 18.7502 11Z"})}))}},66289:function(e,t,n){n.d(t,{Z:()=>a});var i=n(7409),o=n(99282),r=n(16584);function a(e){return(0,r.tZ)("svg",(0,o._)((0,i._)({width:"22",height:"24",viewBox:"0 0 20 20",overflow:"visible",fill:"none",stroke:"var(--color-fg-secondary)"},e),{children:(0,r.BX)("g",{transform:"translate(0, -2)",children:[(0,r.tZ)("path",{d:"M16.6667 16.0265C16.0821 17.2172 15.1835 18.2187 14.0715 18.9188C12.9594 19.6189 11.6779 19.9901 10.3704 19.9906C9.27691 19.9935 8.19824 19.7334 7.22222 19.2315L2.5 20.834L4.07407 16.0265C3.58108 15.0329 3.32561 13.9347 3.32846 12.8215C3.32897 11.4904 3.69349 10.1857 4.3812 9.05361C5.06891 7.92149 6.05265 7.00665 7.22222 6.41156C7.72153 6.15481 8.2477 5.96134 8.78897 5.83398","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),(0,r.tZ)("path",{d:"M19.4444 6.11133H13.8893C13.2757 6.11133 12.7782 6.60879 12.7782 7.22244V11.1113C12.7782 11.725 13.2757 12.2224 13.8893 12.2224H19.4444C20.0581 12.2224 20.5555 11.725 20.5555 11.1113V7.22244C20.5555 6.60879 20.0581 6.11133 19.4444 6.11133Z"}),(0,r.tZ)("path",{d:"M13.8893 6.11133H19.4444M13.8893 6.11133C13.2757 6.11133 12.7782 6.60879 12.7782 7.22244V11.1113C12.7782 11.725 13.2757 12.2224 13.8893 12.2224H19.4444C20.0581 12.2224 20.5555 11.725 20.5555 11.1113V7.22244C20.5555 6.60879 20.0581 6.11133 19.4444 6.11133M13.8893 6.11133L13.8889 3.88911C13.8889 3.15239 14.1815 2.44586 14.7025 1.92492C15.2234 1.40399 15.9299 1.11133 16.6667 1.11133C17.4034 1.11133 18.1099 1.40399 18.6308 1.92492C19.1518 2.44586 19.4444 3.15239 19.4444 3.88911V6.11133","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"})]})}))}},94442:function(e,t,n){n.d(t,{Cz:()=>e1,Er:()=>e0,F6:()=>e2,Hg:()=>eU,L9:()=>e5,Mp:()=>e9,Ng:()=>eQ,PA:()=>eP,RY:()=>e3,RZ:()=>eR,Su:()=>eE,TJ:()=>eH,_2:()=>eT,c1:()=>eX,fh:()=>e4,mt:()=>eI,nA:()=>ej,pD:()=>eY,vk:()=>ez,yT:()=>e6,z5:()=>e$});var i=n(7409),o=n(99282),r=n(58865),a=n(16584),s=n(98661),l=n(30396),c=n(94184),d=n.n(c),u=n(12297),p=n.n(u),m=n(23493),h=n.n(m),_=n(85200),y=n(77951),f=n(95951),v=n(73820),g=n(56687),b=n(65207),Z=n(13808),C=n(18794),k=n(31131),w=n(67358),S=n(62686),E=n(80569),P=n.n(E),N=n(60826),T=n(7703),x=n(23254),I=n(86790),M=n(39900),B=n(43389),O=n(21286),L=n(25265),R=n(666),D=n(76157),A=n(95398),F=n(91355),U=n(50137),z=n(39929),j=n(16808),H=n(48917),X=n(67203),q=n(85685),W=n(30329),J=n(2995),Y=n(51014),K=n(75778),V=n(95441),G=n(56629),Q=n(40647),$=n(45261),ee=n(60807),et=n(90099),en=n(68833),ei=n(48980),eo=n(7882),er=n(27036),ea=n(98914),es=n(97505),el=n(15771),ec=n(19081),ed=n(44424),eu=n(6490),ep=n(98248),em=n(58175),eh=n(70379);n(27744);var e_=n(39493),ey=n(91400),ef=n(98012),ev=n(31377),eg=n(79582),eb=n(60308),eZ=n(63651),eC=n(84864),ek=n(67836),ew=n(47929);function eS(){let e=(0,r._)(["Published on ",""]);return eS=function(){return e},e}function eE(e,t){if("button"===e&&"verbose"===t)return 16;if("button"===e)return 20;if("tabs"===e)return 24;if("compressed"===e)return 14;if("large-on-dark"===e)return 20;return 0}let eP=2,eN=e=>{let{isFullWidth:t,children:n}=e;return t?(0,a.tZ)(ec.gq,{className:"post-ufi-button-wrapper",gap:8,children:n}):n};function eT(e){let{post:t,pub:n,user:i,style:o,justified:r,isStatic:s,hideReactions:l,hideComments:c,hideShare:u,hideSavePost:m,useShareLabel:h,allowEdit:y,editButtonIsLast:f,onChange:v,hidePinning:g,showEmailSent:b,allowSendEmail:Z,footerHidden:C,onCommentsClick:k,labelStyle:w,showPreamble:S,preambleConfig:E={},position:P,hideByDisabling:N,showRestackButton:T,showRestackModal:I,showClipping:M,hideFeedRestackButton:B,onToggleMenu:O,postReactionToken:L,initialShareTimestamp:R}=e,D=(0,$.Tf)(),{showPins:A,showAudience:F,showDate:U,showDatetime:z,showAuthor:j,showPublicationName:H,showCrossPostedPublicationName:q}=E;l=l||!n.community_enabled||!t.slug||t.is_draft;let W=p()(Object.values((null==t?void 0:t.reactions)||{})),J=b?!!t.email_sent_at:null,Y=(0,K.LC)(),{iString:G}=(0,V.M1)(),ee=y&&(null==i?void 0:i.is_contributor)&&!Y,et=ex({post:t,pub:n,user:i,defaultOpen:T&&I&&"post-footer"!==P&&"post-footer-full-width"!==P}),{getConfigFor:en}=(0,Q.xR)(),ei=i&&(0,a.tZ)(eG,{style:o,pub:n,post:t,user:i,hidePinning:g,emailSent:null!=J?J:void 0,allowSendEmail:Z,footerHidden:C,canBeCrossPosted:T,onToggleMenu:O}),eo=!B&&n.community_enabled&&t.slug&&!t.is_draft,er=T&&!S&&(N||l&&c&&u&&!ee),ea="counts-or-none"===w&&t.comment_count?"count":"labels"===w?"cta":"none",es=i&&t.videoUpload&&(0,ek.a)(i,t,t.videoUpload),ec="post-footer-full-width"===P;return(0,a.BX)("div",{className:d()("post-ufi","style-".concat(o),{justified:r,themed:D,"single-full-width-button":er,"vertically-stacked":"shows-episode-player"===P}),children:[(0,a.BX)(eN,{isFullWidth:ec,children:[S&&E&&(0,a.tZ)(e8,{pub:n,post:t,showPins:A,showAudience:F,showDate:U,showDatetime:z,showEmailSent:b,showAuthor:j,showPublicationName:H,showCrossPostedPublicationName:q}),ee&&!f&&ei,M&&t.videoUpload&&!en("disable_clipping_for_readers")&&(0,a.tZ)(x.OZ,{post:t,mediaUpload:t.videoUpload,disabled:!es,style:o}),(N||!l)&&(0,a.tZ)(eM,{post:t,pub:n,user:i,labelStyle:N&&l?"none":"counts-or-none"===w&&W?"count":"labels"===w?"cta":"none",style:o,onChange:v,isStatic:!!s,isDisabled:N&&l||"shows-episode-player"===P&&!i,postReactionToken:L}),(N||!c)&&(0,a.tZ)(eJ,{post:t,pub:n,isStatic:s,labelStyle:N&&c?"none":ea,style:o,count:t.comment_count,onClick:k,isDisabled:N&&c}),eo&&(0,a.tZ)(eO,{pub:n,post:t,onChange:v,style:o,onToggleMenu:O,isStatic:s}),!u&&(0,a.tZ)(X.sp,{post:t,pub:n,user:i,trigger:{style:o,labelStyle:h?"cta":"none",isStatic:s},position:P,initialShareTimestamp:R,showClipping:M&&!!t.videoUpload,disableClipping:!es})]}),(0,a.BX)(eN,{isFullWidth:ec,children:[!m&&!T&&i&&(0,a.tZ)(eq,{post:t,labelStyle:ea,position:P,style:o,onChange:v}),ee&&f&&ei,T&&!ee&&"post-header"===P&&(0,a.tZ)(a.HY,{children:(0,a.BX)(ed.v2,{trigger:(0,a.tZ)(el.hU,{"aria-label":G("View repost options"),priority:"secondary-outline",children:(0,a.tZ)(_.Z,{size:20})}),children:[i&&(0,a.tZ)(eV,{onClick:et.open,post:t,pub:n,user:i}),(0,a.tZ)(eW,{post:t,onChange:v})]})}),T&&!ee&&ec&&(0,a.BX)(a.HY,{children:[!m&&(0,a.tZ)(eq,{post:t,labelStyle:"verbose",position:P,style:"button",onChange:v}),i&&(0,a.tZ)(eK,{onClick:et.open,post:t,pub:n,user:i,style:"button"})]})]}),et.modal]})}function ex(e){let{pub:t,user:n,post:i,defaultOpen:o=!1}=e,[r,s]=(0,l.eJ)(o);return(0,l.d4)(()=>{o&&n&&(0,en.j)(en.FP.RESTACK_POST_CLICKED,{restacked_publication_id:t.id,restacked_post_id:i.id,restacking_user_id:n.id,is_from_email:!0})},[o,t,i,n]),{open:()=>s(!0),modal:(0,a.tZ)(J.J,{pub:t,user:n,post:i,open:r,setOpen:s}),isOpen:r}}function eI(e){let{post:t,pub:n,user:i,isStatic:o,onChange:r,allowEdit:s,hidePinning:c,showEmailSent:u,allowSendEmail:p,hideComments:m,onCommentsClick:_,showRestackButton:y,showRestackModal:f,setFooterShown:v,postReactionToken:g}=e,b=function(){let e="undefined"==typeof window,[t,n]=(0,l.eJ)(e?0:window.pageYOffset),[i,o]=(0,l.eJ)(!1),r=(0,l.Ye)(()=>Date.now()+1e3,[]),a=(0,l.sO)(0);return(0,l.d4)(()=>{if(e)return;let i=h()(()=>{let e=Date.now(),i=(e-a.current)/1e3,s=(t-window.pageYOffset)/i;a.current=e,!(window.pageYOffset<0)&&(e<r?o(!1):-s>100?o(!0):s>100&&o(!1),n(window.pageYOffset))},250);return window.addEventListener("scroll",i),()=>window.removeEventListener("scroll",i)},[e,t,n,o,r,a,!1]),i}(),Z=(0,eh.pm)();return(0,l.d4)(()=>{Z.addOffset(64*(b?1:-1)),v&&v(!b)},[b,v]),(0,a.tZ)(ec.hs,{alignItems:"center",padding:8,className:d()("mobile-footer-ufi",{hidden:b}),children:(0,a.tZ)(eT,{post:t,pub:n,user:i,isStatic:o,justified:!0,style:"tabs",onChange:r,allowEdit:s,editButtonIsLast:!0,hidePinning:c,showEmailSent:u,allowSendEmail:p,footerHidden:b,labelStyle:"counts-or-none",hideComments:m,onCommentsClick:_,position:"mobile-toolbar",hideByDisabling:!0,showRestackModal:f,showRestackButton:y,postReactionToken:g})})}function eM(e){let{post:t,pub:n,user:i,style:o,labelStyle:r,onChange:s,isStatic:l,isDisabled:c,postReactionToken:d}=e,{iString:u}=(0,V.M1)(),m=p()(Object.values((null==t?void 0:t.reactions)||{})),h="count"===r?(0,eC.numberToString)(m||0):"cta"===r?"Like":null;return(0,a.tZ)(eU,{post:t,pub:n,user:i,onChange:s,isStatic:l,style:o,postReactionToken:d,children:e=>{let{isLiked:t,handleLike:n}=e;return(0,a.tZ)(eQ,{style:o,state:t?"liked":void 0,icon:(0,a.tZ)(R.Z,{className:"icon",height:eE(o),strokeWidth:eP}),onClick:c?()=>{}:n,noLabel:"none"===r,isDisabled:c,ariaLabel:u("Like")+("count"===r?" (".concat((0,eC.numberToString)(m||0),")"):""),ariaPressed:t,children:h})}})}function eB(e){let{style:t,onClick:n}=e;return(0,a.tZ)(eQ,{style:t,state:void 0,icon:(0,a.tZ)(y.Z,{className:"icon",height:eE(t),strokeWidth:eP}),"aria-label":"menu",onClick:n})}function eO(e){let{pub:t,post:n,style:r,onChange:s,onToggleMenu:c,isStatic:d}=e,[u,p]=(0,l.eJ)(!1),{iString:m}=(0,V.M1)(),{canRestack:h,isRestacked:_,restacks:y,menuItems:f,nuxModal:v,loggedOutRestackAttempt:g}=(0,e_.K)({pub:t,post:n,onRestack:e=>{null==s||s({post:(0,o._)((0,i._)({},n),{restacked:e,restacks:y+(e?1:-1)})})},renderWithoutUser:!0});if((0,l.d4)(()=>{g&&p(!0)},[g]),!h)return null;let b=!t.community_enabled,Z=(0,a.tZ)(eQ,{style:r,state:_?"restacked":void 0,icon:(0,a.tZ)(U.Z,{className:"icon",height:eE(r),strokeWidth:eP}),noLabel:0===y,"aria-label":"menu",isDisabled:b,children:y.toLocaleString(void 0,{maximumSignificantDigits:4})});return(0,a.BX)(a.HY,{children:[v,b?Z:(0,a.tZ)(ed.v2,(0,o._)((0,i._)({trigger:Z},c&&{onOpen:()=>{c({active:!0})},onClose:()=>{c({active:!1})}}),{ariaLabel:m("View repost options"),children:f})),(0,a.tZ)(es.Z,{displaySignInModal:u,onCloseSignInModal:()=>p(!1),isStatic:!!d,entry:"post-preview-like"})]})}function eL(e){let{postId:t,isOpen:n,onClose:i}=e,o=(0,Q.xR)(),{iString:r}=(0,V.M1)(),[s,c]=(0,l.eJ)(),d=!0==o.getConfigFor("enable_post_summarization"),u=(0,l.sO)(!1),p=(0,l.I4)(()=>{u.current=!0,P().post("/api/v1/posts/".concat(t,"/summary")).then(e=>{var t;(null===(t=e.body)||void 0===t?void 0:t.summary)&&c(e.body.summary)}).finally(()=>{u.current=!1})},[t]);return((0,l.d4)(()=>{n&&d&&!s&&!u.current&&p()},[n,p,d,s]),d)?(0,a.BX)(eu.u_,{isOpen:n,onClose:i,width:750,children:[(0,a.tZ)(eu.xB,{showClose:!0,title:r("Reader guide"),onClose:i}),(0,a.tZ)(ec.tu,{padding:16,paddingBottom:32,children:s?(0,a.tZ)("div",{dangerouslySetInnerHTML:{__html:s}}):(0,a.tZ)(ec.tu,{alignItems:"center",justifyContent:"center",style:{flex:1,minHeight:300},children:(0,a.tZ)("div",{className:"embed-loader"})})})]}):null}let eR=e=>{let{isOpen:t,setIsOpen:n}=e;return(0,l.d4)(()=>{let e=setTimeout(()=>{t&&n(!1)},1e4);return()=>clearTimeout(e)},[t]),(0,a.tZ)(eu.u_,{isOpen:t,onClose:()=>n(!1),width:300,children:(0,a.BX)(ec.tu,{padding:16,gap:16,children:[(0,a.tZ)(em.xv.H4,{translated:!0,children:"Generating PDF..."}),(0,a.tZ)(ec.tu,{alignItems:"center",children:(0,a.tZ)(ep.$j,{})})]})})};function eD(e){let{post:t,pub:n,user:i,onChange:o,showRestackModal:r,canBeCrossPosted:s,onSummaryOpen:c,onToggleRestackModal:d}=e,u="button",p=(0,Q.xR)(),m=!0==p.getConfigFor("enable_post_summarization"),[h,y]=(0,l.eJ)(!1),Z=ex({pub:n,user:i,post:t,defaultOpen:r&&s});return(0,l.d4)(()=>{null==d||d(Z.isOpen)},[d,Z.isOpen]),(0,a.BX)(a.HY,{children:[(0,a.tZ)(eR,{isOpen:h,setIsOpen:y}),(0,a.BX)(ed.v2,{trigger:(0,a.tZ)(eQ,{style:u,icon:(0,a.tZ)(_.Z,{className:"icon edit-icon",size:eE(u),strokeWidth:2}),noLabel:!0,"aria-label":"More"}),children:[i&&(0,a.tZ)(eW,{post:t,onChange:o,showIcon:!0}),m&&(0,a.tZ)(ed.sN,{leading:(0,a.tZ)(f.Z,{}),onClick:c,children:"Reader guide"}),s&&(0,a.tZ)(ed.sN,{leading:(0,a.tZ)(v.Z,{}),onClick:()=>{Z.open(),(0,en.j)(en.FP.RESTACK_POST_CLICKED,{restacked_publication_id:n.id,restacked_post_id:t.id,restacking_user_id:i.id,is_from_email:!1})},children:"Cross post"}),p.getConfigFor("show_open_post_as_pdf_button")&&(0,a.tZ)(ed.sN,{leading:(0,a.tZ)(g.Z,{}),onClick:()=>{y(!0),(0,ea.uX)((0,eZ.SUl)(n,t.id),{local_navigation:!1})},children:"Open as PDF"}),i&&(0,a.tZ)(ed.sN,{leading:(0,a.tZ)(b.Z,{}),href:(0,eZ.qUD)(t.id),children:"Substack Reader"})]}),Z.modal]})}function eA(e){var t;let n=p()(Object.values((null===(t=e.post)||void 0===t?void 0:t.reactions)||{}));return(0,a.tZ)(eM,(0,o._)((0,i._)({},e),{labelStyle:n>0?"count":"none"}))}let eF=e=>{let{pub:t,user:n}=e,[i,o]=(0,l.eJ)(null==n?void 0:n.email),[r,s]=(0,l.eJ)(!1),{iString:c}=(0,V.M1)();return(0,a.BX)(ec.tu,{gap:20,children:[(0,a.BX)(ec.tu,{gap:4,children:[(0,a.BX)(em.xv.H4,{translated:!0,weight:"semibold",children:["Support ",I18N.p(t.name)]}),(0,a.tZ)(em.xv.B4,{translated:!0,color:"secondary",children:"Since you liked this post, why not subscribe?"})]}),(0,a.BX)(ec.tu,{gap:12,children:[(0,a.tZ)("input",{disabled:!!(null==n?void 0:n.email),value:i,onChange:e=>o(e.currentTarget.value)}),(0,a.tZ)(el.zx,{onClick:async()=>{(0,en.j)(en.FP.LIKE_UPSELL_FREE_SUBSCRIBED,{email:i}),s(!0);try{let{referral_token:e}=(await P().post("/api/v1/free").send({email:i,source:"like-button-upsell"})).body;(0,en.IU)(),(0,ea.uX)((0,eZ.W1P)(t,{params:{utm_source:ew.b3.likeButtonUpsell,just_signed_up:!0,referral_token:e}}),{local_navigation:!1})}catch(e){alert((0,ea.zx)(e))}},flex:"grow",disabled:r,priority:"primary",role:"button","aria-label":c("Subscribe"),children:c(r?"Please wait...":"Subscribe")})]})]})};function eU(e){let{post:t,pub:n,user:i,onChange:o,isStatic:r,children:s,style:c,postReactionToken:u}=e,p=(0,l.sO)(),m=(0,l.sO)(),{isLiked:h,toggle:_}=function(e){let{post:t,user:n,surface:i,onChange:o,postReactionToken:r}=e,a=!!(null==t?void 0:t.reaction),s=(0,K.LC)(),l=(0,eo.ib)({pathname:(0,eZ.n1t)(s?"/api/v1/cross-post/".concat(null==t?void 0:t.id,"/reaction"):"/api/v1/post/".concat(null==t?void 0:t.id,"/reaction"),{token:r}),method:"POST",deps:[null==t?void 0:t.id]});return{isLiked:a,toggle:async()=>{var e;if(l.isLoading)return"error";let{reaction:r,reactions:a,reactor_names:s}=(0,W.fS)(null!=n?n:void 0,t);t.reaction=null!=r&&r,t.reactions=a,t.reactor_names=null!=s?s:[],null==o||o({post:t});let c=await l.refetch(r?{method:"POST",json:{reaction:"❤",surface:i}}:{method:"DELETE"}),d=null==c?void 0:null===(e=c.response)||void 0===e?void 0:e.status;if(d){let{reaction:e,reactions:i,reactor_names:r}=(0,W.fS)(null!=n?n:void 0,t);t.reaction=null!=e&&e,t.reactions=i,t.reactor_names=null!=r?r:[],null==o||o({post:t})}return 401===d?"unauthorized":d?"error":r?"liked":"unliked"}}}({post:t,user:i,subscribePromptRef:p,onChange:o,postReactionToken:u}),[y,f]=(0,l.eJ)(!1),v=(0,l.I4)(async e=>{var t;null==e||null===(t=e.stopPropagation)||void 0===t||t.call(e),"unauthorized"===await _()&&f(!0)},[_]);return(0,a.BX)("div",{className:d()("like-button-container","post-ufi-button","style-".concat(c),h&&"state-liked"),children:[s({isLiked:h,handleLike:v}),(0,a.tZ)(es.Z,{isStatic:r,displaySignInModal:y,onCloseSignInModal:()=>f(!1),entry:"post-preview-restack"}),i&&!i.is_admin&&!i.is_contributor&&("button"===c||"tabs"===c)&&(0,a.tZ)(I.Fx,{ref:p,className:d()("subscribe-prompt-dropdown",!(null==i?void 0:i.is_free_subscribed)&&"free"),hideMenuTail:!0,children:(null==i?void 0:i.is_free_subscribed)?(0,er.P)(i,n)?(0,a.tZ)(j.xt,{pub:n,onClose:()=>{var e;return null===(e=p.current)||void 0===e?void 0:e.close()},shareDialogRef:m}):(0,a.tZ)(j._q,{pub:n}):(0,a.tZ)(eF,{pub:n,user:i})}),!r&&(0,a.tZ)(Y.ZP,{ref:m,user:i,pub:n,post:t})]})}function ez(e){var t;let{post:n,defaultSaved:i,isSaved:o,trackSurface:r}=e;return ej({postId:n.id,defaultSaved:null!==(t=null!=i?i:n.is_saved)&&void 0!==t&&t,isSaved:o,trackSurface:r})}function ej(e){let{postId:t,defaultSaved:n,isSaved:i,trackSurface:o}=e,[r,a]=(0,l.eJ)(n),s=null!=i?i:r,{refetch:c}=(0,eo.ib)({pathname:"/api/v1/posts/saved",method:"POST",json:{post_id:t,surface:o},deps:[t]}),d=eX();return{isSaved:s,onSave:()=>(c({method:s?"DELETE":"POST"}),a(!s),d(!s),!s)}}async function eH(e,t,n){let{surface:i}=n;await (0,ei.rd)("/api/v1/posts/saved",{method:t?"POST":"DELETE",json:{post_id:e}}),(0,en.j)(en.FP.POST_SAVED,{post_id:e,surface:i,is_saved:t})}function eX(){let e=(0,eh.pm)(),{iString:t}=(0,V.M1)();return n=>{n?e.popToast(e=>(0,a.tZ)(eh.FN,(0,o._)((0,i._)({},e),{text:t("Post saved"),Icon:Z.Z,cta:t("View"),href:(0,eb.qQN)()}))):e.popToast(e=>(0,a.tZ)(eh.FN,(0,o._)((0,i._)({},e),{text:t("Post unsaved"),Icon:C.Z})))}}function eq(e){let{style:t,post:n,isSaved:r,labelStyle:s,position:l,onChange:c}=e,{isSaved:d,onSave:u}=ez({defaultSaved:r,post:n,isSaved:n.is_saved,trackSurface:l}),{iString:p}=(0,V.M1)();return(0,a.tZ)(eQ,{state:d?"saved":void 0,style:t,icon:(0,a.tZ)(O.Z,{className:"icon",height:eE(t,"verbose"===s?"verbose":null),strokeWidth:eP}),noLabel:"none"===s,verboseLabel:"verbose"===s,onClick:()=>{let e=u();null==c||c({post:(0,o._)((0,i._)({},n),{is_saved:e})})},ariaPressed:d,ariaLabel:p("Save"),children:"cta"===s||"verbose"===s?p("Save"):null})}function eW(e){let{post:t,isSaved:n,onChange:r,showIcon:s}=e,{onSave:l}=ez({defaultSaved:n,post:t,isSaved:t.is_saved}),{iString:c}=(0,V.M1)(),d=t.is_saved?"var(--color-accent-fg-orange)":void 0;return(0,a.tZ)(ed.sN,{leading:s?(0,a.tZ)(Z.Z,{style:{stroke:d,fill:d}}):void 0,onClick:()=>{let e=l();null==r||r({post:(0,o._)((0,i._)({},t),{is_saved:e})})},children:c(t.is_saved?"Unsave":"Save")})}function eJ(e){let t,{style:n,count:i,labelStyle:o,post:r,pub:s,isStatic:l,onClick:c,isDisabled:d}=e,{iString:u}=(0,V.M1)(),p=(0,ey.XA)(),m=(0,ee.aF)();return t=(null==r?void 0:r.comment_url_override)?r.comment_url_override:l?"".concat(N.W.HALF_MAGIC_COMMENTS_URL,"&utm_source=").concat(ew.b3.substack,"&utm_medium=").concat(ew.lP.email):!p||(null==m?void 0:m.is_contributor)?(0,eb.uRy)(s,r,{comments:!0}):(0,eb.K8_)(s.subdomain,r.slug,{params:{comments:!0,utm_source:ew.b3.post,utm_medium:ew.lP.web}}),(0,a.BX)(eQ,{style:n,icon:(0,a.tZ)(L.Z,{className:"icon",height:eE(n),strokeWidth:eP}),href:d?void 0:t,onClick:d?()=>{}:e=>{c?c(e):(null==e||e.preventDefault(),window.location.href=t)},noLabel:"none"===o,className:"post-ufi-comment-button",isDisabled:d,ariaLabel:u("cta"===o?"Comment":"View comments"+" (".concat((0,eC.numberToString)(i||0),")")),children:["cta"===o&&u("Comment"),"count"===o&&(0,eC.numberToString)(i||0)]})}function eY(e){let t,{post:n,user:i,pub:o,style:r,labelStyle:s,isStatic:c,onChange:u,position:p}=e,m=(0,l.sO)(),h=(0,l.I4)(()=>{(0,en.j)(en.FP.POST_SHARE_BUTTON_CLICKED,{position:p,post_id:n.id}),m.current.open()},[]),{iString:_}=(0,V.M1)();t=n.share_url_override?n.share_url_override:c?n?N.W.SHARE_URL:N.W.SHARE_PUB_URL:"javascript:void(0)";let y="none"===s;return(0,a.BX)(a.HY,{children:[(0,a.tZ)(eQ,{style:r,icon:y?(0,a.tZ)(k.Z,{className:"icon",height:eE(r),strokeWidth:eP}):null,onClick:h,href:t,noLabel:"none"===s,className:d()(!y&&"no-icon"),children:"cta"===s&&_("Share")}),!c&&(0,a.tZ)(Y.ZP,{ref:m,user:i,pub:o,post:n,onChange:u})]})}function eK(e){let{post:t,user:n,pub:i,onClick:o,style:r}=e,{iString:s}=(0,V.M1)();return(0,a.tZ)(a.HY,{children:(0,a.tZ)(eQ,{style:r,icon:(0,a.tZ)(D.Z,{className:"icon",height:eE(r,"verbose"),strokeWidth:eP}),onClick:()=>{(0,en.j)(en.FP.RESTACK_POST_CLICKED,{restacked_publication_id:i.id,restacked_post_id:t.id,restacking_user_id:n.id,is_from_email:!1}),o()},noLabel:!1,verboseLabel:!0,title:s("Cross-Post"),children:s("Cross-post")})})}function eV(e){let{post:t,user:n,pub:i,onClick:o}=e,{iString:r}=(0,V.M1)();return(0,a.tZ)(a.HY,{children:(0,a.tZ)(ed.sN,{onClick:()=>{(0,en.j)(en.FP.RESTACK_POST_CLICKED,{restacked_publication_id:i.id,restacked_post_id:t.id,restacking_user_id:n.id,is_from_email:!1}),o()},children:r("Cross-post")})})}function eG(e){let{style:t,pub:n,post:i,user:o,hidePinning:r,emailSent:s,allowSendEmail:c,footerHidden:u,showRestackModal:p,canBeCrossPosted:m,onSummaryOpen:h,onToggleMenu:y,onToggleRestackModal:f}=e,v=(0,l.sO)();u&&v.current&&v.current.close();let g=ex({post:i,pub:n,user:o,defaultOpen:p&&m});return(0,l.d4)(()=>{null==f||f(g.isOpen)},[f,g.isOpen]),(0,a.BX)("div",{className:d()("edit-button-container","post-ufi-button","style-".concat(t)),children:[(0,a.tZ)(eQ,{onClick:()=>v.current.open(),style:t,icon:(0,a.tZ)(_.Z,{className:"icon edit-icon",size:eE(t),strokeWidth:2}),noLabel:!0}),(0,a.tZ)(H.y,{ref:v,pub:n,post:i,user:o,className:"post-ufi-edit-menu",useDrawerOnMobile:!0,hidePinning:r,emailSent:s,allowSendEmail:c,handleCrossPost:m?()=>{g.open(),(0,en.j)(en.FP.RESTACK_POST_CLICKED,{restacked_publication_id:n.id,restacked_post_id:i.id,restacking_user_id:o.id,is_from_email:!1})}:void 0,onSummaryOpen:h,onToggleMenu:y}),g.modal]})}let eQ=(0,s.forwardRef)((e,t)=>{let{icon:n,children:i,state:o,style:r,onClick:s,href:l,noLabel:c,verboseLabel:u,noBorder:p,className:m,isDisabled:h,iconPosition:_="left",title:y,ariaLabel:f,ariaPressed:v}=e;return(0,a.BX)("a",{role:"button",className:d()("post-ufi-button","style-".concat(r),m,o?"state-".concat(o):void 0,h?"state-disabled":void 0,i&&!c?"has-label":"no-label",p?"no-border":"with-border",u?"verbose-label":""),title:y,href:l,onClick:e=>{s&&(e.stopPropagation(),s(e))},ref:t,"aria-label":null!=f?f:y,"aria-pressed":v,children:["left"===_&&n,!c&&i&&(0,a.tZ)("div",{className:"label",children:i}),"right"===_&&n]})}),e$=e=>{let{pub:t,post:n,showAuthor:i}=e;return!!(i&&t.bylines_enabled&&(0,eC.getPrintedByline)(t,n))},e0=e=>{let{pub:t,post:n,showAuthor:i,showPhoto:o,isMobileWidth:r}=e;return e$({pub:t,post:n,showAuthor:i})&&!e1({pub:t,post:n,showAuthor:i})&&!e2({pub:t,post:n,showAuthor:i,showPhoto:o})&&!r},e1=e=>{let{pub:t,post:n,showAuthor:i}=e;return e$({pub:t,post:n,showAuthor:i})&&(0,eC.getBylineUsers)(n).length>1},e2=e=>{var t;let{pub:n,post:i,showAuthor:o,showPhoto:r}=e;return!!(e$({pub:n,post:i,showAuthor:o})&&r&&(null===(t=(0,eC.getBylineUsers)(i)[0])||void 0===t?void 0:t.photo_url)&&n.byline_images_enabled)};function e4(e){let{post:t,showDatetime:n,isStatic:i,fromPostPage:o,showReactions:r,language:a="en"}=e,s=t.reactions?Object.values(t.reactions).reduce((e,t)=>e+t,0):0,l=o&&!i&&r&&s>=70&&s<100;return n&&l?(0,ef.Z)(t.post_date).locale(a).standardDatetimeWithYear():n&&!l?(0,ef.Z)(t.post_date).locale(a).standardDatetime():i?(0,ef.Z)(t.post_date).locale(a).standardDate():l?(0,ef.Z)(t.post_date).locale(a).standardDate({full:l}):(0,ef.Z)(t.post_date).locale(a).standardDateOrTime()}function e8(e){let{pub:t,post:n,showPins:i,showAudience:o,showDate:r,showDatetime:s,showEmailSent:l,showAuthor:c,showPublicationName:u,showCrossPostedPublicationName:p}=e,m=(0,$.Tf)(),h=!!(c&&t.bylines_enabled&&(0,eC.getPrintedByline)(t,n)),_=r&&n.post_date&&!n.is_draft,y=l?!!n.email_sent_at:null,{iString:f,iTemplate:v,language:g}=(0,V.M1)();return(0,a.BX)("div",{className:d()("ufi-preamble",{themed:m}),children:[p&&n.restacked_pub_name?(0,a.tZ)("div",{className:"ufi-preamble-label cross-posted-pub-name",children:v(eS(),n.restacked_pub_name)}):null,l&&y&&(0,a.tZ)("div",{className:"email-sent",title:f("This post was sent as an email"),children:(0,a.tZ)(w.Z,{className:"post-ufi-preamble-icon",size:16})}),i&&n.is_section_pinned&&(0,a.tZ)("div",{className:"pinned",children:(0,a.tZ)(z.Z,{className:"post-ufi-preamble-icon"})}),"adhoc_email"===n.type?(0,a.tZ)("div",{className:"audience-adhoc",children:(0,a.tZ)(M.Z,{className:"post-ufi-preamble-icon"})}):o&&(0,ev.isPaidAudience)(n.audience)&&(0,a.tZ)("div",{className:"audience-lock",children:(0,a.tZ)(T.Z,{audience:n.audience,className:"lock-icon post-ufi-preamble-icon",size:16})}),e0({pub:t,post:n,showAuthor:h,isMobileWidth:!1})&&(0,a.tZ)("div",{className:"ufi-preamble-label author",children:(0,eC.getBylineUsers)(n).length>0?(0,eC.oxfordComma)((0,eC.getBylineUsers)(n).map(e=>(0,a.tZ)(a.HY,{children:(0,a.tZ)(q.ProfileHoverCard,{subject:e,utmSource:"byline",children:(0,a.tZ)("a",{href:(0,eb.LwU)(e,t,{base:!0}),onClick:e=>e.stopPropagation(),children:e.name})})}))):(0,eC.getPrintedByline)(t,n)}),u&&(0,a.tZ)("div",{className:"post-publication-name",children:t.name}),_&&(0,a.tZ)("div",{className:"ufi-preamble-label post-date",title:(0,ef.Z)(n.post_date).toISOString(),children:(0,a.tZ)("time",{dateTime:(0,ef.Z)(n.post_date).toISOString(),children:e4({post:n,showDatetime:s,language:g})})})]})}let e3=e=>{let{pub:t,post:n,user:i,onChange:o,postReactionToken:r}=e;return(0,Q.xR)().getConfigFor("like_posts_enabled")&&t.community_enabled?(0,a.tZ)(eA,{style:"button",post:n,pub:t,user:i,onChange:o,postReactionToken:r}):null},e5=e=>{let{pub:t,post:n,onClick:i}=e,o=(0,eC.showCommentsOnPost)({publication:t,post:n}),{comment_count:r}=n;return o?(0,a.tZ)(eJ,{post:n,pub:t,labelStyle:r>0?"count":"none",style:"button",count:r,onClick:i}):null};function e9(e){let{hideBottomBorder:t,post:n,pub:i,user:o,onChange:r,onCommentsClick:s,showRestackModal:c=!1,showTranscriptionButton:d,onTranscriptionClick:u,postReactionToken:p,onToggleRestackModal:m,onTranscriptClick:h}=e,{iString:_}=(0,V.M1)(),y=(0,K.LC)(),f=(null==o?void 0:o.is_contributor)&&!y,{getSettingFor:v}=(0,G.So)(),g=!n.is_draft&&(0,eg.x)(o,{enable_restacking:!!v("enable_restacking")},n,i,!1),[b,Z]=(0,l.eJ)(!1),C=o&&n.videoUpload&&(0,ek.a)(o,n,n.videoUpload);return(0,a.BX)(ec.hs,{className:"post-ufi",alignItems:"center",borderTop:"detail-themed",borderBottom:t?void 0:"detail-themed",justifyContent:"space-between",gap:16,flex:"grow",paddingY:16,children:[(0,a.BX)(ec.hs,{gap:8,children:[(0,a.tZ)(e3,{post:n,pub:i,user:o,onChange:r,postReactionToken:p}),(0,a.tZ)(e5,{pub:i,post:n,onClick:s}),(0,a.tZ)(eO,{pub:i,post:n,onChange:r,style:"button"}),d&&(0,a.tZ)(eB,{style:"button",onClick:u})]}),(0,a.BX)(ec.hs,{gap:8,children:[(0,a.tZ)(X.sp,{post:n,pub:i,user:o,trigger:{style:"button",labelStyle:"cta"},showClipping:!!n.videoUpload,disableClipping:!C}),h&&(0,a.tZ)(eQ,{onClick:h,style:"button",icon:(0,a.tZ)(S.Z,{color:"var(--color-secondary-themed)",size:16}),children:_("Transcript")}),f?(0,a.tZ)(eG,{style:"button",pub:i,post:n,user:o,showRestackModal:c,canBeCrossPosted:g,onSummaryOpen:()=>Z(!0),onToggleRestackModal:m}):(o||g)&&(0,a.tZ)(eD,{post:n,pub:i,user:o,onChange:r,showRestackModal:c,canBeCrossPosted:g,onSummaryOpen:()=>Z(!0),onToggleRestackModal:m})]}),(0,a.tZ)(eL,{postId:n.id,isOpen:b,onClose:()=>Z(!1)})]})}function e6(e){let{isFooter:t,customization:{showAppUpsell:n,showShare:r,showComments:s,showReactions:l,showListen:c,showSave:u,showRestack:p,showCommentRestack:m}}=e,h=!t&&(p||c||u),{iString:_}=(0,V.M1)();return t||r||s||l||c||u||!p?(0,a.BX)(et.YF,{className:t?"email-ufi-2-bottom":"email-ufi-2-top",width:"100%",children:[p&&t&&(0,a.BX)(a.HY,{children:[(0,a.tZ)(e7,{}),(0,a.tZ)("tr",{children:(0,a.tZ)("td",{children:(0,a.BX)(et.YF,{width:"100%",className:"email-ufi-2-row",children:[(0,a.tZ)("tr",{children:(0,a.tZ)("td",{width:"95%",children:r&&(0,a.BX)(et._i,{tableClassName:"email-button-outline-wrapper-full-width",aClassName:"email-button-outline full-width",href:N.W.SHARE_URL,children:[(0,a.tZ)(A.Z,(0,i._)({},te)),(0,a.tZ)("span",{className:"email-button-text",children:_("Share")})]})})}),(0,a.tZ)(e7,{})]})})})]}),(0,a.tZ)(e7,{}),(0,a.tZ)("tr",{children:(0,a.tZ)("td",{children:(0,a.tZ)(et.YF,{width:"100%",children:(0,a.BX)("tr",{children:[(0,a.tZ)("td",{children:(0,a.BX)(et.zK,{gap:8,style:h?void 0:{margin:"0 auto"},children:[l?t?(0,a.BX)(et._i,{aClassName:"email-button-outline",href:N.W.REACTION_URL,children:[(0,a.tZ)(R.Z,(0,i._)({},te)),(0,a.tZ)("span",{className:"email-button-text",children:_("Like")})]}):(0,a.tZ)(tt,{href:N.W.REACTION_URL,children:(0,a.tZ)(R.Z,(0,i._)({},te))}):null,s?t?(0,a.BX)(et._i,{aClassName:"email-button-outline",href:"".concat(N.W.HALF_MAGIC_COMMENTS_URL,"&utm_source=").concat(ew.b3.substack,"&utm_medium=").concat(ew.lP.email),children:[(0,a.tZ)(L.Z,(0,i._)({},te)),(0,a.tZ)("span",{className:"email-button-text",children:_("Comment")})]}):(0,a.tZ)(tt,{href:"".concat(N.W.HALF_MAGIC_COMMENTS_URL,"&utm_source=").concat(ew.b3.substack,"&utm_medium=").concat(ew.lP.email),children:(0,a.tZ)(L.Z,(0,i._)({},te))}):null,r&&n&&(t?(0,a.BX)(et._i,{aClassName:"email-button-outline",href:N.W.SHARE_URL,children:[(0,a.tZ)(F.Z,(0,i._)({},te)),(0,a.tZ)("span",{className:"email-button-text",children:_("Share")})]}):(0,a.tZ)(tt,{href:N.W.SHARE_URL,children:(0,a.tZ)(F.Z,(0,i._)({},te))})),m&&(t?(0,a.BX)(et._i,{aClassName:"email-button-outline",href:"".concat(N.W.RESTACK_COMMENT_URL,"&utm_source=").concat(ew.b3.substack,"&utm_medium=").concat(ew.lP.email),children:[(0,a.tZ)(U.Z,(0,i._)({},te)),(0,a.tZ)("span",{className:"email-button-text",children:_("Restack")})]}):(0,a.tZ)(tt,{href:"".concat(N.W.RESTACK_COMMENT_URL,"&utm_source=").concat(ew.b3.substack,"&utm_medium=").concat(ew.lP.email),children:(0,a.tZ)(U.Z,(0,i._)({},te))}))]})}),(0,a.tZ)("td",{align:"right",children:(0,a.BX)(et.zK,{gap:8,children:[r&&!n&&!t&&(0,a.BX)(et._i,{aClassName:"email-button-outline",href:N.W.SHARE_URL,children:[(0,a.tZ)("div",{className:"email-button-spacer"}),(0,a.tZ)("span",{className:"email-button-text",children:_("Share")})]}),n&&!t&&(0,a.BX)(et._i,{aClassName:"email-button-outline",href:"".concat(N.W.POST_APP_LINK_URL,"&utm_campaign=email-read-in-app"),children:[(0,a.tZ)("div",{className:"email-button-spacer"}),(0,a.tZ)("span",{className:"email-button-text",style:{marginRight:4},children:_("READ IN APP")}),(0,a.tZ)(B.Z,(0,o._)((0,i._)({},te),{className:d()("icon","text-icon")}))]})]})})]})})})}),(0,a.tZ)(e7,{})]}):(0,a.tZ)(et.YF,{className:"email-ufi-2-empty",width:"100%",children:(0,a.tZ)("tr",{height:1,children:(0,a.tZ)("td",{height:1,style:{fontSize:0,lineHeight:0},children:"\xa0"})})})}function e7(){return(0,a.tZ)("tr",{height:16,children:(0,a.tZ)("td",{height:16,style:{fontSize:0,lineHeight:0},children:"\xa0"})})}let te={className:"icon",height:18,strokeWidth:1,isStatic:!0,stroke:"#808080",fill:"none"};function tt(e){let{size:t=38,href:n,children:i}=e;return(0,a.tZ)(et.YF,{width:t,children:(0,a.tZ)("tr",{children:(0,a.tZ)("td",{align:"center",children:(0,a.tZ)("a",{className:"email-icon-button",href:n,style:{width:t},children:i})})})})}},19548:function(e,t,n){n.d(t,{CH:()=>v,KG:()=>y,gc:()=>f});var i=n(7409),o=n(99282),r=n(16584),a=n(6400),s=n(30396),l=n(10844),c=n(88812),d=n(60807),u=n(48980);n(7882);var p=n(98914),m=n(44424),h=n(70379);let _=(0,a.createContext)({result:{mutes:[],blocks:[],blocked:[]},refetch:async()=>null,isBlockingUser:()=>!1,isMutedByUser:()=>!1,isBlockedByUser:()=>!1});function y(e){let{isBlockingUser:t,isBlockedByUser:n}=(0,s.qp)(_);return e?n(e)?"blocking":t(e)?"blocked":null:null}function f(e){let{isBlockingUser:t,isBlockedByUser:n,isMutedByUser:i}=(0,s.qp)(_);return e?i(e)?"muting":n(e)?"blocking":t(e)?"blocked":null:null}function v(e,t){let{surface:n,noteId:a,onClick:y}=t,v=(0,d.aF)(),g=!!(v&&e&&v.id!==e.id),b=(0,s.qp)(_),Z=f(null==e?void 0:e.id),C=(0,h.pm)(),k=async()=>{if(e){try{await (0,u.rd)("/api/v1/blocks/".concat(e.id),{method:"POST",json:{type:"mute",surface:n,noteId:a}})}catch(e){C.popToast(t=>(0,r.tZ)(h.FN,(0,o._)((0,i._)({},t),{text:(0,p.zx)(e)})));return}b.refetch(),C.popToast(t=>(0,r.tZ)(h.FN,(0,o._)((0,i._)({},t),{text:"".concat(e.name||"User"," muted"),Icon:l.Z}))),null==y||y("mute")}},w=async()=>{if(e){try{await (0,u.rd)("/api/v1/blocks/".concat(e.id),{method:"DELETE",query:{surface:n,noteId:a}})}catch(e){C.popToast(t=>(0,r.tZ)(h.FN,(0,o._)((0,i._)({},t),{text:(0,p.zx)(e)})));return}b.refetch(),C.popToast(t=>(0,r.tZ)(h.FN,(0,o._)((0,i._)({},t),{text:"".concat(e.name||"User"," unmuted"),Icon:l.Z}))),null==y||y("unmute")}},S=async()=>{if(e){try{await (0,u.rd)("/api/v1/blocks/".concat(e.id),{method:"POST",json:{type:"block",surface:n,noteId:a}})}catch(e){C.popToast(t=>(0,r.tZ)(h.FN,(0,o._)((0,i._)({},t),{text:(0,p.zx)(e)})));return}b.refetch(),C.popToast(t=>(0,r.tZ)(h.FN,(0,o._)((0,i._)({},t),{text:"".concat(e.name||"User"," blocked"),Icon:c.Z}))),null==y||y("block")}},E=async()=>{if(e){try{await (0,u.rd)("/api/v1/blocks/".concat(e.id),{method:"DELETE",query:{surface:n,noteId:a}})}catch(e){C.popToast(t=>(0,r.tZ)(h.FN,(0,o._)((0,i._)({},t),{text:(0,p.zx)(e)})));return}b.refetch(),C.popToast(t=>(0,r.tZ)(h.FN,(0,o._)((0,i._)({},t),{text:"".concat(e.name||"User"," unblocked"),Icon:c.Z}))),null==y||y("unblock")}},P=[];return g&&("blocking"!==Z&&P.push((0,r.tZ)(m.sN,{leading:(0,r.tZ)(l.Z,{}),priority:"destructive",onClick:"muting"===Z?w:k,children:"muting"===Z?"Unmute":"Mute"})),P.push((0,r.tZ)(m.sN,{leading:(0,r.tZ)(c.Z,{}),priority:"destructive",onClick:"blocking"===Z?E:S,children:"blocking"===Z?"Unblock":"Block"}))),P}_.displayName="UserBlockContext",(0,a.createContext)(!1).displayName="MuteFreeZone"},36848:function(e,t,n){n.d(t,{Qu:()=>l,RD:()=>s});var i=n(98848),o=n(16584),r=n(6400);n(98661);var a=n(30396);let s=(0,r.createContext)({country:"US"});function l(e){var{children:t}=e,n=(0,i._)(e,["children"]);let r=(0,a.Ye)(()=>n,Object.values(n));return(0,o.tZ)(s.Provider,{value:r,children:t})}s.displayName="LocaleContext"},93155:function(e,t,n){n.d(t,{DY:()=>l,dd:()=>c});var i=n(16584),o=n(6400),r=n(30396),a=n(10704);let s=(0,o.createContext)({openModal:()=>{},closeModal:()=>{}});function l(e){let{children:t}=e,[n,o]=(0,r.eJ)(!1),[l,c]=(0,r.eJ)({width:540,children:null}),d=()=>{o(!1)};return(0,i.BX)(s.Provider,{value:{openModal:e=>{c(e),o(!0)},closeModal:d},children:[(0,i.tZ)(a.u_,{isOpen:n,onClose:d,width:l.width,overflow:"hidden",children:l?l.children:null}),t]})}function c(){return(0,r.qp)(s)}s.displayName="ModalContext"},13748:function(e,t,n){n.d(t,{U:()=>ei,v:()=>er});var i=n(7409),o=n(99282),r=n(98848),a=n(16584),s=n(30396),l=n(27194),c=n(99869),d=n(71212),u=n(48916),p=n(68494),m=n(77600),h=n(59543),_=n(67659),y=n(23260),f=n(48493),v=n(78796),g=n(7073),b=n(85200),Z=n(18794),C=n(13808),k=n(51455),w=n(53076),S=n(94442),E=n(79094),P=n(19548),N=n(35543),T=n(95441),x=n(93155),I=n(40647),M=n(60807),B=n(42375),O=n(25991),L=n(85527),R=n(48980),D=n(7882),A=n(98914),F=n(15771),U=n(19081),z=n(44424),j=n(15562),H=n(78096),X=n(70379),q=n(15503),W=n(27744),J=n(2009),Y=n(88817),K=n(75419),V=n(98012),G=n(31377),Q=n(42886),$=n(33884),ee=n(63651),et=n(84864),en=n(5749);function ei(e){var t,n,r,Z,C;let{publication:S,post:Y,comment:ei,item:er,allowHide:ea=!1}=e,es=(0,X.pm)(),{getConfigFor:el}=(0,I.xR)(),ec=(0,B.rI)(),ed=(0,L.F)(),eu=(0,W.I0)(),ep=(0,W.kc)(),{iString:em}=(0,T.M1)(),[eh,e_]=(0,s.eJ)(!1),[ey,ef]=(0,s.eJ)(!1),[ev,eg]=(0,s.eJ)(!1),eb=(0,M.aF)(),eZ=(0,E.T)(),{openModal:eC,closeModal:ek}=(0,x.dd)(),ew=null!==(Z=null==ei?void 0:null===(t=ei.ancestor_path)||void 0===t?void 0:t.split(".").filter(Boolean).map(Number).map(e=>ep.comments.get(e)))&&void 0!==Z?Z:[],eS=ei?(0,G.getCommentAuthor)(ei):S&&Y?(0,G.getPostAuthor)(S,Y):{id:0,name:"void"},eE=er&&"entity_key"in er?er.entity_key:void 0,eP=(0,P.CH)(eS,{surface:ec,noteId:eE,onClick(e){er&&(0,q.rw)(er,ec,e,{tabId:ed})}}),eN=(0,N.oh)(eS,ec,eE),eT=(0,D.ib)({pathname:"/api/v1/comment/".concat(null!==(C=null==ei?void 0:ei.id)&&void 0!==C?C:0),method:"DELETE",json:{publication_id:null==S?void 0:S.id}}),ex=async()=>{if(!ei||(e_(!1),eT.isLoading))return;let e=await eT.refetch();if(e instanceof Error){alert((0,A.zx)(e));return}es.popToast(e=>(0,a.tZ)(X.FN,(0,o._)((0,i._)({},e),{text:em("Note deleted"),Icon:l.Z}))),eu({type:"comment_delete",payload:{publication:null!=S?S:void 0,post:null!=Y?Y:void 0,comment:ei}})},eI=(0,K.i3)(),eM=async()=>{ei&&eI.open({editComment:ei,tabId:ed,surface:ec})},eB=er&&(0,Q.D2)(er)&&"post"===er.type&&er.mediaClip,eO=async(e,t)=>{await (0,R.rd)("/api/v1/comment/".concat(e.id,"/juice"),{method:"POST",json:{times_to_show:t}}),es.popToast(e=>(0,a.tZ)(X.FN,(0,o._)((0,i._)({},e),{text:em("Juiced"),Icon:u.Z}))),ef(!1)},eL=async(e,t)=>{if(!e.comment&&!e.post)return;let n="post"===e.type?e.post.id:e.comment.id,r=t?{expires_at:(0,V.Z)().add(t,"hour").toISOString()}:{};await (0,R.rd)("/api/v1/notification_settings/".concat(e.type,"/").concat(n,"/mute"),{method:"POST",json:r}),eu({type:"item_pause_notifications",payload:{entityKey:e.entity_key}}),es.popToast(e=>(0,a.tZ)(X.FN,(0,o._)((0,i._)({},e),{text:em("Paused"),Icon:p.Z}))),eg(!1)},eR=async e=>{if(!e.comment&&!e.post)return;let t="post"===e.type?e.post.id:e.comment.id;await (0,R.rd)("/api/v1/notification_settings/".concat(e.type,"/").concat(t,"/mute"),{method:"DELETE"}),eu({type:"item_unpause_notifications",payload:{entityKey:e.entity_key}}),es.popToast(e=>(0,a.tZ)(X.FN,(0,o._)((0,i._)({},e),{text:em("Unpaused"),Icon:p.Z})))},eD=async()=>{try{if(!ei){es.popToast(e=>(0,a.tZ)(X.FN,(0,o._)((0,i._)({},e),{text:em("Error starting workflow: comment not found")})));return}let{workflowId:e}=await (0,R.rd)("/api/v1/comment/".concat(ei.id,"/workflow"),{method:"POST",json:{}});es.popToast(t=>(0,a.tZ)(X.FN,(0,o._)((0,i._)({},t),{text:"Workflow started with id ".concat(e)})))}catch(e){es.popToast(t=>(0,a.tZ)(X.FN,(0,o._)((0,i._)({},t),{text:"Error starting workflow: ".concat(e)})))}},eA=!!Y&&er&&"context"in er&&O.nH.includes(er.context.type),eF=ea&&er&&"entity_key"in er&&eb&&eb.id!==eS.id,eU=eb&&eb.id===eS.id&&(null==er?void 0:er.type)&&["comment","post"].includes(er.type),ez=[(0,a.tZ)(z.sN,{leading:(0,a.tZ)(c.Z,{}),onClick:()=>{let e=ei?(0,ee.Sgq)(ei):Y?(0,ee.mx9)(S,Y,{mediaClip:eB||void 0}):null;(0,A.vQ)(e),es.popToast(e=>(0,a.tZ)(X.FN,(0,o._)((0,i._)({},e),{text:em("Copied link to clipboard"),Icon:c.Z})))},children:em("Copy link")}),!ei&&Y&&(0,a.tZ)(eo,{post:Y}),...eN,(0,a.tZ)(z.sN,{leading:(0,a.tZ)(m.Z,{}),onClick:()=>{eC({children:(0,a.tZ)(k.I,{comment:ei||void 0,onClose:ek}),width:540})},children:em("Embed")}),ei?(0,a.tZ)(z.sN,{leading:(0,a.tZ)(d.Z,{}),onClick:()=>{es.popToast(e=>(0,a.tZ)(X.FN,(0,o._)((0,i._)({},e),{text:em("Downloading image..."),Icon:d.Z})))},href:(0,$.IY)(ei.id),target:"_blank",download:!0,children:em("Save as image")}):null].filter(Boolean),ej=[(0,et.canEditComment)(eb,ei)&&(0,a.tZ)(z.sN,{leading:(0,a.tZ)(h.Z,{}),onClick:eM,children:em("Edit")}),ei&&((null==eb?void 0:eb.is_global_admin)||(null==eb?void 0:eb.id)===ei.user_id||el("show_note_stats_for_all_notes"))?(0,a.tZ)(z.sN,{leading:(0,a.tZ)(_.Z,{}),href:(0,$.wn)(ei,{noBase:J.L}),native:!0,children:em("View stats")}):null].filter(Boolean),eH=(null==er?void 0:er.type)&&["comment","post"].includes(er.type)&&ep.mutedFeedItems.has(er.entity_key),eX=[eF&&(0,a.tZ)(z.sN,{leading:(0,a.tZ)(y.Z,{}),onClick:async()=>{try{eu({type:"item_hide",payload:{entityKey:er.entity_key}}),await (0,R.rd)("/api/v1/note/".concat(er.entity_key,"/hide"),{method:"POST",json:{tabId:ed,surface:ec}})}catch(e){es.popToast(t=>(0,a.tZ)(X.FN,(0,o._)((0,i._)({},t),{text:(0,A.zx)(e)})))}},children:(eb.is_admin||eb.is_contributor)&&"post-page-restacks-list"===ec?em("Hide note from post"):em("Hide note")}),eU&&(0,a.tZ)(z.sN,{leading:(0,a.tZ)(f.Z,{}),onClick:async()=>eH?await eR(er):eg(!0),children:eH?em("Unpause notifications"):em("Pause notifications")}),(null==eb?void 0:eb.is_global_admin)&&ei&&(null===(r=ei.attachments)||void 0===r?void 0:null===(n=r[0])||void 0===n?void 0:n.type)==="video"?(0,a.tZ)(z.sN,{leading:(0,a.tZ)(v.Z,{}),priority:"secondary",onClick:eD,children:em("Run workflow")}):null].filter(Boolean),eq=[...eP,ei&&(0,et.canReportComment)(eb,ei)?(0,a.tZ)(z.sN,{leading:(0,a.tZ)(g.Z,{}),priority:"destructive",onClick:()=>{let e=!!ei.publication_id;eZ({pub:null!=S?S:void 0,canReportToAdmins:e,onSubmit:async t=>{let{reportCategory:n,details:o,reportedToSubstack:r}=t;await (0,R.rd)("/api/v1/comment/".concat(ei.id,"/report"),{method:"POST",json:(0,i._)({details:o,reportCategory:n,reportedToSubstack:r},e?{publication_id:ei.publication_id}:{})})}})},children:em("Report")}):eA?(0,a.tZ)(z.sN,{leading:(0,a.tZ)(g.Z,{}),priority:"destructive",onClick:()=>{eZ({pub:null!=S?S:void 0,canReportToAdmins:!1,onSubmit:async e=>{let{reportCategory:t,details:n}=e;await (0,R.rd)("/api/v1/publications/".concat(null==S?void 0:S.id,"/posts/").concat(Y.id,"/report"),{method:"POST",json:{details:n,reportCategory:t}})}})},children:em("Report")}):null,(0,et.canDeleteComment)(eb,ei,{pub:null!=S?S:void 0,post:null!=Y?Y:void 0,parentComments:ew})&&(0,a.tZ)(z.sN,{leading:(0,a.tZ)(l.Z,{}),priority:"destructive",onClick:()=>e_(!0),children:em("Delete")}),(null==eb?void 0:eb.is_global_admin)&&ei?(0,a.tZ)(z.sN,{leading:(0,a.tZ)(u.Z,{}),priority:"destructive",onClick:async()=>{ef(!0)},children:em("Juice")}):null].filter(Boolean),eW=[0!==ez.length&&ez,0!==ej.length&&(0,a.tZ)(z.xw,{children:ej}),0!==eX.length&&(0,a.tZ)(z.xw,{children:eX}),0!==eq.length&&(0,a.tZ)(z.xw,{children:eq})];return 0===eW.length?null:(0,a.BX)(a.HY,{children:[(0,a.tZ)(z.v2,{trigger:(0,a.tZ)(U.hs,{className:en.Z.moreButtonContainer,children:(0,a.tZ)(F.hU,{priority:"quaternary",size:"sm",className:en.Z.moreButton,"aria-label":em("More options"),children:(0,a.tZ)(b.Z,{size:16})})}),maxHeight:350,onOpen:()=>{er&&(0,q.rw)(er,ec,"menu",{tabId:ed})},children:eW}),(0,a.tZ)(j.W,{isOpen:eh,title:em("Delete note"),description:em("Are you sure you want to permanently delete this note? This action cannot be undone."),primaryButton:(0,a.tZ)(F.zx,{priority:"destructive",onClick:ex,children:em("Delete")}),secondaryButton:(0,a.tZ)(F.zx,{priority:"secondary",onClick:()=>e_(!1),children:em("Cancel")}),onClose:()=>e_(!1)}),(null==eb?void 0:eb.is_global_admin)&&(0,a.tZ)(j.W,{isOpen:ey,title:em("Juice note"),description:em("How many additional impressions would you like this note to receive? 100 impressions equals roughly 1-3 likes."),primaryButton:(0,a.BX)(H.dm,{priority:"secondary-outline",size:"md",children:[(0,a.tZ)(H.yo,{onClick:async()=>{await eO(ei,100)},children:"100"}),(0,a.tZ)(H.yo,{onClick:async()=>{await eO(ei,500)},children:"500"}),(0,a.tZ)(H.yo,{onClick:async()=>{await eO(ei,1e3)},children:"1000"})]}),secondaryButton:(0,a.tZ)(U.hs,{flex:"grow",children:(0,a.tZ)(F.zx,{priority:"secondary",onClick:()=>ef(!1),children:em("Cancel")})}),onClose:()=>ef(!1)}),ev&&eU&&(0,a.tZ)(w.r,{isOpen:ev,type:null==er?void 0:er.type,onClose:()=>eg(!1),handleMute:e=>eL(er,e)})]})}function eo(e){var{post:t}=e,n=(0,r._)(e,["post"]);let s=(0,M.aF)(),{requireLogin:l}=(0,Y.SJ)(),c=()=>null==l?void 0:l({redirectOverride:(0,ee.uRy)(null,t,{urlParams:{triggerSave:!0}})}),d=er(t),{iString:u}=(0,T.M1)();return(0,a.tZ)(z.sN,(0,o._)((0,i._)({leading:t.is_saved?(0,a.tZ)(Z.Z,{}):(0,a.tZ)(C.Z,{}),onClick:()=>s?d():c()},n),{children:u(t.is_saved?"Unsave":"Save")}))}function er(e){let t=(0,W.I0)(),n=(0,S.c1)();return()=>{let i=e.id,o=!e.is_saved;(0,S.TJ)(i,o,{surface:"reader"}),n(o),t({type:"post_save",payload:{postId:i,isSaved:o}})}}},93963:function(e,t,n){n.d(t,{$w:()=>R});var i=n(7409),o=n(99282),r=n(98848),a=n(16584),s=n(98661),l=n(94184),c=n.n(l),d=n(21465),u=n(66289),p=n(53804),m=n(25226),h=n(95441),_=n(60807),y=n(42375),f=n(85527),v=n(68833),g=n(7882),b=n(98914),Z=n(15771),C=n(19081),k=n(44424),w=n(58175),S=n(15503),E=n(27744);n(21972);var P=n(88817),N=n(75419),T=n(43681),x=n(39493);n(61412);var I=n(42886),M=n(63651),B=n(84864),O=n(47929),L=n(54888);function R(e){var t,n;let{item:o,comment:r,disableRestack:s}=e,l=(0,y.rI)(),c=(0,f.F)(),d=(0,E.I0)(),u=(0,N.i3)(),p=(0,_.aF)(),{requireLogin:m}=(0,P.SJ)(),h=(0,g.ib)({pathname:"/api/v1/comment/".concat(r.id,"/reaction"),method:"POST"}),v=(0,N.oC)(o);if(!o)return null;let{publication:Z,post:C}=o,k=!!(C&&Z&&!(0,B.commentsEnabledForPost)({publication:Z,post:C})),w=s||!!(C&&Z&&!(0,B.restacksEnabledForPost)({publication:Z,post:C})),T=r.reaction_count||0,x=!!r.reaction,I=()=>{null==m||m()},M=async e=>{if(e.preventDefault(),!p){I();return}let t=!x;d({type:"comment_like",payload:{commentId:r.id,isLiked:t}});try{var n,a;await h.refetch({method:t?"POST":"DELETE",json:(0,i._)({publication_id:(null==Z?void 0:Z.id)||null,reaction:"❤",tabId:c},t&&"comment_restack"===o.context.type&&{restacking_user_id:null===(a=o.context.users)||void 0===a?void 0:null===(n=a[0])||void 0===n?void 0:n.id})})}catch(e){d({type:"comment_like",payload:{commentId:r.id,isLiked:!t}}),alert((0,b.zx)(e));return}(0,S.rw)(o,l,"like",{tabId:c})};return(0,a.BX)(D,{children:[(0,a.tZ)(A,{count:T,active:x,disabled:!1,onClick:M}),(0,a.tZ)(F,{count:null!==(t=r.children_count)&&void 0!==t?t:0,disabled:k,onClick:e=>{var t,n;if(e.preventDefault(),!p){I();return}u.open({feedItem:o,parentPubId:null!==(t=r.publication_id)&&void 0!==t?t:void 0,parentPostId:null!==(n=r.post_id)&&void 0!==n?n:void 0,parentCommentId:r.id,tabId:c,surface:l}),(0,S.rw)(o,l,"comment",{tabId:c,extraEventProps:{reply_requirement:v,reply_locked:!!v}})},replyRequirement:v}),p?(0,a.tZ)(j,{pub:null!=Z?Z:void 0,post:null!=C?C:void 0,comment:r,feedItem:o,disabled:w,onOpen:e=>(0,S.rw)(o,l,"restack",{tabId:c,extraEventProps:{isRestacked:e}}),surface:l}):(0,a.tZ)(U,{count:null!==(n=r.restacks)&&void 0!==n?n:0,disabled:w,onClick:I}),(0,a.tZ)(H,{publication:null!=Z?Z:void 0,post:null!=C?C:void 0,comment:r,item:o})]})}function D(e){let{children:t}=e;return(0,a.tZ)(C.hs,{flex:"grow",justifyContent:"start",gap:8,className:L.Z.ufiContainer,children:t})}function A(e){let{count:t,className:n,onClick:i,active:o,disabled:r}=e,[l,d]=(0,s.useState)(!1),{iString:u}=(0,h.M1)();return(0,a.tZ)(X,{onClick:e=>{d(!0),null==i||i(e)},className:c()(n,L.Z.like,l&&L.Z.clickedOnce),count:t,active:o,disabled:r,"aria-label":u("like"),children:(0,a.tZ)(W,{isLiked:null!=o&&o})})}function F(e){let{count:t,className:n,onClick:i,active:o,disabled:r,replyRequirement:s}=e,{iString:l}=(0,h.M1)();return(0,a.tZ)(X,{onClick:i,className:c()(n,L.Z.comment),count:t,active:o,disabled:r,tooltip:"paid_subscriber"===s?"Only paid subscribers can reply.":"free_subscriber"===s?"Only subscribers can reply.":void 0,"aria-label":l("Comment"),children:s?(0,a.tZ)(u.Z,{strokeWidth:1.5}):(0,a.tZ)(d.Z,{})})}let U=(0,s.forwardRef)((e,t)=>{let{count:n,className:i,onClick:o,active:r,disabled:l}=e,[d,u]=(0,s.useState)(!1),{iString:p}=(0,h.M1)();return(0,a.tZ)(X,{onClick:e=>{u(!0),null==o||o(e)},className:c()(i,L.Z.restack,d&&L.Z.clickedOnce),"aria-label":p("Restack menu"),ref:t,count:n,active:r,disabled:l,children:(0,a.tZ)(J,{isRestacked:null!=r&&r})})}),z=(0,s.forwardRef)((e,t)=>{let{count:n,className:i,onClick:o,active:r,disabled:s}=e,{iString:l}=(0,h.M1)();return(0,a.tZ)(X,{className:c()(i,L.Z.share),"aria-label":l("Share menu"),onClick:o,ref:t,count:n,active:r,disabled:s,children:(0,a.tZ)(m.Z,{})})});function j(e){let{pub:t,post:n,comment:i,feedItem:o,onOpen:r,disabled:s,surface:l}=e,c=(0,f.F)(),{canRestack:d,isRestacked:u,restacks:p,menuItems:m,nuxModal:h}=(0,x.K)({pub:t,post:n,comment:i,feedItem:o,tabId:c,surface:l});return d?(0,a.BX)(a.HY,{children:[h,(0,a.tZ)(k.v2,{trigger:(0,a.tZ)(U,{count:p,"aria-label":"menu",active:u,disabled:s}),title:"Restack",onOpen:()=>null==r?void 0:r(u),children:m})]}):null}function H(e){let{publication:t,post:n,comment:i,item:o,twitterText:r}=e,s=(0,y.rI)(),l=(0,f.F)(),c=(0,_.aF)(),d=c?c.id.toString(36):void 0,u=o&&(0,I.D2)(o)&&"post"===o.type&&o.mediaClip?o.mediaClip:void 0,p=i?(0,M.Sgq)(i,{urlParams:{utm_source:O.b3.notesShareAction,r:d}}):n?(0,M.mx9)(t,n,{urlParams:{utm_source:O.b3.notesShareAction,r:d},mediaClip:u}):null,m=(0,T.wg)({variant:"menu",url:p,twitterText:r,onLinkClicked:e=>{(0,v.j)(v.FP.FEED_ITEM_SHARE_LINK_CLICKED,{type:e,shared_post_id:null==n?void 0:n.id,shared_comment_id:null==i?void 0:i.id})},comment:i});return(0,a.tZ)(k.v2,{trigger:(0,a.tZ)(z,{}),title:"Share",maxHeight:350,onOpen:()=>{o&&(0,S.rw)(o,s,"share",{tabId:l})},children:m})}let X=(0,s.forwardRef)((e,t)=>{var n,l,{className:d,active:u,disabled:p,count:m,children:h}=e,_=(0,r._)(e,["className","active","disabled","count","children"]);let y=!m||0===m,f=(0,s.useRef)(null),[v,g]=(0,s.useState)(0);(0,s.useLayoutEffect)(()=>{f.current&&g(f.current.offsetWidth)},[m]);let b=m?8:7,k=4*!m,w=null!==(l=null===(n=f.current)||void 0===n?void 0:n.offsetWidth)&&void 0!==l?l:0,S=y?32:18+6*!!v+v+2*b;return(0,a.tZ)(C.hs,{className:L.Z.buttonContainer,style:{"--button-min-width":"".concat(32,"px"),"--button-icon-width":"".concat(18,"px"),"--button-gap":"".concat(6,"px"),"--button-inner-padding":"".concat(b,"px"),"--button-outer-padding":"".concat(k,"px"),"--button-label-width":"".concat(w,"px"),"--button-final-width":"".concat(S,"px")},children:(0,a.BX)(Z.kG,(0,o._)((0,i._)({className:c()(d,L.Z.button,u&&L.Z.active,y&&L.Z.zero),resetCss:!0,ref:t,disabled:p,userSelect:"none"},_),{children:[h,(0,a.tZ)(q,{count:m,hidden:y,ref:f})]}))})});function q(e){let{count:t,hidden:n,ref:i}=e;return(0,a.tZ)(w.xv.B4,{className:c()(L.Z.count,n&&L.Z.hidden),ref:i,children:t?(0,B.numberToRoughShortString)(Math.max(t,1),{plusSignifier:""}):""})}function W(e){let{isLiked:t}=e;return(0,a.BX)("div",{className:c()(L.Z.heartWrapper,L.Z.icon,t&&L.Z.isLiked),children:[(0,a.tZ)("svg",{className:L.Z.heart,viewBox:"0 0 20 20",children:(0,a.tZ)("path",{d:"M5.00002 2.54822C8.00003 2.09722 9.58337 4.93428 10 5.87387C10.4167 4.93428 12 2.09722 15 2.54822C18 2.99923 18.75 5.66154 18.75 7.05826C18.75 9.28572 18.1249 10.9821 16.2499 13.244C14.3749 15.506 10 18.3333 10 18.3333C10 18.3333 5.62498 15.506 3.74999 13.244C1.875 10.9821 1.25 9.28572 1.25 7.05826C1.25 5.66154 2 2.99923 5.00002 2.54822Z"})}),(0,a.tZ)("div",{className:L.Z.sparks,style:"--total-sparks: ".concat(8),children:Array(8).fill(0).map((e,t)=>(0,a.tZ)("div",{className:L.Z.spark,style:"--i: ".concat(t+1,";")}))})]})}function J(e){let{isRestacked:t}=e;return(0,a.tZ)(C.hs,{className:c()(L.Z.restackWrapper,L.Z.icon,t&&L.Z.isRestacked),children:(0,a.tZ)(p.Z,{className:L.Z.restackIcon})})}},25991:function(e,t,n){n.d(t,{Et:()=>_,KF:()=>v,mn:()=>f,nH:()=>h});var i=n(7409),o=n(99282),r=n(16584);n(35543),n(95441),n(40647),n(60807),n(5952),n(42375),n(62110),n(13748);var a=n(53678),s=n(16451),l=n(71068);n(15771),n(19081);var c=n(58175),d=n(71460);n(15503);var u=n(2009);n(32189),n(43254);var p=n(98012),m=n(63651);let h=["post_like","post_restack","comment_like"];function _(e){let{user:t}=e;return(0,r.tZ)(v,{children:(0,r.BX)(g,{children:[(0,r.tZ)(c.xv,{as:"span",weight:"medium",children:t.name}),(0,r.tZ)(d.UserBadge,{tier:t.bestseller_tier,userId:t.id,tooltipOnHover:!0,size:"xs"})]})})}let y=new Intl.DateTimeFormat(void 0,{dateStyle:"medium",timeStyle:"short"});function f(e){let{timestamp:t,comment:n,post:i,publication:o}=e;return(0,r.tZ)(a.hh,{href:n?(0,m.Sgq)(n,{noBase:u.L}):i?(0,m.mx9)(o,i):void 0,color:"secondary",title:y.format((0,p.Z)(t).toDate()),style:{marginLeft:4},children:(0,r.tZ)(s.Ku,{timestamp:t})})}let v=(0,l.zo)((0,o._)((0,i._)({},c.et),{display:"flex",minWidth:0,gap:8,alignItems:"center",height:20}));(0,l.zo)((0,o._)((0,i._)({},c.et),{display:"flex",minWidth:0,gap:12,alignItems:"center"}));let g=(0,l.zo)({display:"flex",flex:"grow",minWidth:0,gap:6,alignItems:"center"})},53678:function(e,t,n){n.d(t,{hh:()=>f,xG:()=>y});var i=n(7409),o=n(99282),r=n(98848),a=n(16584),s=n(94184),l=n.n(s);n(98661);var c=n(85685);n(95441),n(60807);var d=n(93252),u=n(58175),p=n(2009),m=n(50312);n(33017),n(60308);var h=n(36186),_=n(29439);function y(e){var{user:t,utm_source:n,utm_content:s,children:l,onClick:u,ellipsis:m,disableHoverCard:_}=e,y=(0,r._)(e,["user","utm_source","utm_content","children","onClick","ellipsis","disableHoverCard"]);let v=(0,o._)((0,i._)({},t),{id:t.author_id||t.user_id||t.id,name:t.user_profile_name||t.author_name||t.name,handle:(null==t?void 0:t.handle)||(null==t?void 0:t.author_handle)});return(0,a.tZ)(c.ProfileHoverCard,{subject:v,dontStopPropagation:!0,utmSource:"feed",inline:!0,disabled:_,children:(0,a.tZ)(f,(0,o._)((0,i._)({href:(0,h.NN)(t,{noBase:p.L,utm_content:s,utm_source:n}),onClick:u,showBack:!0,ellipsis:m,className:y.className,target:(0,d.P)()?"_blank":void 0},y),{children:l}))})}function f(e){var{weight:t,color:n,decoration:s="hover-underline",ellipsis:c,native:d,className:p}=e,h=(0,r._)(e,["weight","color","decoration","ellipsis","native","className"]);let y=h.href,f=null==y?void 0:y.match(/^([a-z]+:)?\/\//),v=null!=d?d:f&&!(null==y?void 0:y.startsWith(document.location.origin));return(0,a.tZ)(u.xv,{as:"span",ellipsis:c,weight:t,color:n,decoration:s,children:v?(0,a.tZ)("a",(0,o._)((0,i._)({},h),{className:l()(p,_.Z.link)})):(0,a.tZ)(m.r,(0,o._)((0,i._)({},h),{className:l()(p,_.Z.link)}))})}},46914:function(e,t,n){n.d(t,{z:()=>o});var i=n(30396);function o(e){let t=(0,i.sO)(e);return t.current=e,(0,i.Ye)(()=>function(){for(var e=arguments.length,n=Array(e),i=0;i<e;i++)n[i]=arguments[i];return t.current(...n)},[])}},12765:function(e,t,n){n.d(t,{L:()=>o});var i=n(30396);function o(e,t,n){let[o,r]=(0,i._Y)(e,t,n),a=(0,i.sO)(o);a.current=o;let s=(0,i.Ye)(()=>async e=>{if("function"==typeof e)return await e(s,()=>a.current);r(e)},[]);return[o,s]}},26049:function(e,t,n){n.d(t,{_:()=>o});var i=n(17043);function o(e,t){let{width:n,height:o}=t,s=r.flatMap(t=>a.map(r=>"'".concat((0,i.zF)(e,n*r,{format:t,height:o?o*r:void 0,crop:"fill"}),"' ").concat(r,"x type('image/").concat(t,"')")));return"image-set(".concat(s.join(", "),")")}let r=["avif","jpeg"],a=[1,2,3]},75274:function(e,t,n){n.d(t,{T:()=>r});var i=n(98914),o=n(60308);function r(e){let{spotifySettings:t}=e;return t&&t.currently_published_on_spotify&&t.spotify_uri?[{name:"Spotify",ios:!0,android:!0,desktop:!0,icon:"/img/podcast-app-icons/spotify.svg?v=1",onClick:()=>{document.location.href=(0,o.dnM)({spotifyUri:t.spotify_uri})}},...a]:a}let a=[{name:"Choose installed player",ios:!1,android:!0,desktop:!1,icon:"/img/podcast-app-icons/generic-orange-microphone.svg?v=1",onClick:e=>{document.location.href="itpc://".concat((0,o.G1C)(e))},qrCodeUrlPrefix:"itpc://",urlTransformation:"stripProtocol"},{name:"Apple Podcasts",ios:!0,android:!1,desktop:!0,icon:"/img/podcast-app-icons/apple-podcasts.svg?v=1",onClick:e=>{document.location.href="podcast://".concat((0,o.G1C)(e))},qrCodeUrlPrefix:"podcast://",urlTransformation:"stripProtocol"},{name:"Overcast",ios:!0,android:!1,desktop:!1,icon:"/img/podcast-app-icons/overcast.svg?v=1",onClick:e=>{document.location.href="overcast://x-callback-url/add?url=".concat(encodeURIComponent(e))},qrCodeUrlPrefix:"overcast://x-callback-url/add?url=",urlTransformation:"encodeUrl"},{name:"Pocket Casts",ios:!0,android:!0,desktop:!1,icon:"/img/podcast-app-icons/pocketcasts.svg?v=1",onClick:e=>{document.location.href="pktc://subscribe/".concat((0,o.G1C)(e))},qrCodeUrlPrefix:"pktc://subscribe/",urlTransformation:"stripProtocol"},{name:"Podcast Addict",ios:!1,android:!0,desktop:!1,icon:"/img/podcast-app-icons/podcast-addict.svg?v=1",onClick:e=>{document.location.href="podcastaddict://".concat((0,o.G1C)(e))},qrCodeUrlPrefix:"podcastaddict://",urlTransformation:"stripProtocol"},{name:"Castro",ios:!0,android:!1,desktop:!1,icon:"/img/podcast-app-icons/castro.svg?v=1",onClick:e=>{(0,i.vQ)(e),document.location.href="castros://subscribe/".concat((0,o.G1C)(e))},qrCodeUrlPrefix:"castros://subscribe/",urlTransformation:"stripProtocol"},{name:"Radio Public",ios:!0,android:!0,desktop:!1,icon:"/img/podcast-app-icons/radiopublic.svg?v=1",onClick:e=>{document.location.href="https://radiopublic.com/".concat(encodeURIComponent(e))},qrCodeUrlPrefix:"https://radiopublic.com/",urlTransformation:"encodeUrl"}]},15562:function(e,t,n){n.d(t,{W:()=>r});var i=n(16584);n(98661);var o=n(6490);let r=e=>{let{isOpen:t=!1,title:n,description:r,icon:a,onClose:s,primaryButton:l,secondaryButton:c}=e;return(0,i.BX)(o.u_,{isOpen:t,onClose:s,children:[n&&(0,i.tZ)(o.xB,{title:n,description:r,showClose:!1,icon:a}),(0,i.tZ)(o.ex,{}),(0,i.tZ)(o.mz,{primaryButton:l,secondaryButton:c})]})}},88817:function(e,t,n){n.d(t,{SJ:()=>a});var i=n(6400),o=n(30396);let r=(0,i.createContext)({setChildOptions:()=>{},onboardingModalRef:{current:null},isLoading:!1,subscriptions:[],publicationUsers:[],onPageScroll:()=>void 0,setPinTitle:()=>void 0,setDrawer:()=>null,checkFocus:()=>!1,requireLogin:null});function a(){return(0,o.qp)(r)}},43681:function(e,t,n){n.d(t,{LM:()=>w,Wh:()=>P,gY:()=>E,kB:()=>N,oy:()=>S,wg:()=>x});var i=n(16584),o=n(39693),r=n.n(o),a=n(99869),s=n(77600),l=n(28596),c=n(51455),d=n(59154),u=n(79138),p=n(4473),m=n(39535),h=n(95441),_=n(93155),y=n(15771),f=n(61254),v=n(44424),g=n(97434),b=n(40949),Z=n(75419),C=n(60308),k=n(63651);let w=e=>{let{variant:t,url:n,onLinkClicked:o}=e,{iString:r}=(0,h.M1)(),a=()=>{window.open((0,k.n1t)("https://www.facebook.com/sharer/sharer.php",{u:n}),"_blank"),null==o||o("facebook")};return"icon"===t?(0,i.tZ)(y.hU,{priority:"secondary-outline",onClick:a,children:(0,i.tZ)(u.Z,{size:20})}):(0,i.tZ)(v.sN,{leading:(0,i.tZ)(u.Z,{}),onClick:a,children:r("Share to Facebook")})},S=e=>{let{variant:t,url:n,twitterText:o,onLinkClicked:r}=e,{iString:a}=(0,h.M1)(),s=()=>{window.open((0,C.LaP)({url:n,text:o||""}),"_blank"),null==r||r("twitter")};return"icon"===t?(0,i.tZ)(y.hU,{priority:"secondary-outline",onClick:s,children:(0,i.tZ)(m.Z,{size:20})}):(0,i.tZ)(v.sN,{leading:(0,i.tZ)(m.Z,{}),onClick:s,children:a("Share to X")})},E=e=>{let{variant:t,url:n,twitterText:o,onLinkClicked:r}=e,{iString:a}=(0,h.M1)(),s=()=>{window.open((0,C.xJ2)({text:o?"".concat(o,"\n").concat(n):null!=n?n:""}),"_blank"),null==r||r("bluesky")};return"icon"===t?(0,i.tZ)(y.hU,{priority:"secondary-outline",onClick:s,children:(0,i.tZ)(d.Z,{size:20})}):(0,i.tZ)(v.sN,{leading:(0,i.tZ)(d.Z,{}),onClick:s,children:a("Share to Bluesky")})},P=e=>{let{variant:t,url:n,onLinkClicked:o}=e,{iString:r}=(0,h.M1)(),s=(0,b.y)(),l=()=>{n&&(s(n),null==o||o("copy"))};return"icon"===t?(0,i.tZ)(y.hU,{priority:"secondary-outline",onClick:l,children:(0,i.tZ)(a.Z,{height:20})}):(0,i.tZ)(v.sN,{leading:(0,i.tZ)(a.Z,{}),onClick:l,children:r("Copy link")})},N=e=>{let{variant:t,url:n,onLinkClicked:o}=e,{iString:r}=(0,h.M1)(),a=(0,Z.i3)(),s=()=>{a.open({restackUrl:n||""}),null==o||o("notes")};return"icon"===t?(0,i.tZ)(y.hU,{priority:"secondary-outline",onClick:s,children:(0,i.tZ)(p.Z,{size:20})}):(0,i.tZ)(v.sN,{leading:(0,i.tZ)(p.Z,{}),onClick:s,children:r("Share to Notes")})},T=e=>{let{onLinkClicked:t,comment:n}=e,{iString:o}=(0,h.M1)(),{openModal:r,closeModal:a}=(0,_.dd)();return n?(0,i.tZ)(v.sN,{leading:(0,i.tZ)(s.Z,{}),onClick:()=>{null==t||t("embed"),r({children:(0,i.tZ)(c.I,{comment:n||void 0,onClose:a}),width:540})},children:o("Embed note")}):null},x=e=>{let{url:t,onLinkClicked:n}=e,o=w(e),a=E(e),s=S(e),l=P(e),c=N(e),d=T(e);return r()([l,(0,i.tZ)(I,{url:t,onShare:()=>{null==n||n("chat")}}),d,(0,i.tZ)(f.iz,{paddingX:8}),c,o,a,s])};function I(e){let{url:t,onShare:n}=e,{iString:o}=(0,h.M1)(),r=(0,g.B)();return(0,i.tZ)(v.sN,{leading:(0,i.tZ)(l.Z,{}),onClick:()=>{r.open({linkAttachmentUrl:t,source:"share_post"}),null==n||n()},children:o("Send as message")})}},15503:function(e,t,n){n.d(t,{Kr:()=>f,a2:()=>u,iI:()=>h,rw:()=>d,zi:()=>c});var i=n(7409),o=n(99282),r=n(41609),a=n.n(r);n(42375);var s=n(68833);let l={search:function(e,t){var n;let o=m(e,null!==(n=t.tabId)&&void 0!==n?n:null);(0,s.j)(s.FP.NOTES_SEARCH_RESULT_CLICKED,(0,i._)({module:e.type},o,t))}};function c(e,t){let{extraEventProps:n={},tabId:i,primaryItem:o}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};y("seen",e,t,{extraEventProps:n,tabId:i,primaryItem:o})}function d(e,t,n){let{extraEventProps:r={},tabId:a,primaryItem:s}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(l[t]){var c;null===(c=l[t])||void 0===c||c.call(l,e,(0,o._)((0,i._)({clicked_element:n},r),{tabId:a,primaryItem:s}))}y("clicked",e,t,{extraEventProps:(0,o._)((0,i._)({clicked_element:n},r),{tabId:a,primaryItem:s})})}function u(e,t){let{extraEventProps:n={},tabId:r,primaryItem:a}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};y("swiped",e,t,{extraEventProps:(0,o._)((0,i._)({},n),{tabId:r,primaryItem:a})})}function p(e){var t,n,i,o,r,a,s,l,c,d;let u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,{primaryItem:p}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return{item_primary_entity_key:p&&"entity_key"in p?p.entity_key:"entity_key"in e?e.entity_key:"",item_entity_key:"entity_key"in e?e.entity_key:"",item_type:e.type,item_content_user_id:"comment"in e?e.comment&&e.comment.user_id?e.comment.user_id:0:"post"in e?null!==(l=null===(n=e.post.publishedBylines)||void 0===n?void 0:null===(t=n[0])||void 0===t?void 0:t.id)&&void 0!==l?l:e.publication.author_id:0,item_context_type:"context"in e?e.context.type:"",item_context_type_bucket:"context"in e&&null!==(c=e.context.typeBucket)&&void 0!==c?c:"",item_context_timestamp:new Date("context"in e?e.context.timestamp:new Date).toISOString(),item_context_user_id:"context"in e?null===(i=e.context.users[0])||void 0===i?void 0:i.id:void 0,item_context_user_ids:"context"in e&&(null!==(d=null===(o=e.context.users)||void 0===o?void 0:o.length)&&void 0!==d?d:0)>0?e.context.users.map(e=>{let{id:t}=e;return t}):[],item_publication_id:"publication"in e?null===(r=e.publication)||void 0===r?void 0:r.id:void 0,item_post_id:null===(a=e.post)||void 0===a?void 0:a.id,item_comment_id:null===(s=e.comment)||void 0===s?void 0:s.id,item_can_reply:!("canReply"in e)||e.canReply,item_source:"frontend",item_model_rank:null,item_model_score:null,tab_id:null!=u?u:void 0,item_module_id:"id"in e?e.id:void 0,followed_user_count:0,subscribed_publication_count:0,is_following:!1,is_explicitly_subscribed:!1}}function m(e,t){let{primaryItem:n}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return"comment"===e.type||"post"===e.type||"featuredCollection"===e.type||"featuredPublication"===e.type?a()(e.trackingParameters)?p(e,t,{primaryItem:n}):e.trackingParameters:p(e,t,{primaryItem:n})}function h(e){let{primaryItem:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,o._)((0,i._)({},e),{trackingParameters:p(e,null,{primaryItem:t})})}let _=new Map([["featuredCollection","featured_collection"],["featuredPublication","featured_publication"]]);function y(e,t,n){let{extraEventProps:o={},tabId:r,primaryItem:a}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},l=m(t,null!=r?r:null,{primaryItem:a}),c=_.get(t.type);(0,s.j)("seen"===e?s.FP.FEED_ITEM_SEEN:"seen_for_duration"===e?s.FP.FEED_ITEM_SEEN_FOR_DURATION:"swiped"===e?s.FP.FEED_ITEM_SWIPED:s.FP.FEED_ITEM_CLICKED,(0,i._)({surface:n,tabId:r,module:c},l,o))}function f(e,t){let{tabId:n,noteId:i}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};(0,s.j)(s.FP.FEED_HIDDEN_ATTACHMENT_SHOWN,{attachmentId:e,reason:t,tabId:n,noteId:i})}},27744:function(e,t,n){n.d(t,{I0:()=>g,RR:()=>v,d6:()=>C,ev:()=>Z,kc:()=>k});var i=n(7409),o=n(99282),r=n(6400),a=n(30396),s=n(39693),l=n.n(s),c=n(18446),d=n.n(c),u=n(12765),p=n(7882),m=n(98914),h=n(15503),_=n(98012),y=n(33884),f=n(63651);let v=(0,r.createContext)({dispatch:()=>Promise.resolve()});function g(){return(0,a.qp)(v).dispatch}let b={isSigningIn:!1,signInNoExit:!1,pages:[],readingQueue:[],posts:new Map,publications:new Map,referringPubByPostId:{},comments:new Map,inboxItems:new Map,hiddenItems:[],publicationSettings:new Map,publicationRecommendations:new Map,feedItemStats:new Map,activeLiveStreams:[],mutedFeedItems:new Set},Z=(0,r.createContext)(b);function C(){let{initialData:e={}}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,u.L)(w,e,e=>{let{feedItem:t,readingQueue:n,initialPost:i}=e,o=b;return t&&(o=P(o,t)),n&&(o=x(o,n)),i&&(o=T(o,{posts:[i.post],publications:l()([i.publication,i.referringPub]),publicationSettings:new Map([[i.publication.id,i.publicationSettings]]),recommendationsByPubId:i.referringRecommendation?new Map([[i.referringRecommendation.recommended_publication_id,i.referringRecommendation]]):void 0})),o})}function k(){return(0,a.qp)(Z)}function w(e,t){var n,r,a,s,l,c,u,v,g,Z,C;switch(t.type){case"sign_in":return(0,o._)((0,i._)({},e),{lastDispatchType:t.type,isSigningIn:t.payload.isSigningIn,signInNoExit:null!==(n=t.payload.signInNoExit)&&void 0!==n&&n});case"page_load":{let{result:n}=t.payload;return(0,o._)((0,i._)({},E(e,n.items)),{lastDispatchType:t.type,pages:(0,p.x8)(e.pages,t)})}case"post_load":{let{post:n,publication:i}=t.payload;return T(e,{posts:[n],publications:[i]})}case"post_like":{let{postId:n,isLiked:i}=t.payload,o=e.posts.get(n);return N(e,t.type,n,(u=o,{reaction:null!=(v=i)?v:!u.reaction,reactions:{"❤":((null===(g=u.reactions)||void 0===g?void 0:g["❤"])||0)+(v?1:-1)}}))}case"post_restack":{let{postId:n,isRestacked:i}=t.payload,o=e.posts.get(n);return o?N(e,t.type,n,(Z=o,{restacked:C=i,restacks:(Z.restacks||0)+(C?1:-1)})):e}case"post_delete":{let{publication:n,post:r}=t.payload,a=new Map(e.posts);a.delete(r.id);let s=new Map([...e.comments].filter(e=>{let[t,n]=e;return n.post_id!==r.id}));return[(0,f.rcW)(r.id,{noBase:!0}),(0,f.mx9)(n,r,{noBase:!0})].includes(window.location.pathname)&&(0,m.uX)(y.Ds,{replace:!0}),(0,o._)((0,i._)({},e),{lastDispatchType:t.type,posts:a,comments:s,pages:e.pages.map(e=>(0,o._)((0,i._)({},e),{result:e.result?(0,o._)((0,i._)({},e.result),{items:e.result.items.filter(e=>{var t;return(null===(t=e.post)||void 0===t?void 0:t.id)!==r.id})}):e.result}))})}case"post_save":{let{postId:n,isSaved:i}=t.payload,o=e.posts.get(n),r=null==i?!(null==o?void 0:o.is_saved):i;return o?N(e,t.type,n,{is_saved:r}):e}case"comment_like":{let{commentId:n,isLiked:a}=t.payload,s=e.comments.get(n);if(!s)return e;return(0,o._)((0,i._)({},e),{lastDispatchType:t.type,comments:I(e.comments,n,(0,o._)((0,i._)({},s),{reaction:a?"❤":void 0,reactions:(0,o._)((0,i._)({},s.reactions),{"❤":((null===(r=s.reactions)||void 0===r?void 0:r["❤"])||0)+(a?1:-1)}),reaction_count:(s.reaction_count||0)+(a?1:-1)}))})}case"comment_restack":{let{commentId:n,isRestacked:r}=t.payload,a=e.comments.get(n);return(0,o._)((0,i._)({},e),{lastDispatchType:t.type,comments:a?I(e.comments,n,(0,o._)((0,i._)({},a),{restacked:r,restacks:(a.restacks||0)+(r?1:-1)})):e.comments})}case"comment_delete":{let{comment:n}=t.payload,r=new Map(e.posts),a=new Map([...e.comments].filter(e=>{let[t,i]=e;return i.id!==n.id&&!new RegExp("(^|.)".concat(n.id,"(.|$)")).test(i.ancestor_path)})),s=r.get(n.post_id),l=n.ancestor_path&&a.get(Number(n.ancestor_path.split(".").pop()));return l?a.set(l.id,(0,o._)((0,i._)({},l),{children_count:(l.children_count||1)-1,children:(l.children||[]).filter(e=>e.id!==n.id)})):s&&r.set(s.id,(0,o._)((0,i._)({},s),{child_comment_count:(s.child_comment_count||1)-1})),[(0,f.Sgq)(n,{noBase:!0})].includes(window.location.pathname)&&(0,m.uX)(y.Ds,{replace:!0}),(0,o._)((0,i._)({},e),{lastDispatchType:t.type,posts:r,comments:a,pages:e.pages.map(e=>(0,o._)((0,i._)({},e),{result:e.result?(0,o._)((0,i._)({},e.result),{items:e.result.items.filter(e=>{var t;return(null===(t=e.comment)||void 0===t?void 0:t.id)!==n.id&&!(e.parentComments||[]).filter(Boolean).map(e=>e.id).includes(n.id)})}):e.result}))})}case"new_post":return(0,o._)((0,i._)({},e),{lastDispatchType:t.type,publications:new Map([...e.publications].concat([[t.payload.publication.id,t.payload.publication]])),posts:new Map([...e.posts].concat([[t.payload.post.id,t.payload.post]])),pages:[{error:null,isLoading:!1,result:{items:[{type:"post",entity_key:(0,y.vy)(t.payload.post.id),publication:t.payload.publication,post:t.payload.post,context:t.payload.context||{}}]}},...e.pages]});case"new_comment":{let{comment:n}=t.payload,r=new Map(e.posts),l=r.get(n.post_id);l&&r.set(l.id,(0,o._)((0,i._)({},l),{child_comment_count:(l.child_comment_count||0)+1}));let c=new Map(e.comments);c.set(n.id,n);let d=((null===(a=n.ancestor_path)||void 0===a?void 0:a.split("."))||[]).map(Number).filter(Boolean).map(e=>c.get(e)||null),u=null!==(s=d[d.length-1])&&void 0!==s?s:null;u&&c.set(u.id,(0,o._)((0,i._)({},u),{children_count:(u.children_count||0)+1,children:[n].concat(u.children||[])}));let p=[{error:null,isLoading:!1,result:{items:[(0,h.iI)({type:"comment",entity_key:(0,y.It)(n.id),comment:n,parentComments:d,publication:null,post:null,canReply:!0,context:{type:"comment",timestamp:new Date().toISOString(),users:[],fallbackReason:"",fallbackUrl:null}})]}},...e.pages];return(0,o._)((0,i._)({},e),{lastDispatchType:t.type,posts:r,comments:c,pages:p})}case"edit_comment":{let{comment:n}=t.payload,r=new Map(e.comments);return r.set(n.id,n),(0,o._)((0,i._)({},e),{lastDispatchType:t.type,comments:r})}case"comments_load":{let{comments:n}=t.payload,r=[],a=n.slice();for(;a.length>0;){let e=a.pop();r.push(e),a.push(...e.children||[])}return(0,o._)((0,i._)({},e),{lastDispatchType:t.type,comments:new Map([...e.comments].concat(r.map(e=>[e.id,e])))})}case"item_load":{let{item:n}=t.payload;return(0,o._)((0,i._)({},P(e,n)),{lastDispatchType:t.type})}case"items_load":{let{items:n}=t.payload;return(0,o._)((0,i._)({},E(e,n)),{lastDispatchType:t.type})}case"new_feed_items":{let n=[...e.pages];if(t.payload.insertLocation){let e={error:null,isLoading:!1,result:{items:t.payload.feedItems}};"prepend"===t.payload.insertLocation?n.unshift(e):"append"===t.payload.insertLocation&&n.push(e)}return(0,o._)((0,i._)({},E(S(e,10),t.payload.feedItems)),{lastDispatchType:t.type,pages:n})}case"items_cull":{let t=null===(c=e.pages.find(e=>{var t;return null===(t=e.result)||void 0===t?void 0:t.originalCursorTimestamp}))||void 0===c?void 0:null===(l=c.result)||void 0===l?void 0:l.originalCursorTimestamp;if(t&&(0,_.Z)(t).isBefore((0,_.Z)().subtract(10,"minutes")))return b;return S(e,10)}case"inbox_load":return x(e,t.payload);case"active_live_streams_load":if(d()(e.activeLiveStreams,t.payload))return e;return(0,o._)((0,i._)({},e),{activeLiveStreams:t.payload.filter(e=>(0,_.Z)(e.liveStream.started_streaming_at).isBefore((0,_.Z)().subtract(1,"minute")))});case"inbox_item_archive":{let{contentKey:n,isArchived:r}=t.payload,a=e.inboxItems.get(n);return(0,o._)((0,i._)({},e),{inboxItems:I(e.inboxItems,n,(0,o._)((0,i._)({},a),{archived_at:r?new Date().toISOString():null}))})}case"item_hide":{let{entityKey:n}=t.payload;return(0,o._)((0,i._)({},e),{lastDispatchType:t.type,hiddenItems:[...e.hiddenItems,n]})}case"item_unhide":{let{entityKey:n}=t.payload;return(0,o._)((0,i._)({},e),{lastDispatchType:t.type,hiddenItems:e.hiddenItems.filter(e=>e!==n)})}case"item_dismiss":{let{entityKey:n}=t.payload;return(0,o._)((0,i._)({},e),{lastDispatchType:t.type,pages:e.pages.map(e=>(0,o._)((0,i._)({},e),{result:e.result?(0,o._)((0,i._)({},e.result),{items:e.result.items.filter(e=>"entity_key"in e&&e.entity_key!==n)}):e.result}))})}case"item_pause_notifications":{let{entityKey:n}=t.payload,r=new Set(e.mutedFeedItems);return r.add(n),(0,o._)((0,i._)({},e),{mutedFeedItems:r})}case"item_unpause_notifications":{let{entityKey:n}=t.payload,r=new Set(e.mutedFeedItems);return r.delete(n),(0,o._)((0,i._)({},e),{mutedFeedItems:r})}}return(0,o._)((0,i._)({},e),{lastDispatchType:t.type,pages:(0,p.x8)(e.pages,t)})}function S(e,t){let n,r=0,a=[];for(let i of e.pages){var s;let e=null===(s=i.result)||void 0===s?void 0:s.items;if(!e||i.error||i.isLoading)break;for(let t of(n=i,e))a.push(t),r++;if(r>t)break}if(!(null==n?void 0:n.result))return e;let l=(0,o._)((0,i._)({},n),{result:(0,o._)((0,i._)({},n.result),{items:a})});return(0,o._)((0,i._)({},e),{pages:[l]})}function E(e,t){let n=new Map(e.publications),r=new Map(e.posts),a=new Map(e.comments),s=new Set(e.mutedFeedItems);for(let e of t){if("publication"in e&&e.publication&&n.set(e.publication.id,e.publication),"post"in e){let{post:t}=e;t&&r.set(t.id,t),e.isMuted&&s.add(e.entity_key)}if("comment"in e){let{comment:t}=e;if(t&&(a.set(t.id,t),t.attachments))for(let e of t.attachments)"post"===e.type&&(r.set(e.post.id,e.post),n.set(e.publication.id,e.publication));e.isMuted&&s.add(e.entity_key)}if("parentComments"in e)for(let t of e.parentComments)t&&a.set(t.id,t)}return(0,o._)((0,i._)({},e),{publications:n,posts:r,comments:a,mutedFeedItems:s})}function P(e,t){var n;return(0,o._)((0,i._)({},e),{posts:t.post?I(e.posts,t.post.id,t.post):e.posts,publications:t.publication?I(e.publications,t.publication.id,t.publication):e.publications,comments:new Map([...e.comments].concat([t.comment,...null!==(n=t.parentComments)&&void 0!==n?n:[]].filter(Boolean).map(e=>[e.id,e]))),feedItemStats:t.feedItemStats&&t.feedItemStats.entity_key?I(e.feedItemStats,t.feedItemStats.entity_key,t.feedItemStats):e.feedItemStats,mutedFeedItems:new Set(t.entity_key&&t.isMuted?[t.entity_key]:void 0)})}function N(e,t,n,r){let a=new Map(e.posts),s=a.get(n);return s&&a.set(s.id,(0,i._)({},s,r)),(0,o._)((0,i._)({},e),{lastDispatchType:t,posts:a})}function T(e,t){let{posts:n,publications:r,publicationSettings:a,recommendationsByPubId:s}=t,l=new Map(e.posts);for(let e of n)l.set(e.id,(0,i._)({},l.get(e.id),e));let c=new Map(e.publications);for(let e of r)c.set(e.id,(0,i._)({},c.get(e.id),e));let d=new Map([...e.publicationSettings.entries(),...a?a.entries():[]]),u=new Map([...e.publicationRecommendations.entries(),...s?s.entries():[]]);return(0,o._)((0,i._)({},e),{posts:l,publications:c,publicationSettings:d,publicationRecommendations:u})}function x(e,t){return(0,o._)((0,i._)({},T(e,t)),{readingQueue:t.inboxItems.map(e=>e.content_key),inboxItems:new Map([...e.inboxItems].concat(t.inboxItems.map(e=>[e.content_key,e]))),referringPubByPostId:(0,i._)({},e.referringPubByPostId,t.referringPubByPostId)})}function I(e,t,n){let i=new Map(e);return i.set(t,n),i}},43254:function(e,t,n){n.d(t,{K1:()=>a}),n(16584),n(30396),n(35543);var i=n(60807);n(48980),n(65205),n(70379);var o=n(64172),r=n(67914);function a(e){let t=(0,o.Th)(),n=(0,i.aF)();if((null==n?void 0:n.id)===e)return"subscribed";let{result:a}=t;if(!a)return null;let{subscriptions:l,publicationUsers:c}=a;for(let n of c)if(["admin","contributor"].includes(n.role)&&s(e,n.publication_id,t))return"subscribed";let d=null;for(let n of l)if(s(e,n.publication_id,t)){var u;d=null!==(u=(0,r.Ps)(n.membership_state,d)?n.membership_state:d)&&void 0!==u?u:null}return d}function s(e,t,n){if(n.isLoading||!n.result)return!1;let i=n.result.publicationMap.get(t);if(i){if(i.author_id===e)return!0;for(let t of i.contributors)if(t.user_id===e)return!0}return!1}n(63651)},30343:function(e,t,n){n.d(t,{v:()=>l,r:()=>s});var i,o=n(64757),r=((i=r||{})[i.Vibrant=0]="Vibrant",i[i.DarkVibrant=1]="DarkVibrant",i[i.LightVibrant=2]="LightVibrant",i[i.Muted=3]="Muted",i[i.DarkMuted=4]="DarkMuted",i[i.LightMuted=5]="LightMuted",i);let a=Object.keys(r),s={custom:{green:"var(--color-bg-marketing-green)",orange:"var(--color-accent-fg-orange)"},basic:{primary:"var(--color-bg-secondary)"},image:{tintedImageMuted:"cover_image_tinted_muted",tintedImageVibrant:"cover_image_tinted_vibrant",fadedImage:"cover_image_faded",blurredImage:"cover_image_blurred"}};function l(e){let{coverImage:t,palette:n}=e;return o.Hv.filter(e=>e in s.basic||e in s.custom||e in s.image&&!!t||!!a.includes(e)&&!!(null==n?void 0:n[e]))}},75561:function(e,t,n){n.d(t,{CD:()=>i});function i(e,t){for(let[n,i]of Object.entries(t))null!=i&&(e[n]=i);return e}},67914:function(e,t,n){n.d(t,{B9:()=>r,Ps:()=>o});var i=n(6070);function o(e,t){if(!e)return!1;if(!t)return!0;let n=["unsubscribed","free_signup","subscribed"];return n.indexOf(e)>=n.indexOf(t)}function r(e){let{pub:t,subscriptionType:n}=e;return(0,i.uT)({pub:t})&&"comp"===n}},64757:function(e,t,n){n.d(t,{Hp:()=>a,Hv:()=>i,a_:()=>r});let i=["DarkMuted","Vibrant","green","orange","primary","blurredImage","fadedImage","tintedImageMuted","tintedImageVibrant"];var o,r=((o={}).Left="left",o.Center="center",o);let a=Object.values(r)},22838:function(e,t,n){n.d(t,{Os:()=>i.O,QP:()=>o.QP,qX:()=>o.qX});var i=n(12444),o=n(42886);n(20591),n(74699)},33884:function(e,t,n){n.d(t,{Ds:()=>l,E2:()=>m,IY:()=>w,It:()=>Z,NZ:()=>v,Oi:()=>b,QX:()=>_,Sg:()=>y,TK:()=>k,Th:()=>p,gt:()=>f,mx:()=>h,rc:()=>g,vy:()=>C,wn:()=>S});var i=n(7409),o=n(31377),r=n(22838),a=n(14773),s=n(36186);let l="/".concat("home"),c="/notes";new RegExp("".concat(l,"/(").concat(Object.values(r.qX).join("|"),")/([^\\/]+)"));let d=/^\/profile\/(\d+)-([^\/]+)\/note\/c-(\d+)(\/stats)?$/,u=/^\/@[^\/]+\/note\/c-(\d+)(\/stats)?$/;function p(e){let t=e.match(d);if(t){let e=t[3],n=t[2];if(e&&n)return{type:"comment",id:Number(e),author:{id:Number(t[1]),name:n},isStats:!!t[4]}}let n=e.match(u);return n?{type:"comment",id:Number(n[1]),isStats:!!n[2]}:null}function m(){var e;let{baseUrl:t,urlParams:n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=l,o=null!=t?t:(0,a.ZJ)();return"undefined"!=typeof window&&(null===(e=window.location.href)||void 0===e?void 0:e.startsWith(o))||(i=o+i),(0,a.n1)(i,n)}function h(e,t){var n,i,r;let{noBase:l,urlParams:c,mediaClip:d}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},u=(null===(n=t.publishedBylines)||void 0===n?void 0:n[0])?null===(i=t.publishedBylines)||void 0===i?void 0:i[0]:e?(0,o.getPostAuthor)(e,t):{id:0,name:"someone"},p=d?(r=d.id,"m-".concat(r)):null;return(0,a.n1)("".concat((0,s.NN)(u,{noBase:l}),"/note/").concat(null!=p?p:C(t.id)),c)}function _(e,t){let{isPreview:n=!1}=t;return"".concat((0,a.ZJ)(),"/embed/c/").concat(e.id,"?origin=").concat(window.location.origin).concat(n?"&isPreview=true":"")}function y(e){let{noBase:t,baseUrl:n,urlParams:i,noHandle:r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.user_id?(0,a.n1)("".concat((0,s.NN)((0,o.getCommentAuthor)(e),{baseUrl:n,noBase:t,noHandle:r}),"/note/").concat(Z(e.id)),i):m({baseUrl:n})}function f(e){let{noBase:t,baseUrl:n,urlParams:i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=t?"":null!=n?n:(0,a.ZJ)();return(0,a.n1)("".concat(o,"/note/").concat(e),i)}function v(e){let{noBase:t,urlParams:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=t?"":(0,a.SV)();return(0,a.n1)("".concat(i,"/note/").concat(Z(e)),n)}function g(e){let{noBase:t,urlParams:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=t?"":(0,a.SV)();return(0,a.n1)("".concat(i).concat(l,"/post/").concat(C(e)),n)}function b(e,t){return(0,a.Q2)("/note/".concat(C(e),"/restacks"),t)}function Z(e){return"c-".concat(e)}function C(e){return"p-".concat(e)}function k(e){return(0,a.n1)(m(),(0,i._)({action:"compose"},e))}function w(e){let{noBase:t,isSmall:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=t?"":(0,a.SV)();return"".concat(i,"/note/").concat(Z(e),"/preview.jpeg?size=").concat(n?"sm":"md")}function S(e){let{noBase:t,baseUrl:n,urlParams:i,noHandle:r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.user_id?(0,a.n1)("".concat((0,s.NN)((0,o.getCommentAuthor)(e),{baseUrl:n,noBase:t,noHandle:r}),"/note/").concat(Z(e.id),"/stats"),i):m({baseUrl:n})}new RegExp("".concat(l,"/(short|post)/p-(\\d+)")),new RegExp("^".concat(c,"(/?)")),new RegExp("^".concat(c,"/comment/(d+)$"))},70408:function(e,t,n){n.d(t,{I4:()=>s,SM:()=>r,ln:()=>a,zU:()=>l});var i=n(14773),o=n(63651);function r(e,t){let n=a(e,t);return n||l}function a(e){let{preferAuthorPhoto:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t&&(null==e?void 0:e.author_photo_url)&&(0,o.zF4)(e.author_photo_url)?(0,o.zF4)(e.author_photo_url):(null==e?void 0:e.photo_url)&&(0,o.zF4)(e.photo_url)?(0,o.zF4)(e.photo_url):(null==e?void 0:e.id)!=null?s(e.id):null}function s(e){return"".concat((0,i.ZJ)(),"/img/avatars/").concat(["purple","yellow","orange","green","black"][e%5],".png")}let l="".concat((0,i.ZJ)(),"/img/avatars/default-light.png");(0,i.ZJ)()},93370:function(e,t,n){function i(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e<0)return"0:00";let n=Math.floor(e),i=Math.floor(n/60),o=n%60;if(t){let t=Math.round((e-n)*10);return"".concat(i,":").concat(String(o).padStart(2,"0"),".").concat(t)}return"".concat(i,":").concat(String(o).padStart(2,"0"))}n.d(t,{DL:()=>i,Jk:()=>r,ZD:()=>a,fI:()=>o});let o=e=>/^[0-9.:]*$/.test(e),r=e=>/^(?:(?:[0-9]{1,3}):)?(?:[0-5][0-9]|[0-9]{1,2})(?:\.[0-9]{1,3})?$/.test(e),a=e=>{let[t="",n=""]=e.split("."),i=t.split(":").reverse().map(e=>parseInt(e)),o=i[0]||0,r=i[1]||0;return 3600*(i[2]||0)+60*r+o+parseInt(n.padEnd(3,"0"))/1e3}}}]);