"use strict";(self.webpackChunksubstack=self.webpackChunksubstack||[]).push([["5947"],{7703:function(e,t,i){i.d(t,{Z:()=>r});var a=i(16584),n=i(13639),s=i(15702),o=i(25682);let r=e=>{let{audience:t,className:i,size:r=16,isStatic:l,thin:d}=e;return"only_paid"===t?d?(0,a.tZ)(o.Z,{className:i,height:r,isStatic:l}):(0,a.tZ)(n.Z,{className:i,size:r}):"founding"===t?(0,a.tZ)(s.Z,{className:i,height:r,isStatic:l,strokeWidth:1}):null}},67203:function(e,t,i){i.d(t,{O0:()=>V,YY:()=>z,sp:()=>j});var a=i(7409),n=i(99282),s=i(16584),o=i(30396),r=i(94184),l=i.n(r),d=i(31131),h=i(99869),p=i(77600),c=i(40423),u=i(28596),m=i(98661),y=i(60826),v=i(61649),_=i(51455),w=i(59154),g=i(79138),f=i(37632),k=i(4473),b=i(39535),P=i(94442),E=i(75697),Z=i(57391),C=i(95441),L=i(93155),T=i(68833),S=i(59176),U=i(98914),I=i(15771),D=i(82402),M=i(19081),N=i(44424),R=i(58175),A=i(51776),B=i(70379),H=i(97434),x=i(37759),F=i(93370),O=i(47929),K=i(8108);let z=e=>{let{initialTime:t,onChange:i,maxTime:a}=e,{iString:n}=(0,C.M1)(),[r,l]=(0,o.eJ)(!0),[d,h]=(0,o.eJ)(!0),[p,c]=(0,o.eJ)((0,F.DL)(null!=t?t:0)),u=e=>{let t=(0,F.Jk)(e),n=(0,F.ZD)(e);t&&(!a||n<=a)?(i((0,F.ZD)(e)),h(!0)):(i(null),h(!1)),c(e)};return(0,s.BX)(M.gq,{gap:12,alignItems:"center",paddingX:8,paddingY:4,children:[(0,s.tZ)(N.Mz,{children:(0,s.tZ)(D.X,{size:"sm",checked:r,onChange:()=>l(!r)})}),(0,s.tZ)(R.xv.B4,{weight:"medium",color:"primary",children:n("Start at")}),(0,s.tZ)(A.oi,{className:K.Z.textInput,value:p,error:!d,onChange:e=>u(e.currentTarget.value),placeholder:"0:00"})]})};function j(e){var t,i,r,u,D;let R,{post:A,user:H,pub:x,trigger:F,onChange:j,position:X,showClipping:W,disableClipping:Y,initialShareTimestamp:J}=e,{iString:G}=(0,C.M1)(),{onStartClipping:Q}=(0,v.Sr)(),[q,$]=(0,o.eJ)(null!=J?J:null);(0,m.useEffect)(()=>{J&&$(J)},[J]);let ee=q?{timestamp:q.toFixed(1)}:{},{getExperimentVariant:et,exposeExperiment:ei}=(0,Z.jc)(),ea=(0,E.O1)(null,{post:A,pub:x,user:H,useCustomDomainOverOpen:!0,params:(0,a._)({},ee,H&&{showWelcomeOnShare:"treatment"===et("show_welcome_screen_on_post_share")})}),en=(0,E.B8)({post:A,pub:x}),es={title:en,url:ea},eo=(0,B.pm)(),{openModal:er,closeModal:el}=(0,L.dd)(),ed=(0,U.K1)()&&navigator.share&&navigator.canShare&&navigator.canShare(es),[eh,ep]=(0,o.eJ)(ed),ec=async()=>{if((0,T.j)(T.FP.POST_SHARE_BUTTON_CLICKED,{position:X,post_id:A.id}),ed&&eh)try{var e;await navigator.share(es),ei("show_welcome_screen_on_post_share"),(0,T.j)(T.FP.NATIVE_SHARE_SUCCESS,{medium:"web",post_id:null!==(e=A.id)&&void 0!==e?e:null,utm_campaign:O.VX.default}),(0,S.ex)("".concat(x.subdomain," shared"),!0);return}catch(e){if(!(e instanceof Error)||"AbortError"===e.name)return;ep(!1),(0,T.j)(T.FP.NATIVE_SHARE_FAILED,{errorName:e.name,errorMessage:e.message})}};if(void 0!==F.type)R=F;else{if(void 0!==(D=F).style&&void 0!==D.labelStyle){let e;e=A.share_url_override?A.share_url_override:F.isStatic?A?y.W.SHARE_URL:y.W.SHARE_PUB_URL:"javascript:void(0)";let t="none"===F.labelStyle;R=(0,s.tZ)(P.Ng,{style:F.style,icon:t?(0,s.tZ)(d.Z,{className:"icon",height:(0,P.Su)(F.style),strokeWidth:P.PA,width:(0,P.Su)(F.style)}):null,href:e,noLabel:"none"===F.labelStyle,className:l()(!t&&"no-icon"),children:"cta"===F.labelStyle&&G("Share")})}}return(0,s.tZ)(s.HY,{children:(0,s.BX)(N.v2,{trigger:R,onOpen:ec,disableMenu:eh,layerOptions:{placement:"pub-preview"===X?"bottom-start":"bottom-end",preferX:"pub-preview"===X?"right":"left"},className:K.Z.dropdownMenu,maxHeight:"fit-content",ariaLabel:G("View share options"),children:[(0,s.tZ)(N.sN,{leading:(0,s.tZ)(h.Z,{}),onClick:()=>{ei("show_welcome_screen_on_post_share"),(0,E.Ui)({shareUrl:ea,pub:x,post:A,utm_campaign:X,skipToast:!0,trackParams:ee}),eo.popToast(e=>(0,s.tZ)(B.FN,(0,n._)((0,a._)({},e),{text:G("Copied link to clipboard")}))),null==j||j()},children:G("Copy link")}),H&&(0,s.tZ)(V,{url:ea,onShare:()=>{(0,T.j)(T.FP.SHARE_LINK_CLICKED,{name:"direct_message",post_id:A.id,source:X}),null==j||j()}}),(0,s.tZ)(N.sN,{leading:(0,s.tZ)(p.Z,{}),onClick:()=>{er({children:(0,s.tZ)(_.I,{post:A,pub:x,onClose:el}),width:540})},children:G("Embed")}),(0,s.BX)(N.xw,{children:[(0,s.tZ)(N.sN,{leading:(0,s.tZ)(k.Z,{}),onClick:()=>{ei("show_welcome_screen_on_post_share"),(0,E.BZ)({shareUrl:ea,pub:x,post:A,utm_campaign:X,trackParams:ee}),null==j||j()},children:G("Share to Notes")}),(0,s.tZ)(N.sN,{leading:(0,s.tZ)(g.Z,{}),onClick:()=>{ei("show_welcome_screen_on_post_share"),(0,E.Po)({shareUrl:ea,pub:x,post:A,utm_campaign:X,trackParams:ee}),null==j||j()},children:G("Share to Facebook")}),(0,s.tZ)(N.sN,{leading:(0,s.tZ)(f.Z,{}),onClick:()=>{ei("show_welcome_screen_on_post_share"),(0,E.lc)({shareUrl:ea,pub:x,post:A,utm_campaign:X,trackParams:ee}),null==j||j()},children:G("Share to Linkedin")}),(0,s.tZ)(N.sN,{leading:(0,s.tZ)(w.Z,{}),onClick:()=>{ei("show_welcome_screen_on_post_share"),(0,E.bI)({shareUrl:ea,shareName:en,pub:x,post:A,utm_campaign:X,trackParams:ee}),null==j||j()},children:G("Share to Bluesky")}),(0,s.tZ)(N.sN,{leading:(0,s.tZ)(b.Z,{}),onClick:()=>{ei("show_welcome_screen_on_post_share"),(0,E.Wn)({shareUrl:ea,shareName:en,pub:x,post:A,utm_campaign:X,trackParams:ee}),null==j||j()},children:G("Share to X")})]}),A.videoUpload&&(0,s.tZ)(N.xw,{children:(0,s.tZ)(z,{initialTime:null!=J?J:0,onChange:$,maxTime:null!==(u=null!==(r=null===(t=A.videoUpload)||void 0===t?void 0:t.duration)&&void 0!==r?r:null===(i=A.podcastUpload)||void 0===i?void 0:i.duration)&&void 0!==u?u:null})}),W&&(0,s.tZ)(N.xw,{children:(0,s.tZ)(M.tu,{paddingX:8,paddingTop:4,paddingBottom:8,children:(0,s.tZ)(I.zx,{leading:(0,s.tZ)(c.Z,{size:16}),disabled:Y,priority:"primary",onClick:()=>{(0,T.j)(T.FP.MEDIA_CLIP_BUTTON_CLICKED,{button:"create",source:"post share dropdown"}),(0,T.j)(T.FP.VIDEO_CLIP_BUTTON_CLICKED,{post_id:A.id,source:X,type:A.type}),Q({source:"post-share-dropdown",title:null}),null==j||j()},children:G("Create clip")})})})]})})}function V(e){let{url:t,onShare:i}=e,{iString:a}=(0,C.M1)(),n=(0,H.B)();return(0,s.tZ)(N.sN,{leading:(0,s.tZ)(u.Z,{}),onClick:()=>{n.open({linkAttachmentUrl:t,source:"share_post"}),null==i||i()},onMouseEnter:x.R,children:a("Send as message")})}},50486:function(e,t,i){i.d(t,{p:()=>r});var a=i(16584),n=i(94184),s=i.n(n),o=i(24189);let r=e=>{let{name:t,label:i,info:n,checked:r,disabled:l,onChange:d,isRow:h=!0,className:p}=e,c=(0,a.tZ)(a.HY,{children:(0,a.tZ)("span",{className:s()("big-checkbox",{checked:r,disabled:l}),onClick:()=>!l&&(null==d?void 0:d(!r)),onKeyDown:e=>{" "===e.key&&(null==d||d(!r))},role:"checkbox","aria-checked":r,"aria-label":i||t,tabIndex:0,children:r&&(0,a.tZ)(o.Z,{fill:"#ffffff"})})});return(0,a.BX)("label",{className:s()("big-checkbox-input",p,{"big-checkbox-input-row":h}),children:[!h&&c,(0,a.BX)("div",{onClick:()=>{(i||n)&&(l||null==d||d(!r))},children:[i,n&&(0,a.tZ)("div",{className:"info",children:n})]}),h&&c,(0,a.tZ)("input",{type:"hidden",name:t,"data-testid":t,value:String(r)})]})}},46990:function(e,t,i){i.d(t,{Z:()=>r});var a=i(7409),n=i(99282),s=i(16584),o=i(64515);let r=e=>(0,s.BX)(o.l,(0,n._)((0,a._)({},e),{name:"FacebookIconCircle",svgParams:{height:24,width:24},children:[(0,s.tZ)("circle",{cx:"12",cy:"12",r:"11.75",fill:"white",stroke:"none"}),(0,s.tZ)("path",{d:"M12 0C5.37098 0 0 5.37089 0 11.9975C0 17.9844 4.38331 22.9414 10.1117 23.8491L10.1164 15.473H7.04998V12.0021H10.1164C10.1164 12.0021 10.1023 10.0269 10.1164 9.14743C10.1305 8.26797 10.3045 7.42142 10.7607 6.65008C11.4615 5.4555 12.5526 4.87237 13.893 4.70775C14.9935 4.57135 16.08 4.72183 17.1664 4.87237C17.2416 4.88176 17.2792 4.89115 17.3545 4.90529C17.3545 4.90529 17.3592 5.03225 17.3545 5.11222C17.3498 5.94933 17.3545 7.86819 17.3545 7.86819C16.8324 7.8588 15.9671 7.80706 15.3933 7.89641C14.4433 8.04221 13.8977 8.64891 13.8789 9.6036C13.8601 10.3467 13.8695 12.0021 13.8695 12.0021H17.2134L16.6726 15.473H13.8742V23.8491C19.612 22.9508 24 17.9844 24 11.9975C23.9953 5.37089 18.6243 0 11.9977 0Z",fill:"#1877f2",stroke:"none"})]}))},27543:function(e,t,i){i.d(t,{Z:()=>r});var a=i(7409),n=i(99282),s=i(16584),o=i(64515);let r=e=>(0,s.tZ)(o.l,(0,n._)((0,a._)({},e),{name:"LinkedInShareIcon",svgParams:{height:24,width:24,stroke:"none",viewBox:"0 0 72 72"},children:(0,s.BX)("g",{fill:"none","fill-rule":"evenodd",stroke:"none",children:[(0,s.tZ)("path",{d:"M36,72 L36,72 C55.882251,72 72,55.882251 72,36 L72,36 C72,16.117749 55.882251,-3.65231026e-15 36,0 L36,0 C16.117749,3.65231026e-15 -2.4348735e-15,16.117749 0,36 L0,36 C2.4348735e-15,55.882251 16.117749,72 36,72 Z",fill:"#007EBB"}),(0,s.tZ)("path",{d:"M59,57 L49.959375,57 L49.959375,41.6017895 C49.959375,37.3800228 48.3552083,35.0207581 45.0136719,35.0207581 C41.3785156,35.0207581 39.4792969,37.4759395 39.4792969,41.6017895 L39.4792969,57 L30.7666667,57 L30.7666667,27.6666667 L39.4792969,27.6666667 L39.4792969,31.6178624 C39.4792969,31.6178624 42.0989583,26.7704897 48.3236979,26.7704897 C54.5455729,26.7704897 59,30.5699366 59,38.4279486 L59,57 Z M20.372526,23.8257036 C17.4048177,23.8257036 15,21.4020172 15,18.4128518 C15,15.4236864 17.4048177,13 20.372526,13 C23.3402344,13 25.7436198,15.4236864 25.7436198,18.4128518 C25.7436198,21.4020172 23.3402344,23.8257036 20.372526,23.8257036 Z M15.8736979,57 L24.958724,57 L24.958724,27.6666667 L15.8736979,27.6666667 L15.8736979,57 Z",fill:"#FFF",stroke:"none"})]})}))},76157:function(e,t,i){i.d(t,{Z:()=>l});var a=i(7409),n=i(99282),s=i(16584),o=i(4675),r=i(64515);let l=e=>(0,s.tZ)(r.l,(0,n._)((0,a._)({},e),{name:"LucideArrowLeftRight",svgParams:{height:24,width:24,fill:"#000000",strokeWidth:0},children:(0,s.tZ)(o.Z,{height:24,stroke:e.stroke,fill:e.fill,strokeWidth:e.strokeWidth})}))},75697:function(e,t,i){i.d(t,{B8:()=>T,BZ:()=>C,I:()=>v,O1:()=>S,Po:()=>L,Ui:()=>b,Uo:()=>E,Vn:()=>k,WZ:()=>Z,Wn:()=>_,b6:()=>f,bI:()=>P,lc:()=>w,sn:()=>g});var a=i(7409),n=i(99282),s=i(16584),o=i(98661),r=i(95441),l=i(68833),d=i(59176),h=i(98914),p=i(70379),c=i(60308),u=i(33884),m=i(84864),y=i(47929);function v(e,t,i){let{shareUrl:s,post:o,pub:r,selectionId:h,utm_campaign:p,utm_medium:c,event:u=l.FP.SHARE_LINK_CLICKED,trackParams:m={}}=i;(0,l.j)(u,(0,a._)((0,n._)((0,a._)({name:e,post_id:o?o.id:null},h?{selection_id:h}:{}),{source:p,utm_medium:c}),m));let y=t(s);y&&"string"==typeof y&&(y.startsWith("http")?window.open(y,"_blank"):document.location.href=y),(0,d.ex)("".concat(null==r?void 0:r.subdomain," shared"),!0)}function _(e){let{pub:t,post:i,sharingSelfPub:a,shareName:n}=e,s=(null==t?void 0:t.twitter_screen_name)||t&&m.twitterScreenNames[t.subdomain],o=n;t&&a?o="I just started a Substack! You can subscribe to it here":(t&&!i&&(o="Subscribe to ".concat(o)),s&&(!i||t&&(!i.publishedBylines.length||i.publishedBylines.some(e=>e.id===t.author_id)))&&(o+=", by @".concat(s))),v("twitter",e=>(0,c.LaP)({url:e,text:o}),e)}function w(e){v("linkedin",e=>(0,c.n1t)("https://www.linkedin.com/sharing/share-offsite/",{url:e}),e)}function g(e){v("reddit",t=>(0,c.n1t)("https://www.reddit.com/submit/",{url:t,title:e.shareName}),e)}function f(e){v("hackernews",t=>(0,c.n1t)("https://news.ycombinator.com/submitlink",{url:t,title:e.shareName}),e)}function k(e){v("pinterest",t=>(0,c.n1t)("https://www.pinterest.com/pin/create/button",{u:t,description:e.shareName}),e)}function b(e){v("copy",e=>((0,h.vQ)(e),!1),e)}function P(e){v("bluesky",t=>(0,c.xJ2)({text:"".concat(e.shareName,"\n").concat(t)}),e)}function E(){let e=(0,p.pm)(),{iString:t}=(0,r.M1)(),[i,l]=(0,o.useState)(!1);return{handleCopyLink:(0,o.useCallback)(i=>{b(i),e.popToast(e=>(0,s.tZ)(p.FN,(0,n._)((0,a._)({},e),{text:t("Copied link to clipboard")}))),l(!0),setTimeout(()=>l(!1),3e3)},[t,e]),justCopied:i}}function Z(e){v("email",t=>(0,c.n1t)("mailto:",{subject:e.shareName,body:t}),e)}function C(e){v("notes",e=>(0,c.n1t)((0,u.TK)({message:e})),e)}function L(e){v("facebook",e=>(0,c.n1t)("https://www.facebook.com/sharer/sharer.php",{u:e}),e)}function T(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{post:t,pub:i,profile:a}=e;return t?t.title:i?i.name:a?"".concat(a.name," on Substack"):document.title}function S(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{pub:i,post:n,clip:s,comments:o,commentId:r,selectionId:l,profile:d,user:h,utm_campaign:p,medium:u,referral_token:v,useCustomDomainOverOpen:_,params:w}=t,g=(0,a._)({r:(null==h?void 0:h.id)?(0,m.userReferralKey)(h):v,selection:l,utm_campaign:p||(n?"post":d?"profile":i?"pub":s?"clip":"unknown"),utm_medium:u||y.lP.web,utm_source:e},{comments:null!=o&&!!o.length||void 0,commentId:r},s?{clipId:s.id}:{},w);return(null==i?void 0:i.subdomain)&&(null==n?void 0:n.slug)&&!s?(0,c.K8_)(i.subdomain,n.slug,{params:g,hostOverride:_&&i.custom_domain?(0,c.SVA)(i):null}):(0,c.n1t)("".concat(n?(0,c.uRy)(i,n,{comments:!!(null==o?void 0:o.length),commentId:r,clipId:null==s?void 0:s.id}):i?"".concat(i.base_url,"/"):"undefined"!=typeof window?window.location.href.split("?")[0]:""),g)}},12281:function(e,t,i){i.d(t,{L:()=>C,Z:()=>Z});var a=i(27412),n=i(7409),s=i(99282),o=i(16584),r=i(6400),l=i(94184),d=i.n(l),h=i(55877),p=i(1055),c=i(30372),u=i(68833),m=i(49762),y=i(59176),v=i(98914),_=i(71068),w=i(15771),g=i(18618),f=i(60308),k=i(69332),b=i(84864),P=i(67312);let E={hls:"application/x-mpegURL",mp4:"video/mp4"};class Z extends r.Component{componentDidMount(){this._initHlsjs(),null===v.sz||void 0===v.sz||v.sz.on("play",this.onGlobalPlay),"undefined"!=typeof window&&(document.addEventListener("keydown",this.onGlobalKeyDown,!1),window.addEventListener("beforeunload",this.onBeforeUnload,!1)),this.player&&(this.player.volume=1,this.player.addEventListener("loadedmetadata",this.onLoadedMetadata),this.player.addEventListener("loadeddata",this.onLoadedData),this.player.addEventListener("canplay",this.onCanPlay),this.player.addEventListener("play",this.onPlay),this.player.addEventListener("pause",this.onPause),this.player.addEventListener("ended",this.onEnded),this.player.addEventListener("timeupdate",this.onTimeUpdate),this.player.addEventListener("waiting",this.onWaiting),this.player.addEventListener("playing",this.onPlaying),this.player.addEventListener("contextmenu",this.onContextMenu),this.player.addEventListener("click",this.onUserInteraction),this.player.addEventListener("mouseover",this.onUserInteraction),this.player.addEventListener("mousedown",this.onUserInteraction),this.player.addEventListener("touchstart",this.onUserInteraction),this.player.addEventListener("seeked",this.onSeeked)),this.onTimeUpdate(),window&&window._preloads.mux_env_key&&i.e("5590").then(i.t.bind(i,54125,23)).then(e=>{let t=e.default||e;t.monitor(this.player,{Hls:this.hlsModule,hlsjs:this.hls,debug:!1,data:{env_key:window._preloads.mux_env_key,player_name:"substack",player_init_time:t.utils.now()}})})}componentWillUnmount(){this.setPlaybackRestoreLocation(),this.lastTimeUpdate=null,null===v.sz||void 0===v.sz||v.sz.off("play",this.onGlobalPlay),"undefined"!=typeof window&&(document.removeEventListener("keydown",this.onGlobalKeyDown,!1),window.removeEventListener("beforeunload",this.onBeforeUnload,!1)),this.player&&(this.player.removeEventListener("loadedmetadata",this.onLoadedMetadata),this.player.removeEventListener("loadeddata",this.onLoadedData),this.player.removeEventListener("canplay",this.onCanPlay),this.player.removeEventListener("play",this.onPlay),this.player.removeEventListener("pause",this.onPause),this.player.removeEventListener("ended",this.onEnded),this.player.removeEventListener("timeupdate",this.onTimeUpdate),this.player.removeEventListener("waiting",this.onWaiting),this.player.removeEventListener("playing",this.onPlaying),this.player.removeEventListener("contextmenu",this.onContextMenu),this.player.removeEventListener("click",this.onUserInteraction),this.player.removeEventListener("mouseover",this.onUserInteraction),this.player.removeEventListener("mousedown",this.onUserInteraction),this.player.removeEventListener("touchstart",this.onUserInteraction)),this.onVideoReachEnd({resetTime:!1,triggerCallback:!1,track:!1}),null!=this.hls&&this.hls.destroy()}componentDidUpdate(e,t){var i,a,s;if((this.props.noPreview!==e.noPreview||this.props.noControls!==e.noControls||this.props.noKeyboardShortcuts!==e.noKeyboardShortcuts||this.props.mediaUpload.id!==e.mediaUpload.id)&&(this._initHlsjs(),this.resetDurationTracking()),!this.state.playing&&"number"==typeof this.state.waiting&&"number"!=typeof t.waiting){let{useHLSJS:e,browserCanPlayHLS:t,HLSerrored:i}=this.state;this.track(u.FP.VIDEO_BUFFERING_STARTED,{use_hlsjs:e,browser_can_play_hls:t,hls_errored:i})}if(!this.state.playing||t.playing||this.state.waiting||"number"!=typeof t.waiting||this.track(u.FP.VIDEO_BUFFERING_COMPLETED,{buffering_duration:Date.now()-t.waiting}),this.state.playing&&!(null===(i=this.player)||void 0===i?void 0:i.ended)&&Math.floor(this.state.currentTime)!==Math.floor(t.currentTime)&&Math.floor(this.state.currentTime)%5==0&&(this.trackMedia(u.FP.MEDIA_PLAYBACK_CONTINUED),this.props.mediaUpload.post_id&&this.state.duration&&(!this.props.surface||"post"===this.props.surface)&&(!this.props.videoType||"post"===this.props.videoType)&&!this.props.isClip)){let e=Math.min(Math.max(0,this.state.currentTime/this.state.duration),1);(0,c.UO)(this.props.mediaUpload.post_id,"video",e)}if(!this.state.playing&&t.playing&&(null===(a=this.player)||void 0===a?void 0:a.ended)&&this.trackMedia(u.FP.MEDIA_PLAYBACK_COMPLETED),this.props.mediaUpload.id&&(0,m.default)("use_preloaded_player_sources")&&(this.props.mediaUpload.id!==e.mediaUpload.id||!(null===(s=Object.keys(this.state.sources))||void 0===s?void 0:s.length))){let e=async e=>fetch((0,f.rhs)("/api/v1/video/upload/".concat(this.props.mediaUpload.id,"/src.json"),{type:e})).then(e=>e.json()).then(t=>({[e]:t.src}));Promise.all(["hls"].map(t=>e(t))).then(e=>{let t=e.reduce((e,t)=>(0,n._)({},e,t),{});this.setState({sources:t})})}}getPlaybackLocationKey(){return"".concat("video:playback_location:").concat(this.props.mediaUpload.id)}getPlaybackRestoreLocation(){if(this.playbackEnabled()&&this.props.restorePlaybackLocation&&this.props.mediaUpload.duration&&this.props.mediaUpload.duration>240){let e=(0,y.mM)(this.getPlaybackLocationKey());if((null==e?void 0:e.currentTime)>5&&null!==this.props.duration&&void 0!==this.props.duration&&this.props.duration-e.currentTime>60){let t=3*(Date.now()-e.watchedAt>60),i=Math.max(0,e.currentTime-t);if(i)return i}}return null}setPlaybackRestoreLocation(){var e;this.playbackEnabled()&&(null===(e=this.player)||void 0===e?void 0:e.currentTime)&&(0,y.ex)(this.getPlaybackLocationKey(),{currentTime:this.player.currentTime,watchedAt:Date.now()})}onPreviewClick(e){var t,i;this.props.stopPropagation&&(e.preventDefault(),e.stopPropagation()),!(this.state.previewHidden||this.href())&&this.playbackEnabled()&&(this.state.attemptingToPlay?(this.lastTimeUpdate=null,this.setState({attemptingToPlay:!1,autoPlay:!1}),null===(t=this.player)||void 0===t||t.pause(),this.previewHiddingTimeout&&clearTimeout(this.previewHiddingTimeout)):(this.setState({attemptingToPlay:!0}),null===(i=this.player)||void 0===i||i.play(),this.previewHiddingTimeout=window.setTimeout(()=>this.setState({previewHidden:!0}),3e3)))}track(e){var t,i,a,n;let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=this.props.communityPostEmbedPostId||this.props.mediaUpload.post_id,r=this.props.mediaUpload.user_id;(0,u.j)(e,Object.assign({post_id:o,video_user_id:r,community_post_id:this.props.communityPostId,media_upload_id:this.props.mediaUpload.id,live_stream_id:this.props.liveStreamId,current_time:this.state.currentTime?Math.floor(this.state.currentTime):0,duration:this.state.duration?Math.floor(this.state.duration):0,is_clip:null!==(i=this.props.isClip)&&void 0!==i&&i,surface:this.props.surface,is_preview:null!==(a=this.props.usePreview)&&void 0!==a&&a,muted:null!==(n=null===(t=this.player)||void 0===t?void 0:t.muted)&&void 0!==n&&n,video_type:this.props.videoType,display:(0,v.rm)()?"fullscreen":document.pictureInPictureElement?"pip":"inline"},s))}trackMedia(e){var t,i,a,o,r,l,d,h;let p,c,m=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{mediaUpload:y,videoType:_,communityPostId:w,surface:g,entityKey:f,entityType:k,primaryEntityKey:b,primaryEntityType:P,contentType:E,feedItemTrackingParameters:Z}=this.props,C=null!=E?E:_?null!==(a=({communityCommentReply:"communityComment","video-embed":"embed"})[_])&&void 0!==a?a:_:"unknown";f?(p=f,c=k):w?(p=w,c="community_post"):y.post_id?(p=String(y.post_id),c="post"):(p=f,c=k);let L=Array.from(null!==(o=null===(t=this.player)||void 0===t?void 0:t.textTracks)&&void 0!==o?o:[]),T=L.length>0,S=this.isShowingCaptionsElsewhere||L.some(e=>["subtitles","captions"].includes(e.kind)&&"showing"===e.mode);(0,u.j)(e,(0,n._)((0,s._)((0,n._)({},Z),{media_type:"video",video_upload_id:y.id,src_video_upload_id:y.src_media_upload_id,content_type:C,primary_entity_key:String(null!=b?b:p),primary_entity_type:null!=P?P:c,entity_key:String(p),entity_type:c,publication_id:y.publication_id,surface:g,display:(0,v.rm)()?"fullscreen":document.pictureInPictureElement?"pip":"inline",muted:null!==(r=null===(i=this.player)||void 0===i?void 0:i.muted)&&void 0!==r&&r,captions_enabled:T?S:null,autoplay:this.state.autoPlay&&!this.state.failedAutoplay,is_preview:null!==(l=this.props.usePreview)&&void 0!==l&&l,current_time:Math.floor(null!==(d=this.state.currentTime)&&void 0!==d?d:0),duration:Math.floor(null!==(h=this.state.duration)&&void 0!==h?h:0),duration_played:Math.floor(this.state.durationPlayed),duration_played_id:this.state.durationPlayedId}),m))}render(e,t){let{height:i,width:a}=(0,b.videoPlayerDimensions)(e.mediaUpload,{isStatic:!1}),n=d()("video-player",{"video-player-clip":e.isClipping,"video-player-with-background":!e.omitBackgroundColor},e.videoPlayerClassName);return(0,o.tZ)(L,{className:d()(e.className,{"with-preview":!t.previewHidden,"full-width":a>=960,"video-player-wrapper-clip":e.isClipping,"video-player-with-background":!e.omitBackgroundColor}),linkClassName:n,href:this.href(),width:a,height:i,onClick:this.onPreviewClick,children:this.renderPlayer(this.props,this.state)})}renderPlayer(e,t){let{hidePlayButton:i,mediaUpload:a,noControls:n,noPreview:s,renderPlayButton:l,startMuted:d,videoClassName:h,liveStreamId:c,loop:u,thumbnailUrl:y}=e,{autoPlay:_,attemptingToPlay:k,previewHidden:b,showControls:P,useHLSJS:Z,browserCanPlayHLS:C,HLSerrored:L,failedAutoplay:U}=t,I=!s&&!b,D=!this.playbackEnabled(),M=this.getBaseVideoSrc(),N=[];N=c?["hls"]:C?["hls","mp4"]:Z?[]:(0,v.Dt)()?["hls","mp4"]:L?["mp4"]:["hls","mp4"];let R=(0,v.K1)(),A=!!(0,m.default)("use_preloaded_player_sources")&&R,B=_&&!U&&this.playbackEnabled(),H=y||"".concat((0,f.ow1)(a),"?refresh=").concat(a.updated_at);return[this.playbackEnabled()&&"undefined"!=typeof window&&(0,o.tZ)("video",{ref:this.assignPlayer,controls:P&&!n&&!I,controlsList:"nodownload",autoPlay:B,poster:H,muted:d,loop:u,className:h,playsInline:R,crossOrigin:"anonymous",children:A?Object.entries(this.state.sources).map((e,t)=>{let[i,a]=e;return(0,o.tZ)("source",{src:a,type:E[i],onError:t===Object.keys(this.state.sources).length-1?this.onAllSourcesFailed:void 0},"".concat(i,"_").concat(t))}):N.map((e,t)=>(0,o.tZ)("source",{src:(0,f.rhs)(M,{type:e}),type:E[e],onError:t===N.length-1?this.onAllSourcesFailed:void 0},"".concat(e,"_").concat(t)))}),I&&!i&&(0,o.BX)(r.Fragment,{children:[D&&(0,o.tZ)(T,{mediaUpload:a,thumbnailUrl:H}),!l&&(0,o.tZ)(S,{children:this.cta()?(0,o.tZ)(w._L,{href:this.href(),loading:k&&this.playbackEnabled(),"aria-label":"play",leading:(0,o.tZ)(p.Z,{height:16,width:16,style:{stroke:"none",fill:"white"}}),children:this.cta()}):(0,o.tZ)(g.f,{isPlaying:!1,href:this.href(),size:72,loading:k&&this.playbackEnabled()})}),l&&(0,o.tZ)(S,{children:l()})]})]}_initHlsjs(){let e=!!(this.player&&this.player.canPlayType("application/vnd.apple.mpegurl"));if(e&&!(0,v.Dt)()){this.setState({browserCanPlayHLS:e});return}i.e("4754").then(i.t.bind(i,67631,23)).then(e=>{this._initHlsjsWrapped(e.default)})}_initHlsjsWrapped(e){let t=this,i=e.isSupported();if(!e.isSupported()){this.setState({useHLSJS:i});return}null!=this.hls&&this.hls.destroy();let a=new e((0,n._)({enableWorker:!1},{}));null!=this.player&&a.attachMedia(this.player);let s=this.getBaseVideoSrc("hls");a.on(e.Events.MEDIA_ATTACHED,()=>{a.loadSource(s),a.on(e.Events.MANIFEST_PARSED,()=>{if(this.state.autoPlay&&this.player){var e;this.player.muted=null!==(e=this.props.startMuted)&&void 0!==e&&e,this.player.play().catch(e=>{console.error("Unable to autoplay prior to user interaction with the dom.",e),this.setState({failedAutoplay:!0,attemptingToPlay:!1}),this.player&&(this.player.muted=!0,this.player.play().then(()=>{var e,t;null===(e=(t=this.props).onAutoplayMuted)||void 0===e||e.call(t)}).catch(e=>{console.error("Unable to autoplay prior to user interaction with the dom when muted.",e),this.setState({failedAutoplay:!0,attemptingToPlay:!1})}))})}})}),a.on(e.Events.ERROR,function(i,n){if(n.fatal)switch(n.type){case e.ErrorTypes.NETWORK_ERROR:var s;t.setState({useHLSJS:!1}),null===(s=t.hls)||void 0===s||s.destroy(),a.startLoad();break;case e.ErrorTypes.MEDIA_ERROR:a.recoverMediaError();break;default:this._initHlsjs()}}),this.hls=a,this.hlsModule=e}constructor(e,t){var i,o;super(e,t),i=this,(0,a._)(this,"player",null),(0,a._)(this,"previewHiddingTimeout",null),(0,a._)(this,"lastTimeUpdate",null),(0,a._)(this,"_accumulatedDurationPlayed",0),(0,a._)(this,"containerRef",(0,r.createRef)()),(0,a._)(this,"isShowingCaptionsElsewhere",!1),(0,a._)(this,"assignPlayer",e=>{this.player=e}),(0,a._)(this,"resetDurationTracking",()=>{this.lastTimeUpdate=null,this.setState({durationPlayed:0,durationPlayedId:(0,h.v4)()})}),(0,a._)(this,"onLoadedMetadata",()=>{this.state.playbackRestoreLocation&&(this.player&&(this.player.currentTime=this.state.playbackRestoreLocation),this.previewHiddingTimeout=window.setTimeout(()=>this.setState({playbackRestoreLocation:null,previewHidden:!0}),3e3))}),(0,a._)(this,"onLoadedData",()=>{this.state.playbackRestoreLocation&&(this.previewHiddingTimeout&&clearTimeout(this.previewHiddingTimeout),this.setState({playbackRestoreLocation:null,previewHidden:!0}))}),(0,a._)(this,"onCanPlay",()=>{this.onTimeUpdate()}),(0,a._)(this,"onPlay",()=>{null===v.sz||void 0===v.sz||v.sz.emit("play",this),this.setState({playing:!0}),this.lastTimeUpdate=Date.now(),this.trackMedia(u.FP.MEDIA_PLAYBACK_STARTED)}),(0,a._)(this,"onPause",()=>{var e;this.setPlaybackRestoreLocation(),this.lastTimeUpdate=null,this.setState({playing:!1,waiting:!1,previewHidden:!this.props.showPreviewWhenPaused&&this.state.previewHidden}),(null===(e=this.player)||void 0===e?void 0:e.ended)||this.trackMedia(u.FP.MEDIA_PLAYBACK_PAUSED),this.player&&this.player.currentTime>this.player.duration-.1&&this.onVideoReachEnd()}),(0,a._)(this,"onEnded",()=>{this.lastTimeUpdate=null,this.setState({playing:!1,waiting:!1,previewHidden:!this.props.showPreviewWhenPaused&&this.state.previewHidden}),this.trackMedia(u.FP.MEDIA_PLAYBACK_PAUSED),this.onVideoReachEnd()}),(0,a._)(this,"onTimeUpdate",()=>{if(!this.player||!isFinite(this.player.duration))return;let e=this.player.currentTime,t=Date.now();if(this.state.playing&&null!==this.lastTimeUpdate){let e=(t-this.lastTimeUpdate)/1e3;e>0&&e<1&&(this._accumulatedDurationPlayed=(this._accumulatedDurationPlayed||0)+e,this._accumulatedDurationPlayed>=1&&(this.setState(e=>({durationPlayed:e.durationPlayed+this._accumulatedDurationPlayed})),this._accumulatedDurationPlayed=0))}this.lastTimeUpdate=t,(this.props.duration||this.state.duration===this.player.duration)&&this.state.currentTime===e?this.setState({waiting:!1}):this.setState({duration:this.props.duration||this.player.duration,currentTime:e,waiting:!1})}),(0,a._)(this,"onWaiting",()=>{this.lastTimeUpdate=null,this.setState({waiting:Date.now()})}),(0,a._)(this,"onPlaying",()=>{this.previewHiddingTimeout&&clearTimeout(this.previewHiddingTimeout),this.lastTimeUpdate=Date.now(),this.setState({playing:!0,waiting:!1,previewHidden:!0,attemptingToPlay:!1,autoPlay:!1,hasPlayed:!0})}),(0,a._)(this,"onSeeked",()=>{this.lastTimeUpdate=Date.now(),this.trackMedia(u.FP.MEDIA_SEEKED)}),(0,a._)(this,"onVideoReachEnd",function(){let{resetTime:e=!0,triggerCallback:t=!0,track:a=!0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i.lastTimeUpdate=null,i.player&&!i.player.paused&&i.player.pause(),i.state.previewHidden&&i.setState({previewHidden:!1,attemptingToPlay:!1,hasReachedEnd:!0}),e&&i.player&&!(0,v.L)()&&!i.props.doNotResetOnEnd&&(i.player.currentTime=0),(0,v.Qg)(),(0,v.Yk)(),i.props.onFinishVideo&&t&&i.props.onFinishVideo(),a&&i.trackMedia(u.FP.MEDIA_PLAYBACK_COMPLETED)}),(0,a._)(this,"onContextMenu",e=>{e.preventDefault()}),(0,a._)(this,"onUserInteraction",()=>{this.state.showControls||this.setState({showControls:!0})}),(0,a._)(this,"onAllSourcesFailed",()=>{var e,t;console.error("Failed to load all video sources, falling back to preview image"),this.setState((0,s._)((0,n._)({},this.props.liveStreamId?{}:{previewHidden:!1,attemptingToPlay:!1,autoPlay:!1}),{allSourcesFailed:!0})),null===(e=(t=this.props).onPlaybackFailed)||void 0===e||e.call(t)}),(0,a._)(this,"onBeforeUnload",()=>{this.setPlaybackRestoreLocation(),this.state.previewHidden&&this.setState({previewHidden:!1,attemptingToPlay:!1}),this.player&&!this.player.paused&&this.player.pause()}),(0,a._)(this,"onGlobalPlay",e=>{this!==e&&this.player&&!this.player.paused&&this.player.pause()}),(0,a._)(this,"onGlobalKeyDown",e=>{var t;!this.props.noKeyboardShortcuts&&!e.metaKey&&!e.altKey&&!e.ctrlKey&&document.activeElement===document.body&&this.player&&(!((null!==(t=null===v.sz||void 0===v.sz?void 0:v.sz.listenerCount("play"))&&void 0!==t?t:0)>1)||!this.player.paused)&&("f"===e.key?(0,v.rm)()?(0,v.Qg)()&&e.preventDefault():((0,v.bt)(this.player)&&e.preventDefault(),this.player.paused&&this.player.play()):" "!==e.key||(0,v.rm)()?"ArrowRight"===e.key?this.player.currentTime+5>this.player.duration?this.onVideoReachEnd():(this.player.currentTime+=5,this.state.previewHidden||this.setState({previewHidden:!0,attemptingToPlay:!1})):"ArrowLeft"===e.key&&(this.player.currentTime-=5):(e.preventDefault(),this.player.paused?this.player.play():this.player.pause()))}),(0,a._)(this,"getBaseVideoSrc",e=>{var t;let i={token:this.props.reaction_token,override_publication_id:null===(t=this.props.pub)||void 0===t?void 0:t.id,preview:this.props.usePreview};return e&&(i.type=e),(0,f.rhs)("/api/v1/video/upload/".concat(this.props.mediaUpload.id,"/src"),i)}),(0,a._)(this,"hls",null),(0,a._)(this,"hlsModule",void 0),(0,a._)(this,"cta",()=>""),(0,a._)(this,"href",()=>this.props.href),(0,a._)(this,"playbackEnabled",()=>!0);let l="undefined"!=typeof window?(0,k.m)(window.location.href):{},d=null;l.timestamp?d=parseInt(l.timestamp):l.t&&(d=parseInt(l.t));let p=null!==d&&!isNaN(d);p||(0,v.iO)("timestamp");let c=p?d:this.getPlaybackRestoreLocation();this.state={playbackRestoreLocation:c,currentTime:0,waiting:!0,duration:null!==(o=e.mediaUpload.duration)&&void 0!==o?o:null,autoPlay:e.autoPlay,playing:!1,attemptingToPlay:e.autoPlay,previewHidden:null!==c&&c>0,showControls:!1,hasPlayed:!1,hasReachedEnd:!1,browserCanPlayHLS:!1,useHLSJS:!0,HLSerrored:!1,allSourcesFailed:!1,failedAutoplay:!1,sources:{},durationPlayed:0,durationPlayedId:(0,h.v4)()},this.onPreviewClick=this.onPreviewClick.bind(this)}}function C(e){let{className:t,mediaUpload:i,href:a}=e;return(0,o.tZ)(L,(0,s._)((0,n._)({},(0,b.videoPlayerDimensions)(i,{isStatic:!0})),{className:d()(t,"video-player-with-background","is-static"),linkClassName:"video-player-with-background",href:a,children:(0,o.tZ)(T,{mediaUpload:i,testId:"video-player-static-preview-image",isStatic:!0})}))}function L(e){let{className:t,linkClassName:i,width:a,height:n,href:s,onClick:r,children:l}=e,h={paddingBottom:"".concat(Math.min(60,100*n/a).toFixed(4),"%")};return(0,o.tZ)("div",{className:d()(t,"video-player-wrapper",a>=960&&"full-width"),onClick:r,role:"region","aria-label":"Video player",children:(0,o.tZ)(s?"a":"div",{className:d()("video-player",i),href:s,style:h,children:l})})}function T(e){let{mediaUpload:t,thumbnailUrl:i,testId:a,isStatic:n}=e;return(0,o.tZ)("img",{className:"video-player-preview",width:550,src:i||(0,f.kOB)(t,{isStatic:n}),"data-component-name":"VideoPlayer-PreviewImg","data-testid":a})}let S=(0,_.zo)({position:"absolute",className:d()(P.Z.buttonContainer,"video-player-button")})},65523:function(e,t,i){i.d(t,{AM:()=>_,ZN:()=>w,hQ:()=>v,xB:()=>u});var a=i(7409),n=i(16584),s=i(12048),o=i(71375);i(98661),i(29032);var r=i(97742),l=i(71068),d=i(15771),h=i(19081),p=i(58175),c=i(23750);let u=e=>{let t,i,{onClose:a,showClose:s=!1,title:o,description:r,icon:l,showDivider:d=!1,alignItems:h="start"}=e;return"center"===h?(t=d?C:E,i=S):(t=d?Z:P,i=T),(0,n.BX)(t,{children:[l,(0,n.BX)(i,{children:[o&&(0,n.tZ)(m,{text:o}),r&&(0,n.tZ)(y,{text:r})]}),s&&a&&(0,n.tZ)(v,{onClose:a})]})},m=e=>{let{text:t}=e;return(0,n.tZ)(s.V.Title,{as:"span",children:(0,n.tZ)(p.xv.B2,{weight:"semibold",color:"primary",children:t})})},y=e=>{let{text:t}=e;return(0,n.tZ)(s.V.Description,{as:"span",children:(0,n.tZ)(p.xv.B3,{color:"secondary",children:t})})},v=e=>{let{onClose:t}=e;return(0,n.tZ)(d.hU,{priority:"quaternary",size:"sm",title:"Close",onClick:t,"aria-label":"close",position:"absolute",className:c.Z.closeButton,children:(0,n.tZ)(o.Z,{size:20})})},_=e=>{let{icon:t,bg:i}=e;return(0,n.tZ)(g,{bg:i,children:t})},w=()=>(0,n.tZ)(g,{bg:"accent-orange",children:(0,n.tZ)(r.Z,{height:20})}),g=e=>{let{children:t,bg:i="secondary"}=e;return(0,n.tZ)(h.X2,{display:"flex",flex:"auto",width:48,height:48,bg:i,radius:"sm",alignItems:"center",justifyContent:"center",outline:"detail",children:t})},f={display:"flex",direction:"column",gap:16,paddingX:20,paddingTop:20,alignItems:"start"},k={paddingTop:16,paddingBottom:16,borderBottom:"detail"},b={alignItems:"center"},P=(0,l.zo)((0,a._)({},f)),E=(0,l.zo)((0,a._)({},f,b)),Z=(0,l.zo)((0,a._)({},f,k)),C=(0,l.zo)((0,a._)({},f,k,b)),L={display:"flex",direction:"column",gap:4},T=(0,l.zo)((0,a._)({},L)),S=(0,l.zo)((0,a._)({},L,{alignItems:"center",textAlign:"center"}))},39493:function(e,t,i){i.d(t,{K:()=>C,y:()=>L});var a=i(7409),n=i(99282),s=i(16584),o=i(30396),r=i(74655),l=i(17876),d=i(38457),h=i(95441),p=i(60807),c=i(7882),u=i(98914),m=i(15771),y=i(19081),v=i(44424),_=i(6490),w=i(58175),g=i(70379),f=i(27744),k=i(75419),b=i(61412),P=i(33884),E=i(60836),Z=i(63651);function C(e){var t,i;let{pub:m,post:y,comment:_,feedItem:w,onRestack:C,tabId:T,surface:S,renderWithoutUser:U=!1}=e,I=(0,p.aF)(),D=(0,g.pm)(),M=(!!I||U)&&!(null==m?void 0:m.hide_post_restacks)&&!(null==m?void 0:m.invite_only),N=!!(null===(t=_||y)||void 0===t?void 0:t.restacked),R=(null===(i=_||y)||void 0===i?void 0:i.restacks)||0,A=(0,f.I0)(),B=(0,k.i3)(),[H,x]=(0,o.eJ)(!1),F=(0,c.ib)({pathname:"/api/v1/restack/feed"}),{iString:O}=(0,h.M1)(),{nuxModal:K,showRestackNux:z}=L(_&&!_.post_id?"note":_?"comment":"post"),j=async()=>{if(!I){x(!0);return}let e=await F.refetch({method:"POST",json:{postId:_?null:null==y?void 0:y.id,commentId:(null==_?void 0:_.id)||null,tabId:T,surface:S}});if(e instanceof Error){alert((0,u.zx)(e));return}D.popToast(t=>(0,s.tZ)(g.FN,(0,n._)((0,a._)({},t),{text:e.comment?O("Note restacked"):O("Post restacked"),Icon:r.Z,cta:O("View"),href:(0,P.E2)()}))),e.comment?A({type:"comment_restack",payload:{commentId:e.comment.id,isRestacked:!0}}):A({type:"post_restack",payload:{postId:e.post.id,isRestacked:!0}}),z(),null==C||C(!0)},V=async()=>{let e=await F.refetch({method:"DELETE",json:{postId:_?null:null==y?void 0:y.id,commentId:(null==_?void 0:_.id)||null,tabId:T}});if(e instanceof Error){alert((0,u.zx)(e));return}D.popToast(e=>(0,s.tZ)(g.FN,(0,n._)((0,a._)({},e),{text:O("Restack undone"),Icon:l.Z}))),_?A({type:"comment_restack",payload:{commentId:_.id,isRestacked:!1}}):y&&A({type:"post_restack",payload:{postId:y.id,isRestacked:!1}}),null==C||C(!1)},X=async()=>{if(!I){x(!0);return}try{var e;await B.open((0,a._)({feedItem:w,restackUrl:_?(0,E.aE)(y,_,m):(0,Z.uRy)(m,y),tabId:T,surface:S},(null==w?void 0:w.type)==="post"&&{mediaClipId:null===(e=w.mediaClip)||void 0===e?void 0:e.id})),z()}catch(e){}};return(0,b.B)({name:"restack-comment",action:()=>{M&&X()}}),{canRestack:M,isRestacked:N,restacks:R,nuxModal:K,loggedOutRestackAttempt:H,menuItems:[N?(0,s.tZ)(v.sN,{leading:(0,s.tZ)(l.Z,{}),onClick:V,children:O("Undo restack")}):(0,s.tZ)(v.sN,{leading:(0,s.tZ)(r.Z,{}),onClick:j,children:O("Restack")}),(0,s.tZ)(v.sN,{leading:(0,s.tZ)(d.Z,{}),onClick:X,children:O("Restack with a note")})]}}function L(e){let t=function(e){let{entityType:t}=e,[i,a]=(0,o.eJ)(!1),n=()=>{a(!1)};return{open:()=>{a(!0)},element:(0,s.tZ)(_.u_,{isOpen:i,onClose:n,children:(0,s.tZ)(T,{onClose:n,entityType:t})})}}({entityType:e}),i=(0,c.ib)({pathname:"/api/v1/feed/has-restacked",auto:!1,cacheTtl:1/0}),a=async()=>{var e;let a=null!==(e=i.result)&&void 0!==e?e:await i.refetch();a instanceof Error||(null==a?void 0:a.hasRestacked)!==!1||(t.open(),i.setResult({hasRestacked:!0}))};return{nuxModal:t.element,showRestackNux:a}}function T(e){let{onClose:t,entityType:i}=e,{iString:a}=(0,h.M1)();return(0,s.BX)(y.tu,{paddingX:16,children:[(0,s.tZ)(y.hs,{justifyContent:"center",paddingTop:32,paddingBottom:24,children:(0,s.tZ)(r.Z,{size:40,stroke:"var(--color-fg-primary)"})}),(0,s.BX)(y.tu,{gap:12,children:[(0,s.BX)(w.xv.H3,{align:"center",children:["comment"===i&&a("You restacked a comment"),"note"===i&&a("You restacked a note"),"post"===i&&a("You restacked a post")]}),(0,s.BX)(w.xv.B3,{color:"secondary",align:"center",children:["comment"===i&&a("Restack comments that inspire you to share them with more people."),"note"===i&&a("Restack notes that inspire you to share them with more people."),"post"===i&&a("Restack posts that inspire you to share them with more people.")," ",a("Subscribers can see your restacks in the Notes tab and on your profile.")]})]}),(0,s.BX)(y.tu,{paddingBottom:16,paddingTop:20,gap:8,children:[(0,s.tZ)(m.zx,{priority:"primary",href:(0,P.E2)(),children:a("View now")}),(0,s.tZ)(m.zx,{priority:"secondary-outline",onClick:t,children:a("OK")})]})]})}}}]);