"use strict";(self.webpackChunksubstack=self.webpackChunksubstack||[]).push([["4918"],{23710:function(e,t,n){n.d(t,{Z:()=>o});let o={reactionsHoverZone:"reactionsHoverZone-nHxYxG",reactionsContainer:"reactionsContainer-uNTS8E",outgoing:"outgoing-xjlZZA",emojiGrid:"emojiGrid-yGGf1S",reaction:"reaction-BmRJjL",selected:"selected-T0p6AZ",nameCard:"nameCard-dZv34e",emojiBox:"emojiBox-hGb2ir",addReactButton:"addReactButton-j8HliB",emojiPopover:"emojiPopover-UcQl9N",show:"show-rCpI7T"}},41293:function(e,t,n){n.d(t,{oQ:()=>L,aQ:()=>H,Jg:()=>x});var o=n(16584),i=n(6400),r=n(30396),c=n(94184),a=n.n(c),l=n(20160),s=n(7409),u=n(99282),d=n(64515);let p=e=>(0,o.BX)(d.l,(0,u._)((0,s._)({},e),{name:"EmojiPickerIcon",svgParams:{height:15,width:14,viewBox:"0 0 15 14",fill:"none",stroke:"none"},children:[(0,o.tZ)("path",{d:"M12.7474 7.25708C12.3309 7.37462 11.8916 7.4375 11.4375 7.4375C8.77963 7.4375 6.625 5.28287 6.625 2.625C6.625 2.17094 6.68788 1.73156 6.80542 1.31511C6.74549 1.31337 6.68535 1.3125 6.625 1.3125C3.24226 1.3125 0.5 4.05476 0.5 7.4375C0.5 10.8202 3.24226 13.5625 6.625 13.5625C10.0077 13.5625 12.75 10.8202 12.75 7.4375C12.75 7.37715 12.7491 7.31701 12.7474 7.25708ZM5.75 5.25C5.75 5.97487 5.16237 6.5625 4.4375 6.5625C3.71263 6.5625 3.125 5.97487 3.125 5.25C3.125 4.52513 3.71263 3.9375 4.4375 3.9375C5.16237 3.9375 5.75 4.52513 5.75 5.25ZM10.125 8.3125C10.125 10.2455 8.558 11.8125 6.625 11.8125C4.692 11.8125 3.125 10.2455 3.125 8.3125H10.125Z",fill:"#808080","fill-rule":"evenodd","clip-rule":"evenodd"}),(0,o.tZ)("path",{d:"M12.0938 0H10.7812V1.96875L8.8125 1.96875V3.28125H10.7812V5.25H12.0938V3.28125H14.0625V1.96875L12.0938 1.96875V0Z",fill:"#808080","fill-rule":"evenodd","clip-rule":"evenodd"})]}));var m=n(5772);n(60807);var h=n(48980),f=n(7882),g=n(80026),y=n(32700),v=n(21685),Z=n(98248),C=n(40225),w=n(63474),j=n(58175),b=n(55533),k=n(23710);let B=(0,i.createContext)({isLoading:!1,emojis:{suggestedReactionTypes:[],categories:[],reactionTypes:{}}});function x(e){let{context:t,reactions:n,currentReaction:i,onReactionClick:c,isReadOnly:s,showCounts:u=!0,maxReactions:d,direction:p}=e,m=n&&Object.keys(n).some(e=>n[e]>0),h=(0,r.sO)(null),[f,Z]=(0,r.eJ)(!1),{emojis:C,isLoading:w}=(0,r.qp)(B),b=(0,r.Ye)(()=>n&&(null==C?void 0:C.reactionTypes)?Object.entries(n).sort((e,t)=>{let[n,o]=e,[i,r]=t;return o===r?n.localeCompare(i):r-o}).filter(e=>{let[t,n]=e;return n>0&&C.reactionTypes[t]}).slice(0,3):[],[n,C]);return(null==C?void 0:C.reactionTypes)?(0,o.tZ)(l.W,{children:(0,o.BX)(g.gq,{onClick:S,className:a()(k.Z.reactionsContainer,{[k.Z.show]:m||f,[k.Z.outgoing]:"outgoing"===p}),children:[b.map(e=>{let[n,r]=e,l=C.reactionTypes[n],s=n===i||l===i,d=(0,o.BX)(g.gq,{className:a()(k.Z.reaction,{[k.Z.selected]:u&&s}),shadow:"sm",bg:"primary",gap:4,alignItems:"center",justifyContent:"center",paddingX:6,onClick:()=>l&&c&&c(n,l),children:[(0,o.tZ)(j.xv.B4,{font:"emoji",children:l}),u&&(0,o.tZ)(j.xv.Meta,{fontWeight:"bold",color:s?"white":"primary",children:r})]},n);return["feed-recommended","direct-message"].includes(t.type)?d:(0,o.tZ)(y.z,{layerClassName:k.Z.nameCard,content:(0,o.tZ)(O,{context:t,reaction:n}),layerOptions:{placement:"bottom-center"},children:d},n)}),!s&&(!d||!i)&&(0,o.tZ)(v.J,{content:e=>{let{closePopover:t}=e;return(0,o.tZ)(N,{emojis:C,isLoading:w,currentReaction:i,onPick:(e,n)=>{c&&c(e,n),t()},inputRef:h})},autofocus:!0,inputRef:h,preferPlacement:"bottom-center",hideOnScroll:!0,layerClassName:k.Z.emojiPopover,onOpen:()=>Z(!0),onClose:()=>Z(!1),children:(0,o.tZ)(T,{})})]})}):null}function T(){return(0,o.tZ)(g.hs,{className:k.Z.addReactButton,shadow:"sm",bg:"primary",paddingX:4,alignItems:"center",children:(0,o.tZ)(p,{className:k.Z.addReactIcon})})}function N(e){var t;let{emojis:i,isLoading:c,currentReaction:a,onPick:s,inputRef:u}=e,d=(0,r.Ye)(()=>(null==i?void 0:i.reactionTypes)&&!c?Object.keys(i.reactionTypes):[],[null==i?void 0:i.reactionTypes,c]),{result:p,isLoading:h}=(0,f.Wf)(()=>n.e("7710").then(n.t.bind(n,54833,19)),[],{auto:!0}),y=(0,r.I4)(e=>[e,...(null==p?void 0:p[e])||[]],[p]),{filteredItems:v,setQuery:w,hasFiltered:j,query:k}=(0,m.R)({items:d,getKeys:y,deps:[d,y]});return(0,o.tZ)(l.W,{children:(0,o.BX)(g.tu,{sizing:"border-box",gap:12,padding:4,minWidth:320,height:400,onClick:S,children:[(0,o.tZ)(C.M,{ref:u,onChange:w}),c||h?(0,o.tZ)(g.tu,{flex:"grow",justifyContent:"center",alignItems:"center",children:(0,o.tZ)(Z.$j,{})}):(0,o.BX)(o.HY,{children:[j&&(v&&v.length>0?(0,o.tZ)(R,{reactions:v,currentReaction:a,onPick:s,emojiMap:i.reactionTypes,title:null}):(0,o.tZ)(b.vJ,{title:"No results for ".concat(k),body:"Try another search"})),!j&&(0,o.BX)(o.HY,{children:[(0,o.tZ)(R,{reactions:i.suggestedReactionTypes,currentReaction:a,onPick:s,emojiMap:i.reactionTypes,title:"Suggested"}),null===(t=i.categories)||void 0===t?void 0:t.map(e=>(0,o.tZ)(R,{reactions:e.reactionTypes,currentReaction:a,onPick:s,emojiMap:i.reactionTypes,title:e.title},e.title))]})]})]})})}function O(e){var t;let{reaction:n,context:i}=e,r=["posts","feed-subscribed"].includes(i.type)?"/api/v1/community/posts/".concat(i.id,"/reactions"):"/api/v1/community/comments/".concat(i.id,"/reactions"),{result:c,isLoading:a}=(0,f.ib)({pathname:r,method:"GET",auto:!0});if(a)return(0,o.tZ)(Z.$j,{});let l=(null!==(t=null==c?void 0:c.reactions.filter(e=>e.reaction===n))&&void 0!==t?t:[]).map(e=>e.user.name),s=l.slice(0,6),u=Math.max(0,l.length-6);return(0,o.BX)(g.tu,{gap:2,position:"relative",onClick:S,overflowY:"auto",children:[s.map(e=>(0,o.tZ)(X,{text:e})),u>0&&(0,o.tZ)(X,{text:"+ ".concat(u," ").concat(1===u?"other":"others")})]})}function R(e){let{reactions:t,currentReaction:n,onPick:i,emojiMap:r,title:c}=e;return(0,o.BX)(g.tu,{gap:4,children:[c&&(0,o.tZ)(j.xv.B4,{color:"secondary",children:c}),(0,o.tZ)(g.xu,{className:k.Z.emojiGrid,gap:2,alignItems:"center",justifyContent:"center",children:null==t?void 0:t.map(e=>(0,o.tZ)(E,{onClick:()=>i(e,r[e]),className:a()(k.Z.emojiBox,{[k.Z.selected]:e===n}),children:(0,o.tZ)(P,{children:r[e]})},e))})]})}function X(e){let{text:t}=e;return(0,o.tZ)(j.xv,{size:12,color:"primary",weight:"medium",font:"text",children:t})}let E=(0,w.zo)({bg:"primary",alignItems:"center",justifyContent:"center",radius:"sm",width:32,height:32,cursor:"pointer"},w.X2),P=(0,w.zo)({fontSize:20,lineHeight:20,color:"primary",fontWeight:"medium",font:"emoji"}),S=e=>{e.stopPropagation(),e.preventDefault()};async function L(e,t,n){try{return await (0,h.rd)("/api/v1/community/".concat(n,"/").concat(t,"/reaction"),{method:"POST",json:{reaction:e}})}catch(e){return e}}async function H(e,t,n){try{return await (0,h.rd)("/api/v1/community/".concat(n,"/").concat(t,"/reaction"),{method:"DELETE",query:{reaction:e}})}catch(e){return e}}},27625:function(e,t,n){n.d(t,{HU:()=>y,Sl:()=>f,cD:()=>g});var o=n(58865),i=n(16584),r=n(30396),c=n(23260),a=n(29032),l=n(95441),s=n(7271),u=n(15771),d=n(19081),p=n(58175),m=n(60308);function h(){let e=(0,o._)(["This "," was automatically hidden by your content settings."]);return h=function(){return e},e}function f(e){let t=(0,s.M)(),[n,o]=(0,r.eJ)(e&&!t);return{isHidden:n,onShow:()=>o(!1)}}function g(e){let{onShow:t,itemName:n,radius:o}=e,{iString:r,iTemplate:c}=(0,l.M1)(),s=c(h(),n||"item");return(0,i.tZ)(y,{onShow:t,radius:o,children:(0,i.BX)(a.C,{children:[(0,i.BX)(d.tu,{gap:4,alignItems:"center",justifyContent:"center",children:[(0,i.tZ)(p.xv.B4,{align:"center",color:"vibrance-primary",weight:"semibold",translated:!0,children:"May contain explicit content"}),(0,i.tZ)(p.xv.B4,{align:"center",color:"vibrance-secondary",children:s})]}),(0,i.BX)(d.gq,{gap:8,alignItems:"center",wrap:"wrap",justifyContent:"center",children:[(0,i.tZ)(u.zx,{priority:"primary-mono",children:r("Show anyway")}),(0,i.tZ)(u.zx,{priority:"secondary-outline",href:(0,m.v3t)({section:"privacy"}),newTab:!0,children:r("Adjust settings")})]})]})})}function y(e){let{onShow:t,children:n,radius:o}=e;return(0,i.BX)(d.tu,{justifyContent:"center",alignItems:"center",position:"absolute",inset:0,bg:"glass-inverted-thick",gap:16,padding:16,cursor:"pointer",onClick:e=>{e.preventDefault(),t()},radius:o,children:[(0,i.tZ)(c.Z,{size:24,stroke:"var(--color-utility-white)"}),n]})}},21685:function(e,t,n){n.d(t,{J:()=>p});var o=n(7409),i=n(99282),r=n(98848),c=n(16584),a=n(94184),l=n.n(a),s=n(98661),u=n(62372),d=n(6651);let p=e=>{var{className:t="",children:n,layerClassName:a,inputRef:p,hideOnScroll:m=!1,autofocus:h=!1,onClose:f,onOpen:g}=e,y=(0,r._)(e,["className","children","layerClassName","inputRef","hideOnScroll","autofocus","onClose","onOpen"]);let[v,Z]=(0,s.useState)(!1),C=()=>{v||(Z(!0),null==g||g())},w=()=>{v&&(Z(!1),null==f||f())},j=function(e){let{open:t,onClose:n,disabled:r,possiblePlacements:a=["top-center","bottom-center","top-start","bottom-start","top-end","bottom-end"],preferPlacement:p,snap:m=!1,onOpen:h,content:f,className:g,layerOptions:y,closeOnOutsideClick:v=!0}=e,Z=(0,s.useRef)(!1);(0,s.useEffect)(()=>{t&&!Z.current&&h&&(Z.current=!0,h())},[t,h]);let{triggerProps:C,layerProps:w,renderLayer:j}=(0,u.sJ)((0,o._)({isOpen:!r&&t,overflowContainer:!1,auto:!0,snap:m,possiblePlacements:a,placement:p,containerOffset:10,triggerOffset:8},v&&{onOutsideClick:()=>n()},p&&{placement:p},y));return{triggerProps:C,layer:t&&!r&&j((0,c.tZ)("div",(0,i._)((0,o._)({className:l()("popoverLayerForScrollDetection",d.Z.popoverBase,g)},w),{children:"function"==typeof f?f({closePopover:n}):f})))}}((0,o._)({open:v,onClose:w,onOpen:C,hideOnScroll:m,className:a},y));return(0,s.useEffect)(()=>{let e=e=>{"Escape"===e.key&&w()};return v&&window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}},[v,f]),function(e){let{hideOnScroll:t,handleClose:n,open:o}=e,i=(0,s.useCallback)(e=>{requestAnimationFrame(()=>{var i;let r=null===(i=e.target.classList)||void 0===i?void 0:i.contains("popoverLayerForScrollDetection");o&&t&&!r&&n()})},[t,n,o]);(0,s.useEffect)(()=>{if(t)return window.addEventListener("scroll",i,!0),()=>{window.removeEventListener("scroll",i,!0)}},[i,t])}({hideOnScroll:m,handleClose:w,open:v}),(0,s.useEffect)(()=>{v&&h&&p&&p.current&&p.current.focus({preventScroll:!0})},[v,h,p]),(0,c.BX)("div",(0,i._)((0,o._)({className:t},j.triggerProps),{onClick:e=>{v?w():C(),e.stopPropagation()},children:["function"==typeof n?n({isOpen:v}):n,j.layer]}))}}}]);