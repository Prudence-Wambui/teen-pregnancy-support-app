"use strict";(self.webpackChunksubstack=self.webpackChunksubstack||[]).push([["5519"],{51455:function(e,t,n){n.d(t,{I:()=>C});var i=n(7409),a=n(99282),o=n(58865),r=n(16584),l=n(30396),c=n(45609),d=n(98661),s=n(20160),u=n(95441),p=n(98914),m=n(15771),h=n(19081),f=n(98248),g=n(51776),y=n(70379),v=n(60836),Z=n(63651),k=n(64473);function b(){let e=(0,o._)([""," by ",""]);return b=function(){return e},e}let w=e=>{let{width:t,height:n}=e,i="undefined"!=typeof window?window.innerHeight:1/0,a=1;return i<700?a=.7:i<800?a=.75:i<900&&(a=.8),{width:t*a,height:n*a,scaler:a}};function C(e){let{onClose:t,post:n,pub:o,comment:C}=e,{iString:P,iTemplate:I,language:x}=(0,u.M1)(),[_,T]=(0,l.eJ)({width:400,height:400}),[S,B]=(0,l.eJ)(!1),O=(0,l.sO)(null),{popToast:U}=(0,y.pm)(),X=(e,t)=>'<div class="substack-post-embed"><p lang="'.concat(x,'">').concat(I(b(),t.title,e.author_name),"</p><p>").concat(t.subtitle,'</p><a data-post-link href="').concat((0,v.Mo)(e,t.slug),'">').concat(P("Read on Substack"),'</a></div><script async src="').concat((0,Z.ZJn)(),'/embedjs/embed.js" charset="utf-8"><\/script>'),N=e=>'<div class="substack-post-embed"><p lang="'.concat(x,'">').concat("".concat(e.body||""),"</p>").concat(e.name?"<p> - ".concat(e.name,"</p>"):e.handle?"<p> - @".concat(e.handle,"</p>"):"",'<a data-comment-link href="').concat((0,Z.Sgq)(e),'">').concat(P("Read on Substack"),'</a></div><script async src="').concat((0,Z.ZJn)(),'/embedjs/embed.js" charset="utf-8"><\/script>');(0,d.useEffect)(()=>{if(!C&&!n)return;let e=e=>{e.data.iframeHeight&&(T({width:500,height:e.data.iframeHeight}),B(!0))};return window.addEventListener("message",e),()=>{window.removeEventListener("message",e)}},[C,n]);let{width:R,height:j,scaler:H}=w(_);return(0,r.tZ)(s.W,{children:(0,r.BX)(h.tu,{padding:20,gap:20,bg:"primary",children:[(0,r.tZ)("div",{style:{width:R,height:j,display:S?"block":"none",opacity:S?"visible":"hidden",alignSelf:"center"},children:(0,r.tZ)("iframe",{ref:O,style:{transform:"scale(".concat(H,")"),width:_.width,height:_.height},className:k.Z.iframe,src:C?(0,Z.QXp)(C,{isPreview:!0}):o&&n?(0,v.Tg)(o,n.slug,{isPreview:!0}):"",onLoad:()=>{B(!0)}})}),!S&&(0,r.tZ)(h.gq,{flex:"grow",minHeight:220,bg:"secondary",radius:"md",justifyContent:"center",alignItems:"center",border:"detail",children:(0,r.tZ)(f.$j,{})}),(0,r.BX)(h.gq,{gap:12,flex:"grow",children:[(0,r.tZ)(g.oi,{className:k.Z.codeInput,style:{width:R},value:o&&n?X(o,n):C?N(C):"",disabled:!0}),(0,r.tZ)(m.zx,{priority:"primary",onClick:()=>{(0,p.vQ)(o&&n?X(o,n):C?N(C):""),t&&t(),U(e=>(0,r.tZ)(y.FN,(0,a._)((0,i._)({},e),{text:P("Copied to clipboard"),Icon:c.Z})))},children:P("Copy code")})]})]})})}},33112:function(e,t,n){n.d(t,{F:()=>Z});var i=n(7409),a=n(98848),o=n(16584),r=n(94184),l=n.n(r),c=n(71375),d=n(49770),s=n(95441),u=n(94874),p=n(17540),m=n(15771),h=n(19081),f=n(6490),g=n(58175),y=n(12461),v=n(37430);function Z(e){var{isOpen:t,onClose:n}=e,r=(0,a._)(e,["isOpen","onClose"]);return(0,o.tZ)(f.u_,{isOpen:!!t,onClose:n,width:500,children:(0,o.tZ)(k,(0,i._)({onClose:n},r))})}function k(e){let{faces:t,modalLabel:n,onClose:i,totalCount:a}=e,{iPlural:r}=(0,s.M1)(),l=(a||0)-t.length;return(0,o.BX)(o.HY,{children:[(0,o.BX)(h.hs,{alignItems:"center",justifyContent:"space-between",paddingX:16,paddingY:12,borderBottom:"detail",flex:"grow",children:[(0,o.tZ)(g.xv.H3,{children:n}),i&&(0,o.tZ)(m.hU,{priority:"tertiary",onClick:i,children:(0,o.tZ)(c.Z,{size:20})})]}),(0,o.tZ)(h.tu,{overflowY:"auto",className:v.Z.column,children:(0,o.BX)(h.tu,{gap:4,padding:8,children:[t.map(e=>(0,o.tZ)(b,{face:e},e.id)),l>0&&(0,o.BX)(h.hs,{gap:16,alignItems:"center",padding:8,children:[(0,o.tZ)(h.hs,{className:v.Z.avatarOther,alignItems:"center",justifyContent:"center",children:(0,o.tZ)(d.Z,{className:v.Z.avatarOtherIcon,size:20})}),(0,o.BX)(g.xv.B4,{color:"secondary",children:["+",r("%1 other reader","%1 other readers",l)]})]})]})})]})}function b(e){let{face:t}=e,{id:n,name:i,primary_publication:a,className:r,noLink:c}=t;return(0,o.tZ)(h.hs,{flex:"grow",children:c?(0,o.BX)(h.hs,{gap:12,padding:8,radius:"md",className:v.Z.row,alignItems:"center",flex:"grow",children:[(0,o.tZ)(p.w,{pub:a||void 0,children:(0,o.tZ)(u.xV,{user:t,size:40,className:r})}),(0,o.tZ)(h.tu,{minWidth:0,flex:"grow",children:(0,o.tZ)(g.xv.B3,{decoration:"hover-underline",weight:"semibold",className:(v.Z.link,l()({"no-name":!(i||"").trim().length})),children:i})})]}):(0,o.tZ)(y.$,{person:t},n)},n)}},79094:function(e,t,n){n.d(t,{T:()=>r}),n(16584);var i=n(6400),a=n(30396);n(10878);let o=(0,i.createContext)(()=>void 0);function r(){return(0,a.qp)(o)}},92291:function(e,t,n){n.d(t,{Gn:()=>N,Mk:()=>j,kW:()=>J,yd:()=>X});var i=n(7409),a=n(16584),o=n(3880),r=n(24202),l=n(20888),c=n(42375),d=n(77906),s=n(72572),u=n(25827),p=n(58998),m=n(98170),h=n(60225),f=n(71576),g=n(73544),y=n(68710),v=n(60735),Z=n(37663),k=n(25642),b=n(69181),w=n(93252),C=n(19081),P=n(33451),I=n(15503),x=n(18618),_=n(76820),T=n(23854),S=n(42886),B=n(60308),O=n(63651),U=n(5749);function X(e){let{parent:t,item:n,attachments:i,readOnly:o,isDm:l,isRestack:d,isPermalink:s,isComposing:u,onQuoteThemeChange:p,onAttachmentClick:m,onSavePostClick:h,utm_content:f}=e,g=(0,c.rI)();if(0===i.length)return null;let y=i.filter(e=>"image"===e.type),v=i.filter(e=>"video"===e.type),k=i.filter(e=>"image"!==e.type&&"video"!==e.type);return(0,a.BX)(a.HY,{children:[y.length>0&&(0,a.tZ)(r.sp,{parent:t,readOnly:o||(0,w.P)(),assets:y.map(e=>W(e)),onClick:m,onSwipe:()=>{n&&(0,I.a2)(n,g)},isRestack:d,isPermalink:s,isDm:l}),v.map(e=>{var i;return(0,a.tZ)(_.Jl,{mediaUpload:e.mediaUpload,composing:null!=u&&u,videoPlayerProps:{surface:(0,Z.T)(g),entityType:"comment",entityKey:null!==(i=null==t?void 0:t.id)&&void 0!==i?i:"unknown",contentType:"comment",feedItemTrackingParameters:null==n?void 0:n.trackingParameters}},e.mediaUpload.id)}),k.map(e=>(0,a.tZ)(j,{parent:t,attachment:e,readOnly:o,isDm:l,isRestack:d,isPermalink:s,isComposing:u,onAttachmentClick:m,onSavePostClick:h,onQuoteThemeChange:p,utm_content:f,compactIfPossible:y.length>0||v.length>0||k.length>1,item:null!=n?n:void 0}))]})}function N(e){let{attachments:t}=e;if(0===t.length)return null;let n=t.filter(e=>"image"===e.type),i=t.filter(e=>"video"===e.type);return(0,a.BX)(a.HY,{children:[n.length>0&&(0,a.tZ)(o.i,{assets:n.map(e=>W(e))}),i.map(e=>(0,a.tZ)(R,{mediaUpload:e.mediaUpload}))]})}function R(e){let{mediaUpload:t}=e,n=(0,B.kOB)(t);return(0,a.BX)(C.hs,{width:72,height:72,radius:"md",overflow:"hidden",sizing:"border-box",border:"detail",position:"relative",alignItems:"center",justifyContent:"center",flex:"auto",children:[(0,a.tZ)(l.e,{src:n,maxWidth:72,useRetinaSizing:!0,imageIsFixedWidth:!0,imageProps:{height:72,smartCrop:!0},className:U.Z.videoThumbnailImage}),(0,a.tZ)(x.f,{isPlaying:!1,size:40})]})}function j(e){var t,n,o,r,l,w;let{parent:C,attachment:I,readOnly:x,isRestack:B,isDm:O,isPermalink:U,isComposing:X,onAttachmentClick:N,onSavePostClick:R,onQuoteThemeChange:j,utm_content:J,compactIfPossible:W,item:z}=e,q=(0,c.rI)();if((0,T.bP)(I))return(0,a.tZ)(p.h,{attachment:I,readOnly:x,isRestack:B,onAttachmentClick:N,utm_content:J});if("live_stream"===I.type)return(0,a.tZ)(u.W,{activeLiveStream:I.active_live_stream,onAttachmentClick:N,maxWidth:_.PJ,videoPlayerProps:{surface:(0,Z.T)(q),entityType:"comment",entityKey:null!==(t=null==C?void 0:C.id)&&void 0!==t?t:"unknown",contentType:"comment",feedItemTrackingParameters:null==z?void 0:z.trackingParameters}});if("link"===I.type){let{linkMetadata:e}=I,t=(0,P.P9)(e.url),n=(0,P.A7)(e.url);if(t)return(0,a.tZ)(v.n,{videoId:t});if(n)return(0,a.tZ)(y.D,{videoId:n});let o=e.url&&(0,g.R)(e.url);return o?(0,a.tZ)(g.n,{embedType:o.embedType,resourceId:o.resourceId}):(0,a.tZ)(s.N,(0,i._)({readOnly:x,onClick:N},I.linkMetadata))}if("comment"===I.type)return(0,a.tZ)(d.UK,{parent:C,readOnly:x,publication:null!==(n=I.publication)&&void 0!==n?n:void 0,comment:I.comment,onAttachmentClick:N,utm_content:J,isDm:O,isPermalink:U});if("post"===I.type&&I.postSelection)return(0,a.tZ)(k.Kk,{readOnly:x,attachment:I,onClick:N,onSavePostClick:R,onThemeChange:j,isPermalink:U,isComposing:X,isRestack:B});if("post"===I.type&&I.postImageSelection)return(0,a.tZ)(f.w,{readOnly:x,onClick:N,onSavePostClick:R,attachment:I,utm_content:J});if("post"===I.type){let e=z&&(0,S.D2)(z,I)&&"post"===z.type?(null===(o=z.mediaClip)||void 0===o?void 0:o.clip_info)||(null===(r=I.mediaClip)||void 0===r?void 0:r.clip_info):(null===(l=I.mediaClip)||void 0===l?void 0:l.clip_info)||I.clipInfo,t=I.post.videoUpload;return e&&t?(0,a.tZ)(_.Jl,{tag:(0,a.tZ)(b.u0,{pub:I.publication,post:I.post,onViewEpisodeClick:N}),mediaUpload:t,composing:!1,videoPlayerProps:{surface:(0,Z.T)(q)}},I.id):(0,a.tZ)(m.tg,{clipInfo:e,readOnly:x,publication:I.publication,post:I.post,onClick:N,onSavePostClick:R,compact:W,item:z},I.id)}return"publication"===I.type?(0,a.tZ)(h.U,{publication:I.publication,readOnly:x,onClick:N}):"video"===I.type?(0,a.tZ)(_.Jl,{mediaUpload:I.mediaUpload,composing:!1,videoPlayerProps:{surface:(0,Z.T)(q),entityType:"comment",entityKey:null!==(w=null==C?void 0:C.id)&&void 0!==w?w:"unknown",contentType:"comment"}},I.mediaUpload.id):(0,a.tZ)(H,{attachment:I})}function H(e){let{}=e;return(0,a.tZ)(C.hs,{})}function J(e){switch(e.type){case"post":if(e.postSelection)return(0,O.uRy)(e.publication,e.post,{urlParams:{selection:e.postSelection.id}});return e.post.canonical_url;case"comment":return(0,O.Sgq)(e.comment);case"publication":return e.publication.base_url;case"link":var t;return null!==(t=e.linkMetadata.url)&&void 0!==t?t:null;default:return null}}function W(e){return{id:e.id,src:e.imageUrl,explicit:e.explicit,width:e.imageWidth,height:e.imageHeight}}},80143:function(e,t,n){n.d(t,{Y:()=>r}),n(16584);var i=n(98661),a=n(30396);let o=(0,i.createContext)({});function r(){return(0,a.qp)(o).entityKey}},61412:function(e,t,n){n.d(t,{B:()=>a});var i=n(30396);function a(e){let{name:t,action:n}=e;(0,i.d4)(()=>{if("undefined"==typeof window)return;let e=new URL(window.location.href);if(e.searchParams.get("action")===t){n();let t=e.searchParams;t.delete("action"),window.history.replaceState({},"","".concat(e.origin).concat(e.pathname,"?").concat(t))}},[])}}}]);