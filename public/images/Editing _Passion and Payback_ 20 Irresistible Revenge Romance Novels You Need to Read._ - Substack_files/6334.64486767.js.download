"use strict";(self.webpackChunksubstack=self.webpackChunksubstack||[]).push([["6334"],{36162:function(e,i,t){t.d(i,{Z:()=>n});let n={disclaimerBackground:"disclaimerBackground-Z_XOoY",disclaimerInner:"disclaimerInner-uCV9Hi",disclaimerText:"disclaimerText-wNhmzV",disclaimerIcon:"disclaimerIcon-cyNYUP",mobileContainer:"mobileContainer-ka2Ad3"}},99259:function(e,i,t){t.d(i,{Nj:()=>u});var n=t(16584),r=t(6400),o=t(30396),l=t(14293),a=t.n(l);function s(){return!!("undefined"==typeof window||a()(window.location)||a()(window.location.hostname))||window.location.hostname.startsWith("substack.com")||window.location.hostname.startsWith("substack.info")}let c=(0,r.createContext)({isOnDestination:s()});function u(e){let{children:i}=e,t=(0,o.Ye)(()=>({isOnDestination:s()}),[]);return(0,n.tZ)(c.Provider,{value:t,children:i})}c.displayName="IsDestinationContext"},85095:function(e,i,t){t.d(i,{Un:()=>d,am:()=>u});var n=t(16584),r=t(6400),o=t(30396),l=t(60807),a=t(48980),s=t(40121);let c=(0,r.createContext)({viewerProfile:{profile:null,loading:!1},setViewerProfile:()=>void 0,profiles:new Map,setProfile:()=>void 0});function u(e){let{value:i,handle:t,children:r}=e,[l,a]=(0,o.eJ)({profile:null,loading:!1}),[s,u]=(0,o.eJ)(new Map(i?[[t||i.id,{profile:i,loading:!1}]]:[])),d={viewerProfile:l,setViewerProfile:(0,o.I4)((e,i)=>{a(t=>t.profile===e&&t.loading===i?t:{profile:e,loading:i})},[]),profiles:s,setProfile:(0,o.I4)((e,i,t)=>{u(n=>{var r,o;if((null===(r=n.get(e))||void 0===r?void 0:r.profile)===i&&(null===(o=n.get(e))||void 0===o?void 0:o.loading)===t)return n;let l=new Map(n);return l.set(e,{profile:i,loading:t}),l})},[])};return(0,n.tZ)(c.Provider,{value:d,children:r})}function d(){let{subjectId:e,subjectName:i,delayLoading:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,l.aF)(),{viewerProfile:r,setViewerProfile:u,profiles:d,setProfile:p}=(0,o.qp)(c),[f,b]=(0,o.eJ)(null);if("string"==typeof e){if(e.includes("-")){let t=e.split("-");e=t[0],i=t.slice(1).join("-")}else e.startsWith("@")&&(e=e.slice(1))}let v=e?d.get(e):null,g=(0,o.I4)(async e=>{u(r.profile,!0);let i=(0,s.Hm)(e.name,{hashIfEmpty:!0});try{let t=await (0,a.rd)("/api/v1/user/".concat(e.id,"-").concat(i,"/public_profile/self"));u(t,!1)}catch(e){e instanceof Error&&b(e),u(null,!1)}},[r,u,b]),h=null==v?void 0:v.profile,m=r.profile,_=(0,o.I4)(async e=>{!m&&n&&g(n),p(e,h,!0);try{let t=i&&(0,s.Hm)(i,{hashIfEmpty:!0}),n=await (t?(0,a.rd)("/api/v1/user/".concat(e,"-").concat(t,"/public_profile")):(0,a.rd)("/api/v1/user/".concat(e,"/public_profile")));p(e,n,!1)}catch(i){i instanceof Error&&b(i),p(e,h,!1)}},[h,p,i,m,g,n]);return(0,o.d4)(()=>{t||(null==v?void 0:v.profile)||(null==v?void 0:v.loading)||f||!e||_(e),t||r.loading||r.profile||f||!n||g(n)},[t,e,_,v,f,r,g,n]),{loading:!!(null==v?void 0:v.loading),viewerProfile:r.profile,subjectProfile:null==v?void 0:v.profile,refetch:_,error:f}}c.displayName="ProfileContext"},98750:function(e,i,t){t.d(i,{UM:()=>l,th:()=>a});var n=t(30396),r=t(46914),o=t(98914);function l(e,i){let{root:t,threshold:o=0,rootMargin:l,disabled:a=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=(0,n.sO)(!1);!function(e,i){let{root:t,threshold:o=0,rootMargin:l,disabled:a=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=(0,r.z)(e=>{i(e.some(e=>e.isIntersecting),e)});(0,n.d4)(()=>{if("undefined"==typeof IntersectionObserver||!e.current||a)return;let i=new IntersectionObserver(s,{root:t,threshold:o,rootMargin:l});return i.observe(e.current),function(){i.disconnect()}},[t,o,l,a])}(e,e=>{e&&!s.current&&(s.current=!0,i())},{root:t,threshold:o,rootMargin:l,disabled:a||s.current})}function a(e){let[i,t]=(0,n.eJ)(!1);return(0,n.d4)(()=>{let i=()=>{let i=(0,o.dr)();t(i),null==e||e(i)};return(0,o.ut)(i),()=>{(0,o.kE)(i)}},[e]),i}},74312:function(e,i,t){t.d(i,{Oe:()=>p,W:()=>d,cr:()=>u});var n=t(7409),r=t(99282),o=t(98848),l=t(16584),a=t(6400),s=t(98661),c=t(7882);function u(e){return(0,a.createElement)(f,(0,r._)((0,n._)({},e),{key:e.module}))}function d(e){return(0,a.createElement)(b,(0,r._)((0,n._)({},e),{key:e.module,ref:e.innerRef}))}function p(e){let{module:i,onRequest:t,fetchImmediately:n=!0}=e,r=v.has(i),o=(0,c.Wf)(()=>g(i,t),[],{auto:n&&!r,initialResult:r?v.get(i):null});return o.error&&console.error(o.error),{error:o.error,isLoading:o.isLoading,result:o.result,fetch:o.refetch}}function f(e,i){var t;let{onRequest:a,resolve:c,module:u,whileLoading:d,ifError:f}=e,b=(0,o._)(e,["onRequest","resolve","module","whileLoading","ifError"]),{error:v,isLoading:g,result:h}=p({module:u,onRequest:a});return(0,l.tZ)(l.HY,{children:v?null!==(t=null!=f?f:d)&&void 0!==t?t:"Error":g||!h?null!=d?d:null:(0,s.createElement)(c(h),(0,r._)((0,n._)({},b),{ref:i}))})}let b=(0,s.forwardRef)(f),v=new Map;async function g(e,i){let t=v.get(e);return t||(t=await i(),v.set(e,t)),t}},64172:function(e,i,t){t.d(i,{Th:()=>g,Y0:()=>h,e:()=>v,lV:()=>f});var n=t(7409),r=t(99282),o=t(98848),l=t(6400),a=t(30396),s=t(45578),c=t.n(s),u=t(48980),d=t(17440);let p={hasLoadedOnce:!1,publications:[],subscriptions:[],publicationUsers:[],publicationMap:new Map,subscriptionMap:new Map,publicationUserMap:new Map,publicationsWithPledges:[]};function f(e){let{isLoggedIn:i,includePodcasts:t}=e,[o,l]=(0,a.eJ)((0,r._)((0,n._)({},p),{hasLoadedOnce:!i})),s=e=>{l(i=>{let t=c()([...i.publications,...e.publications],e=>e.id),r=c()([...i.subscriptions,...e.subscriptions],e=>e.publication_id),o=c()([...i.publicationUsers,...e.publicationUsers],e=>e.publication_id);return{hasLoadedOnce:!0,publications:t,subscriptions:r,publicationUsers:o,publicationMap:new Map(t.map(e=>[e.id,e])),subscriptionMap:new Map(r.map(e=>[e.publication_id,e])),publicationUserMap:new Map(o.map(e=>[e.publication_id,e])),publicationsWithPledges:[...i.publicationsWithPledges,...e.publicationsWithPledges],latestVoiceoverData:(0,n._)({},i.latestVoiceoverData,null==e?void 0:e.latestVoiceoverData),latestPodcastEpisodeData:(0,n._)({},i.latestPodcastEpisodeData,null==e?void 0:e.latestPodcastEpisodeData)}})};(0,a.d4)(()=>{if("serviceWorker"in navigator){let e=async e=>{var i;if((null===(i=e.data)||void 0===i?void 0:i.type)==="subscriptions-update"){let{payload:i}=e.data;i.ok&&s(i.json)}};return navigator.serviceWorker.addEventListener("message",e),()=>{navigator.serviceWorker.removeEventListener("message",e)}}},[]),(0,a.d4)(()=>{i&&(async()=>{try{for await(let e of m("/api/v1/subscriptions",{query:{include_podcasts:t?"1":void 0},getPageInit(e,i){let t=null==e?void 0:e.nextCursor;return t?(0,r._)((0,n._)({},i),{query:(0,r._)((0,n._)({},i.query),{cursor:t})}):null}}))s(e)}catch(e){console.warn(e)}})()},[i]);let f=(e,i)=>{let{subscription:t,publicationUser:o}=i;l(i=>(i=t?(0,r._)((0,n._)({},i),{subscriptions:i.subscriptions.map(e=>e.publication_id===t.publication_id?t:e),subscriptionMap:(0,d.Rg)(i.subscriptionMap,e,t)}):b(i,e),i=o?(0,r._)((0,n._)({},i),{publicationUsers:function(e,i,t){let n=(e=e.slice()).findIndex(i);return n>=0?e[n]=t:e.push(t),e}(i.publicationUsers,i=>i.publication_id===e,o),publicationUserMap:(0,d.Rg)(i.publicationUserMap,e,o)}):(0,r._)((0,n._)({},i),{publicationUsers:i.publicationUsers.filter(i=>i.publication_id!==e),publicationUserMap:(0,d.i4)(i.publicationUserMap,e)})))},v=async e=>{try{let i=await (0,u.rd)("/api/v1/subscription/".concat(e));f(e,i)}catch(i){i instanceof u.kp&&(404===i.response.status?l(i=>b(i,e)):console.error(i))}};return{result:o,isLoading:!1,hasLoadedOnce:o.hasLoadedOnce,refetch:async()=>o,refetchPublication:v,updatePublication:f,removeByPubId:e=>l(i=>b(i,e))}}function b(e,i){let t=e.subscriptions.filter(e=>e.publication_id!==i);return(0,r._)((0,n._)({},e),{subscriptions:t,subscriptionMap:new Map(t.map(e=>[e.publication_id,e]))})}let v=(0,l.createContext)({result:null,isLoading:!1,hasLoadedOnce:!1,refetch:()=>Promise.resolve(p),refetchPublication:()=>Promise.resolve(),updatePublication(){},removeByPubId:()=>{}});function g(){return(0,a.qp)(v)}function h(e){let{subscription:i,publicationUser:t,is_pledged:n}=function(e){var i;let{subscriptionMap:t,publicationUserMap:n,publicationsWithPledges:r}=null!==(i=g().result)&&void 0!==i?i:{subscriptionMap:new Map,publicationUserMap:new Map,publicationsWithPledges:[]};return{subscription:t.get(e),publicationUser:n.get(e),is_pledged:!!(null==r?void 0:r.includes(e))}}(e),r=(null==i?void 0:i.membership_state)==="free_signup",o=(null==i?void 0:i.membership_state)==="subscribed",l=!!(null==i?void 0:i.is_founding),a=!!(t&&["contributor","admin"].includes(t.role));return{subscription:i,publicationUser:t,isFreeSubscribed:r,isPaid:o,isSubscribed:r||o||a,isAuthor:a,isFounding:l,isPledged:n}}async function*m(e,i){var{getPageInit:t}=i,n=(0,o._)(i,["getPageInit"]);let r=await (0,u.rd)(e,n);yield r;let l=t(r,n);for(;null!=l;)r=await (0,u.rd)(e,l),yield r,l=t(r,n)}}}]);