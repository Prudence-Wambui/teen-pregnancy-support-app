"use strict";(self.webpackChunksubstack=self.webpackChunksubstack||[]).push([["7283"],{37358:function(e,t,i){i.d(t,{Z:()=>o});var n=i(7409),a=i(99282),r=i(16584),l=i(64515);let o=e=>(0,r.tZ)(l.l,(0,a._)((0,n._)({},e),{name:"InvertedWarningIcon",svgParams:{height:18,width:18},children:(0,r.tZ)("path",{d:"M9.00033 0.666992C4.39783 0.666992 0.666992 4.39783 0.666992 9.00033C0.666992 13.6028 4.39783 17.3337 9.00033 17.3337C13.6028 17.3337 17.3337 13.6028 17.3337 9.00033C17.3337 4.39783 13.6028 0.666992 9.00033 0.666992ZM9.00033 2.33366C12.682 2.33366 15.667 5.31866 15.667 9.00033C15.667 12.682 12.682 15.667 9.00033 15.667C5.31866 15.667 2.33366 12.682 2.33366 9.00033C2.33366 5.31866 5.31866 2.33366 9.00033 2.33366ZM8.16699 4.83366V9.83366H9.83366V4.83366H8.16699ZM8.16699 11.5003V13.167H9.83366V11.5003H8.16699Z"})}))},4564:function(e,t,i){i.d(t,{r:()=>C});var n=i(58865),a=i(16584),r=i(30396),l=i(80569),o=i.n(l),s=i(57391),c=i(95441),d=i(68833),u=i(7882),h=i(15771),p=i(19081),m=i(98248),b=i(58175),g=i(98750),_=i(82402),E=i(10510),v=i(60308),R=i(47929);let N=e=>{let{pubs:t,selected:i,setSelected:n,onRecommendationsFirstVisible:r}=e,l=e=>{let t=!1;i.includes(e)?n(i.filter(t=>t!==e)):(n([...i,e]),t=!0),(0,d.j)(d.FP.READER_ONBOARDING_RECOMMENDED_PUB_TOGGLED,{surface:"reader_onboarding",publication_id:e,added:t})};return(0,a.BX)(p.tu,{padding:8,style:{marginBottom:"20px"},children:[(0,a.tZ)(p.gq,{alignItems:"center",justifyContent:"end",children:(0,a.tZ)(b.xv.Meta,{onClick:()=>{(0,d.j)(d.FP.ALL_ONBOARDING_PUBLICATIONS_TOGGLED,{surface:"reader_onboarding",action:i.length<t.length?"select_all":"unselect_all",pubIds:t.map(e=>{let{id:t}=e;return t})}),i.length<t.length?n(t.map(e=>{let{id:t}=e;return t})):n([])},padding:4,cursor:"pointer",children:i.length<t.length?"Select all":"Unselect all"})}),(0,a.tZ)(p.tu,{divider:"detail",style:{overflow:"auto",height:"50vh",paddingBottom:20,paddingRight:8},children:t.map((e,t)=>(0,a.tZ)(Z,{pub:e,index:t,selected:i.includes(e.id),toggleSelected:()=>l(e.id),onRecommendationsFirstVisible:r},e.id))})]})},Z=e=>{let{pub:t,selected:i,index:n,toggleSelected:l,onRecommendationsFirstVisible:o}=e,s=(0,r.sO)(null);(0,g.UM)(s,()=>{o&&o(t,n)},{threshold:.5});let c=t.subdomain?"".concat((0,v.SVA)({subdomain:t.subdomain}),"/?utm_source=").concat(R.b3.homepageReaderOnboarding):void 0;return(0,a.BX)(p.gq,{alignItems:"start",justifyContent:"space-between",paddingY:12,children:[(0,a.BX)(p.gq,{alignItems:"start",justifyContent:"start",gap:8,children:[(0,a.tZ)(E.jM,{logoUrl:t.imageUrl,publicationName:t.name,pub:t,href:c}),(0,a.BX)(p.tu,{justifyContent:"start",alignItems:"start",gap:4,children:[(0,a.BX)(p.tu,{alignItems:"start",justifyContent:"center",children:[(0,a.tZ)(b.xv.H4,{children:t.name}),(0,a.tZ)(b.xv.B4,{color:"pub-secondary-text",children:t.subtitle})]}),t.description&&(0,a.tZ)(b.xv.B4,{color:"pub-secondary-text",textAlign:"left",children:t.description})]})]}),(0,a.tZ)(_.X,{checked:i,onChange:l,size:"md"})]})};var B=i(94827),y=i(76560),I=i(54093);let S={contentContainer:"contentContainer-A4QvRn"};function f(){let e=(0,n._)(["Select "," more to continue"]);return f=function(){return e},e}let A=e=>{var t,i,n,a,r;let l=[],o=new Set,s=null==e?void 0:null===(t=e.collections.find(e=>(null==e?void 0:e.title)==="\uD83D\uDC64️ For you"))||void 0===t?void 0:t.publications;if(s&&(l=s.slice(0,I.p)).forEach(e=>o.add(e.id)),l.length<I.p){let t=(null==e?void 0:null===(i=e.collections)||void 0===i?void 0:i.length)||0;if(t>=3){let t=0;for(;l.length<I.p;){let i=!1;for(let a=0;a<3;a++){let r=null==e?void 0:e.collections[a],s=null==r?void 0:null===(n=r.publications)||void 0===n?void 0:n[t];if(s&&!o.has(s.id)&&(l.push(s),i=!0,o.add(s.id),l.length>=I.p))break}if(!i)break;t++}}else{let i=0;for(;l.length<I.p;){let n=Math.floor(i/t),s=null==e?void 0:null===(a=e.collections)||void 0===a?void 0:a[i%t],c=null==s?void 0:null===(r=s.publications)||void 0===r?void 0:r[n];if(!c)break;!o.has(c.id)&&(l.push(c),o.add(c.id),i++)}}}return l},C=e=>{let{onCategoriesFinalized:t=null,setStep:i,handleError:n,pub:l=null,entry:g,user:_,setPreviousStepData:E,canBeSkipped:v=!1}=e,{iString:R,iPlural:Z,iTemplate:I}=(0,c.M1)(),{getExperimentVariant:C,exposeExperiment:P}=(0,s.jc)(),O=C("web_reader_onboarding_min_3_categories");P("web_reader_onboarding_min_3_categories");let[T,D]=(0,r.eJ)([]),[k,U]=(0,r.eJ)([]),[x,G]=(0,r.eJ)(!1),[X,L]=(0,r.eJ)([]),[w,F]=(0,r.eJ)(!1),{result:j,isLoading:z}=(0,u.ib)({pathname:"/api/v1/categories/recommended",auto:!0}),{result:W,isLoading:M,refetch:H}=(0,u.ib)({pathname:"/api/v1/onboarding/recommended",auto:!1});(0,r.d4)(()=>{(0,d.j)(d.FP.READER_ONBOARDING_CATEGORIES_SCREEN_SHOWN,{entry:g,hasSelectedCategories:x})},[g,x]),(0,r.d4)(()=>{if(x&&W&&!M){let e=A(W);0===e.length&&(0,d.j)(d.FP.READER_ONBOARDING_CATEGORIES_ERROR,{entry:g,error:"No recommendations found"}),U(e),e.some(e=>737237===e.id)&&L([737237])}},[W,M,x,g]);let J=null==j?void 0:j.categories,V=async()=>{try{let e={categoryIds:JSON.stringify(T)};await H({query:e})}catch(e){n(e,{ignore:!0}),i(y.c.PROFILE);return}for(let e of((0,d.j)(d.FP.READER_ONBOARDING_CATEGORIES_FINALIZED,{entry:g,numberOfCategories:T.length}),T))(0,d.j)(d.FP.READER_ONBOARDING_CATEGORY_REQUESTED,{entry:g,categoryId:e});G(!0),null==t||t()},K=async()=>{let e=_?_.profile_set_up_at?_.has_publication?y.c.APP_UPSELL:y.c.START_WRITING:y.c.PROFILE:y.c.SIGNUP;if(X.length>0)try{F(!0),(0,d.j)(d.FP.READER_ONBOARDING_BULK_SUBSCRIBE_SELECTED_IN_UI,{entry:g,numberOfSubscriptions:X.length,recommendationsFrom:"model"}),_?(await o().post("/api/v1/bulk_signup").send({publications:X,visibility:"public",source:"reader2-onboarding-modal"}),(0,d.j)(d.FP.READER_ONBOARDING_BULK_SUBSCRIBED,{entry:g,numberOfSubscriptions:X.length,recommendationsFrom:"model"})):E(y.c.CATEGORIES,{publications:X,selectedCategoryIds:T}),i(e)}catch(e){(0,d.j)(d.FP.READER_ONBOARDING_CATEGORIES_ERROR,{entry:g,error:e}),n(e,{ignore:!1})}else _?(0,d.j)(d.FP.READER_ONBOARDING_BULK_SUBSCRIBE_SKIPPED,{entry:g,recommendationsFrom:"model"}):E(y.c.CATEGORIES,{publications:[],selectedCategoryIds:T}),i(e)},Y="treatment"===O&&T.length<3;return x||0!==k.length?(0,a.BX)(p.tu,{children:[(0,a.BX)(p.tu,{children:[(0,a.tZ)(b.xv.H2,{translated:!0,children:"Creators you may like"}),(0,a.tZ)(b.xv.B2,{color:"pub-secondary-text",translated:!0,children:"We found some writers based on your interests."})]}),M?(0,a.tZ)(m.$j,{}):(0,a.tZ)(N,{pubs:k,selected:X,setSelected:L,onRecommendationsFirstVisible:(e,t)=>{(0,d.j)(d.FP.READER_ONBOARDING_PUB_RECOMMENDED,{entry:g,publication_id:e.id,suggestion_rank:t,recommendationFrom:"model"})}}),(0,a.BX)(p.tu,{children:[v&&(0,a.tZ)(h.zx,{className:"primary",onClick:()=>{(0,d.j)(d.FP.READER_ONBOARDING_BULK_SUBSCRIBE_SKIPPED,{entry:g,recommendationsFrom:"model"}),i(y.c.APP_UPSELL)},disabled:w,children:R("Skip for now")}),(0,a.BX)(h.zx,{className:"primary",onClick:K,disabled:w,children:[X.length>0&&Z("Subscribe and continue","Subscribe to %1 and continue",X.length),0===X.length&&R("Continue without subscribing")]})]})]}):(0,a.BX)(p.tu,{className:"categories-step",gap:2,children:[(0,a.BX)(p.tu,{children:[l?(0,a.BX)(p.tu,{children:[(0,a.tZ)(b.xv.H3,{translated:!0,children:"You're subscribed!"}),(0,a.tZ)(b.xv.B2,{color:"pub-secondary-text",translated:!0,children:"Now dive into your interests"})]}):(0,a.tZ)(b.xv.H3,{translated:!0,children:"Dive into your interests"}),(0,a.tZ)(b.xv.B2,{color:"pub-secondary-text",translated:!0,children:"We'll recommend top publications based on the topics you select."})]}),z?(0,a.tZ)(m.$j,{}):J?(0,a.tZ)(p.tu,{className:S.contentContainer,children:(0,a.tZ)(B.Rj,{hasFeatured:!1,categories:J,categoryIds:T,onCategoryClicked:e=>{let{categoryId:t}=e;if(T.includes(t)){var i;let e=null==J?void 0:null===(i=J.find(e=>(null==e?void 0:e.id)===t))||void 0===i?void 0:i.subcategories;D(T.filter(i=>i!==t&&!(null==e?void 0:e.some(e=>e.id===i))))}else D([...T,t])},ranking:"all",defaultExpanded:!0})}):(0,a.tZ)(p.tu,{className:S.contentContainer,children:(0,a.tZ)(b.xv.B2,{translated:!0,children:"Something went wrong."})}),(0,a.tZ)(h.zx,{className:"primary",onClick:V,disabled:Y,children:"treatment"!==O?R("Continue"):T.length<3?I(f(),3-T.length):R("Continue")})]})}},341:function(e,t,i){i.d(t,{Z:()=>p});var n=i(16584),a=i(30396),r=i(83034),l=i(57391),o=i(68833),s=i(15771),c=i(19081),d=i(58175),u=i(81821),h=i(47929);function p(e){let{onComplete:t}=e,{getExperimentVariant:i}=(0,l.jc)();(0,a.d4)(()=>(0,o.j)(o.FP.READER_ONBOARDING_APP_UPSELL_SHOWN),[]);let p=(0,u.tq)()&&"treatment_no_skip"===i("reader_onboarding_app_first");return(0,n.BX)(c.tu,{paddingTop:24,gap:12,children:[(0,n.tZ)(d.xv.H1,{weight:"heavy",children:"Download the Substack app"}),(0,n.tZ)(d.xv.B3,{children:"Get the best reading experience on Android and iOS."}),(0,n.tZ)(r.AppInstallContent,{utm_campaign:h.VX.readerOnboarding,utm_source:h.b3.substack}),!p&&(0,n.tZ)("div",{className:"modal-ctas",children:(0,n.tZ)(s.zx,{priority:"primary",onClick:t,children:"Continue"})})]})}},307:function(e,t,i){i.d(t,{Z:()=>b});var n=i(16584),a=i(30396),r=i(50486),l=i(95441),o=i(98750),s=i(98914),c=i(10510),d=i(58175),u=i(60308),h=i(84864),p=i(47929);let m=e=>{let{pub:t,authorFirst:i,selected:l,setSelected:m,onRecommendationFirstVisible:b,index:g}=e,_=(0,a.sO)(null);(0,o.UM)(_,()=>{b&&b(t,g)},{threshold:.5});let E="".concat((0,u.SVA)(t),"/?utm_source=").concat(p.b3.homepageReaderOnboarding);return(0,n.BX)("div",{className:"bulk-subscribe-row",ref:_,children:[(0,n.tZ)("div",{className:"icon-column",children:(0,n.tZ)(c.wk,{pub:t,size:52})}),(0,n.BX)("div",{className:"right-column",children:[(0,n.BX)("div",{className:"top-right",children:[(0,n.tZ)("div",{className:"info",children:i?(0,n.BX)(n.HY,{children:[(0,n.tZ)("h4",{children:(0,n.tZ)("a",{href:E,native:!0,target:"_blank",children:t.author_name})}),(0,n.BX)("p",{children:["Writes ",t.name]})]}):(0,n.BX)(n.HY,{children:[(0,n.tZ)("h4",{children:(0,n.tZ)("a",{href:E,native:!0,target:"_blank",children:t.name})}),(0,n.BX)("p",{children:["By ",t.author_name]})]})}),(0,n.tZ)(r.p,{name:t.name,checked:l,onChange:()=>m(!l)})]}),(0,n.tZ)("div",{className:"bottom-right",children:(0,n.tZ)(d.xv.B4,{color:"secondary",className:"description",children:(0,h.truncateText)(t.editorial_bio||t.hero_text,(0,s.K1)()?90:120)})})]})]})},b=e=>{let{publications:t,authorFirst:i,selected:a,setSelected:r,renderRow:o,onRecommendationFirstVisible:s}=e,{iString:c}=(0,l.M1)(),d=a.length<t.length?(0,n.tZ)("button",{className:"small",onClick:()=>r(t.map(e=>{let{id:t}=e;return t})),children:c("Select all")}):(0,n.tZ)("button",{className:"small",onClick:()=>r([]),children:c("Unselect all")}),u=e=>t=>t?r([...a.filter(t=>t!==e.id),e.id]):r(a.filter(t=>t!==e.id));return(0,n.BX)(n.HY,{children:[(0,n.tZ)("div",{className:"bulk-action-row",children:d}),(0,n.tZ)("div",{id:"bulk-subscribe",className:"bulk-subscribe",children:t.map((e,t)=>o?o({pub:e,selected:a.includes(e.id),setSelected:u(e)}):(0,n.tZ)(m,{pub:e,selected:a.includes(e.id),setSelected:u(e),authorFirst:i,index:t,onRecommendationFirstVisible:s},e.id))})]})}},57601:function(e,t,i){i.d(t,{Z:()=>N});var n=i(16584),a=i(30396),r=i(94184),l=i.n(r),o=i(23279),s=i.n(o),c=i(80569),d=i.n(c),u=i(29493),h=i(37358),p=i(51214),m=i(68833),b=i(15771),g=i(19081),_=i(58175),E=i(76560),v=i(84864);let R={right:"right-XckP6Z",liveUpdatingInput:"liveUpdatingInput-AypZsP",invalid:"invalid-mVGeLg",narrower:"narrower-nMJULR",autoMargins:"autoMargins-UJ_Q1X",mobileAwareWidth:"mobileAwareWidth-lMCXnu",borderedBox:"borderedBox-PucNvX",errorText:"errorText-XpsJyQ",aTag:"aTag-yo_zoZ"},N=e=>{let{user:t,setStep:i,entry:r,setPreviousStepData:o}=e,c=(0,a.sO)(null),N=(0,a.sO)(null),[Z,B]=(0,a.eJ)(""),[y,I]=(0,a.eJ)([]),[S,f]=(0,a.eJ)(!1),[A,C]=(0,a.eJ)(!1),[P,O]=(0,a.eJ)(!1);(0,a.d4)(()=>{let e=async()=>{try{let e=await d().get("/api/v1/publication/suggestion");e.body.subdomain&&(f(!0),B(e.body.subdomain))}catch(e){console.error("Failed to get subdomain suggestion:",e)}};A||(C(!0),(0,m.j)(m.FP.READER_ONBOARDING_CREATE_PUBLICATION_STEP_STARTED,{entry:r}),e(),C(!1))},[A,C,r]);let T=s()(e=>{D(e)},500),D=async e=>{let t=e.target.value;if(B(t),0===t.length){I([]);return}try{(await d().get("/api/v1/check_subdomain",{subdomain:t})).body.available?(f(!0),I([])):(f(!1),I([{msg:"This URL is taken. Try another."}]))}catch(t){var i,n;let e=[];null===(n=t.response.body)||void 0===n||null===(i=n.errors)||void 0===i||i.forEach(i=>{(!(t.response.body.errors.length>1)||"Please enter a valid web URL (letters and numbers only)"!==i.msg)&&e.push(i)}),f(!1),I(e)}},k=async()=>{var e,n,a,l,s;try{let a=(await d().post("/api/v1/publication").send({name:"".concat((0,v.guessFirstName)(null!==(n=null==t?void 0:t.name)&&void 0!==n?n:null)||"My"," Publication"),subdomain:Z,hero_text:"Welcome to my publication",tos:!0,captcha_response:P&&(null==N?void 0:null===(e=N.current)||void 0===e?void 0:e.getResponse())})).body;o(E.c.CREATE_PUBLICATION,{createdPub:a}),i(E.c.CREATE_PUBLICATION_SUCCESS)}catch(t){if((0,m.j)(m.FP.READER_ONBOARDING_CREATE_PUBLICATION_STEP_ERROR,{entry:r,message:t.toString()}),401===t.response.statusCode){O(!0),f(!1),I([]);return}let e=[];null===(l=t.response.body)||void 0===l||null===(a=l.errors)||void 0===a||a.forEach(i=>{(!(t.response.body.errors.length>1)||"Please enter a valid web URL (letters and numbers only)"!==i.msg)&&e.push(i)}),(null===(s=t.response.body)||void 0===s?void 0:s.error)&&e.push({msg:t.response.body.error}),f(!1),I(e)}};return(0,n.BX)(g.tu,{gap:32,paddingTop:48,className:R.mobileAwareWidth,children:[(0,n.tZ)(_.xv.H1,{children:"Create your publication"}),(0,n.BX)(g.tu,{className:R.borderedBox,gap:56,paddingTop:56,paddingBottom:32,paddingX:{mobile:12,desktop:48},radius:"md",children:[(0,n.BX)(g.tu,{gap:16,children:[(0,n.tZ)(_.xv.B3,{align:"left",weight:"bold",children:"Publication URL"}),(0,n.BX)(g.gq,{gap:12,alignItems:"center",children:[(0,n.tZ)("input",{ref:c,type:"text",name:"subdomain",id:"subdomain",onInput:e=>{T(e)},value:Z,className:l()(R.liveUpdatingInput,{["".concat(R.invalid)]:y.length})}),(0,n.tZ)(_.xv.B3,{children:".substack.com"}),(0,n.tZ)(g.hs,{className:R.right,children:S&&!y.length?(0,n.tZ)(p.Z,{isStatic:!0,height:18,fill:"#4c3",stroke:"#4c3"}):(0,n.tZ)(h.Z,{height:16,width:16,fill:"#D72B2B",stroke:"#D72B2B",strokeWidth:0})})]}),P&&(0,n.tZ)(u.Z,{ref:N}),(y.length>0||P)&&(0,n.BX)(g.tu,{gap:8,children:[y.map(e=>(0,n.tZ)(_.xv.B4,{className:R.errorText,align:"left",children:e.msg})),P&&(0,n.tZ)(_.xv.B4,{className:R.errorText,align:"left",children:"Please complete the captcha to continue"})]})]}),(0,n.tZ)(g.tu,{gap:24,children:(0,n.tZ)(b.zx,{size:"lg",onClick:k,disabled:y.length>0,children:"Continue"})})]}),(0,n.tZ)(g.hs,{className:R.autoMargins,alignItems:"center",children:(0,n.BX)(_.xv.B4,{color:"secondary",className:R.narrower,children:["By signing up, you agree to"," ",(0,n.tZ)("a",{className:R.aTag,href:"https://substack.com/pa",target:"_blank",rel:"noopener",children:"our publisher agreement"}),","," ",(0,n.tZ)("a",{className:R.aTag,href:"https://substack.com/ccpa#personal-data-collected",target:"_blank",rel:"noopener",children:"information collection notice"}),", and"," ",(0,n.tZ)("a",{className:R.aTag,href:"https://substack.com/privacy",target:"_blank",rel:"noopener",children:"privacy policy"})]})})]})}},64799:function(e,t,i){i.d(t,{Z:()=>u});var n=i(16584),a=i(30396),r=i(68833),l=i(15771),o=i(19081),s=i(58175),c=i(76560),d=i(60308);let u=e=>{let{setStep:t,entry:i,previousStepData:u}=e;return(0,a.d4)(()=>{(0,r.j)(r.FP.READER_ONBOARDING_CREATE_PUBLICATION_SUCCESS_STEP_STARTED,{entry:i})}),(0,n.BX)(o.tu,{gap:48,paddingBottom:120,alignItems:"center",children:[(0,n.tZ)("img",{className:"image-OdneRK",src:(0,d.zF4)("/img/reader_onboarding/car.png",264)}),(0,n.BX)(o.tu,{gap:4,children:[(0,n.tZ)(s.xv.H1,{children:"Success!"}),(0,n.tZ)(s.xv.B3,{children:"You're all set! Head over to your dashboard and tell the world about your Susbtack"})]}),(0,n.BX)(o.tu,{className:"buttonGroup-HpHxnd",gap:4,children:[(0,n.tZ)(l.zx,{size:"lg",onClick:()=>{window.location.href=(0,d.QK7)(u[c.c.CREATE_PUBLICATION].createdPub,{addBase:!0})},children:"Visit writer dashboard"}),(0,n.tZ)(l.zx,{size:"lg",priority:"secondary",onClick:()=>{(0,r.j)(r.FP.READER_ONBOARDING_CREATE_PUBLICATION_SUCCESS_STEP_SKIPPED,{entry:i}),t(c.c.APP_UPSELL)},children:"Visit later"})]})]})}},14861:function(e,t,i){i.d(t,{Z:()=>l});var n=i(16584),a=i(55438),r=i(15771);let l=e=>{let{close:t}=e;return(0,n.BX)("div",{className:"welcome-step",children:[(0,n.BX)("div",{className:"headings",children:[(0,n.tZ)(a.Z,{className:"substack",width:72,height:72}),(0,n.tZ)("h3",{children:"Something went wrong"}),(0,n.tZ)("p",{children:"We're sorry for the inconvenience."})]}),(0,n.tZ)("div",{className:"spacer"}),(0,n.tZ)("div",{className:"spacer"}),(0,n.tZ)("div",{className:"modal-ctas",children:(0,n.tZ)(r.zx,{priority:"secondary",onClick:t,children:"Close"})})]})}},45930:function(e,t,i){i.d(t,{Z:()=>g});var n=i(7409),a=i(99282),r=i(16584),l=i(30396),o=i(94184),s=i.n(o),c=i(80569),d=i.n(c),u=i(86092),h=i(60807),p=i(68833),m=i(48980),b=i(76560);let g=e=>{let{setStep:t,handleError:i,user:o,entry:c,followUserIds:g,redirectAfterProfile:_=!1,barebones:E=!1}=e,[v,R]=(0,l.eJ)(null),[N,Z]=(0,l.eJ)(!1),B=o?o.id:null,{setUser:y}=(0,h.SE)();(0,l.d4)(()=>{(async()=>{if(null==g?void 0:g.length)try{await (0,m.rd)("/api/v1/feed/bulk-follow",{method:"POST",json:{surface:"post-follow-referrer-prompt",userIds:g}})}catch(e){console.error("could not bulk-follow",e)}})()},[g]),(0,l.d4)(()=>{(0,p.j)(p.FP.READER_ONBOARDING_PROFILE_SETUP_STARTED,{entry:c});let e=async()=>{try{var e;let t=(await d().get("/api/v1/user/".concat(B,"/profile/edit"))).body;t&&!t.profile_set_up_at&&(null===(e=t.subscriptions)||void 0===e?void 0:e.length)>0&&(t.subscriptions=t.subscriptions.map(e=>(0,a._)((0,n._)({},e),{visibility:"public"}))),R(t)}catch(e){i(e,{ignore:!0}),t(b.c.APP_UPSELL)}};B&&e()},[i,t,B,c]);let I=!!(null==v?void 0:v.profile_set_up_at);return(0,r.BX)(r.HY,{children:[(0,r.BX)("div",{className:s()("profile-step",{hidden:!N}),children:[(0,r.tZ)("h3",{children:"Subscriptions displayed on profile"}),(0,r.tZ)("p",{children:"Subscriptions appear on your profile by default, but you can choose to hide some or all of them"}),(0,r.tZ)(u.FQ,{profile:v,onFinalizeVisibility:()=>Z(!1),onSetVisibility:e=>{if(!v){console.warn("No profile, cannot set visibility");return}R((0,a._)((0,n._)({},v),{subscriptions:[...v.subscriptions.map(t=>{let i=e[t.publication.id];return i?(0,a._)((0,n._)({},t),{visibility:i}):t})]}))},source:"homepage-reader-onboarding"})]}),(0,r.BX)("div",{className:s()("profile-step",{hidden:N}),children:[(0,r.tZ)("h3",{children:"Tell us about yourself"}),(0,r.tZ)("p",{children:"Add your name, a profile picture, and a bit more about who you are."}),(0,r.tZ)(u._0,{pageTitle:"",user:o,freeSignup:!0,freeSignupEmail:null,needsPhoto:!1,optionalPhoto:!0,isPostInvite:!1,primaryEligiblePublications:[],onSuccess:e=>{let i=null==e?void 0:e.body;i&&y(i),_?t(b.c.EXIT):t(b.c.APP_UPSELL)},onEditReadVisibility:()=>{Z(!0),(0,p.j)(p.FP.READER_ONBOARDING_PROFILE_SETUP_SKIPPED,{entry:c})},numVisibleSubscriptions:(null==v?void 0:v.subscriptions.filter(e=>{let{visibility:t}=e;return"public"===t}).length)||0,numSubscriptions:(null==v?void 0:v.subscriptions.length)||0,complete:!0,text:"Continue",profileExists:I,prepareData:e=>(e.reads_visibility=(null==v?void 0:v.subscriptions.map(e=>{let{id:t,visibility:i}=e;return{id:t,visibility:i}}))||[],e),barebones:E})]})]})}},76971:function(e,t,i){i.d(t,{Z:()=>p});var n=i(16584),a=i(20253),r=i(35047),l=i(35702),o=i(68833),s=i(65205),c=i(15771),d=i(10510),u=i(76560),h=i(60308);let p=e=>{let{pub:t,user:i,setStep:p,entry:m}=e;return(0,n.tZ)("div",{className:"pub-landing-step",children:(0,n.BX)(a.ZP,{method:"post",action:"/api/v1/reader/signup/pub",loading:!1,autoLock:!0,onSuccess:e=>{(0,o.j)(o.FP.READER_ONBOARDING_PUB_LANDING_SIGNUP_SUCCEEDED,{entry:m}),i||(0,l.a)({user:e.body.user}),p(u.c.CATEGORIES)},children:[(0,n.BX)("div",{className:"headings",children:[(0,n.tZ)(d.wk,{pub:t,size:84}),(0,n.tZ)("h3",{className:"publication-title",children:t.name}),(0,n.tZ)("p",{className:"publication-description",children:t.editorial_bio||t.hero_text}),(0,n.tZ)("p",{className:"publication-details",children:(0,r.sv)(t)})]}),(0,n.tZ)("input",{type:"hidden",name:"email",value:null==i?void 0:i.email}),(0,n.tZ)("input",{type:"hidden",name:"source",value:"".concat(m,"-reader-onboarding")}),(0,n.tZ)("input",{type:"hidden",name:"publication_id",value:t.id}),(0,n.tZ)("input",{type:"hidden",name:"visibility",value:"public"}),(0,n.tZ)("input",{type:"hidden",name:"noWelcomeEmail",value:"true"}),(0,n.tZ)("input",{type:"hidden",name:"first_url",value:s.xY}),(0,n.tZ)("input",{type:"hidden",name:"first_referrer",value:s.ip}),(0,n.tZ)("input",{type:"hidden",name:"first_session_url",value:s.ac}),(0,n.tZ)("input",{type:"hidden",name:"first_session_referrer",value:s.qR}),(0,n.tZ)("input",{type:"hidden",name:"current_url",value:s.UE}),(0,n.tZ)("input",{type:"hidden",name:"current_referrer",value:s.xU}),(0,n.BX)("div",{className:"modal-ctas",children:[(0,n.tZ)("a",{className:"button let-me-read",href:(0,h.n1t)((0,h.SVA)(t),{no_cover:!0,utm_source:"".concat(m,"-reader-onboarding")}),onClick:()=>{(0,o.j)(o.FP.READER_ONBOARDING_PUB_LANDING_LET_ME_READ_CLICKED,{entry:m}),(0,o.x6)(t,m)},children:"Let me read it first"}),(0,n.tZ)(c.zx,{priority:"primary",onClick:e=>{(0,o.j)(o.FP.READER_ONBOARDING_PUB_LANDING_SUBSCRIBE_CLICKED,{entry:m}),i||(e.preventDefault(),p(u.c.PUB_SIGNUP))},type:"submit",children:"Subscribe"})]})]})})}},48146:function(e,t,i){i.d(t,{Z:()=>E});var n=i(16584),a=i(30396),r=i(20253),l=i(35047),o=i(60807),s=i(35702),c=i(68833),d=i(65205),u=i(15771),h=i(19081),p=i(10510),m=i(58175),b=i(57641),g=i(76560),_=i(60308);let E=e=>{let{pub:t,user:i,profile:E,setStep:v,entry:R}=e,{setUser:N}=(0,o.SE)(),[Z,B]=(0,a.eJ)(""),[y,I]=(0,a.eJ)(!1),[S,f]=(0,a.eJ)(!1);return(0,n.BX)("div",{className:"pub-signup-step",children:[(0,n.BX)("div",{className:"headings",children:[(0,n.tZ)(p.wk,{pub:t,size:84,className:"pub-icon"}),(0,n.tZ)("h3",{className:"publication-title",children:E?"Create an account to start reading":"Subscribe to ".concat(t.name)}),(0,n.tZ)("p",{className:"publication-description",children:E?"Create a Substack account to subscribe to ".concat(E.name):t.editorial_bio||t.hero_text}),(0,n.tZ)("p",{className:"publication-details",children:E?"Author of ".concat(t.name):(0,l.sv)(t)})]}),(0,n.BX)(r.ZP,{method:"post",action:"/api/v1/reader/signup/pub",loading:!1,autoLock:!0,onSuccess:e=>{i||((0,s.a)({user:e.body.user}),N(e.body.user)),e.body.requires_confirmation?((0,c.j)(c.FP.READER_ONBOARDING_PUB_SIGNUP_FAILED,{reason:"user_exists",entry:R}),I(!0)):((0,c.j)(c.FP.READER_ONBOARDING_PUB_SIGNUP_SUCCEEDED,{entry:R}),(0,s.a)({user:e.body.user}),v(g.c.CATEGORIES))},children:[(0,n.BX)("p",{children:[(0,n.tZ)("label",{for:"email",children:"Email"}),(0,n.tZ)("input",{type:"email",name:"email","aria-label":"Email",value:Z,tabIndex:0,onInput:e=>{B(e.target.value)},onChange:e=>{B(e.target.value)}}),(0,n.tZ)("input",{type:"hidden",name:"source",value:"".concat(R,"-reader-onboarding")}),(0,n.tZ)("input",{type:"hidden",name:"publication_id",value:t.id}),(0,n.tZ)("input",{type:"hidden",name:"visibility",value:"public"}),(0,n.tZ)("input",{type:"hidden",name:"noWelcomeEmail",value:"true"}),(0,n.tZ)("input",{type:"hidden",name:"first_url",value:d.xY}),(0,n.tZ)("input",{type:"hidden",name:"first_referrer",value:d.ip}),(0,n.tZ)("input",{type:"hidden",name:"first_session_url",value:d.ac}),(0,n.tZ)("input",{type:"hidden",name:"first_session_referrer",value:d.qR}),(0,n.tZ)("input",{type:"hidden",name:"current_url",value:d.UE}),(0,n.tZ)("input",{type:"hidden",name:"current_referrer",value:d.xU}),y&&(0,n.BX)("div",{className:"error",children:["Additional confirmation is required to complete your signup. Please"," ",(0,n.tZ)("a",{href:(0,_.uXE)({for_pub:t.subdomain,email:Z}),children:"login"})," ","or click the confirmation link in your email."]})]}),(0,n.tZ)("div",{id:"error-container"}),(0,n.BX)(h.tu,{alignItems:"center",justifyContent:"space-between",paddingTop:64,gap:4,children:[(0,n.tZ)(b.O,{checked:S,onCheckboxChange:e=>{f(e)}}),(0,n.tZ)(u.zx,{type:"submit",priority:"primary",disabled:!S||!Z,style:{marginTop:12,marginBottom:4},children:"Subscribe and continue"}),(0,n.BX)(m.xv.B5,{weight:"light",color:"secondary",children:["Already have a Substack account?"," ",(0,n.tZ)(m.xv.B5,{as:"a",weight:"light",color:"secondary",href:(0,_.uXE)({for_pub:t.subdomain}),target:"_blank",style:{textDecoration:"underline"},children:"Sign in"})]})]})]})]})}},48450:function(e,t,i){i.d(t,{Z:()=>R});var n=i(16584),a=i(30396),r=i(94184),l=i.n(r),o=i(80569),s=i.n(o),c=i(20253),d=i(55438),u=i(60807),h=i(35702),p=i(68833),m=i(82402),b=i(19081),g=i(58175),_=i(91021),E=i(76560),v=i(60308);function R(e){var t,i,r,o,d;let{user:R,setStep:Z,entry:B,previousStepData:y,prefilledEmail:I,skipCategories:S=!1}=e,{setUser:f}=(0,u.SE)(),[A,C]=(0,a.eJ)(null!=I?I:""),[P,O]=(0,a.eJ)(!1),[T,D]=(0,a.eJ)(!1);(0,a.d4)(()=>{R&&!y[E.c.CATEGORIES]&&Z(E.c.CATEGORIES)},[R,Z,y]);let[k,U]=(0,a.eJ)(!1),x=async e=>{if(e.body.userExists){O(!0);return}if(e.body.emailConfirmationRequired){D(!0);return}if((0,p.j)(p.FP.READER_ONBOARDING_SIGNUP_SUCCEEDED,{entry:B}),R||((0,h.a)({user:e.body.user}),f(e.body.user)),y[E.c.CATEGORIES]){var t;e.body.userExists?Z(E.c.APP_UPSELL):Z(E.c.PROFILE);let i=null===(t=y[E.c.CATEGORIES])||void 0===t?void 0:t.publications;(null==i?void 0:i.length)?(await s().post("/api/v1/bulk_signup").send({publications:i,visibility:"public",source:"".concat(B,"-reader-onboarding"),email:A}),(0,p.j)(p.FP.READER_ONBOARDING_BULK_SUBSCRIBED,{entry:B,numberOfSubscriptions:i.length,recommendationsFrom:"categories"})):(0,p.j)(p.FP.READER_ONBOARDING_BULK_SUBSCRIBE_SKIPPED,{entry:B,recommendationsFrom:"categories"})}else S?Z(E.c.PROFILE):Z(E.c.CATEGORIES)};if(T)return(0,n.BX)(b.tu,{className:"signup-step",children:[(0,n.tZ)(N,{title:"Verify your email address"}),(0,n.BX)(g.xv.B3,{children:["We just sent an email to ",(0,n.tZ)("strong",{children:A}),". Please check your inbox before continuing."]}),(0,n.tZ)(b.hs,{flex:"grow"}),(0,n.tZ)("div",{className:"modal-ctas",children:(0,n.tZ)(_.A,{onClick:e=>{e.preventDefault(),D(!1)},children:(0,n.tZ)(g.xv,{as:"span",decoration:"hover-underline",children:"Or edit your email address or try again."})})})]});let G=null!==(o=null===(t=y[E.c.CATEGORIES])||void 0===t?void 0:t.publications)&&void 0!==o?o:[],X=null!==(d=null===(i=y[E.c.CATEGORIES])||void 0===i?void 0:i.selectedCategoryIds)&&void 0!==d?d:[];return(0,n.BX)("div",{className:"signup-step",children:[(0,n.tZ)(N,{title:"Sign up to subscribe",subtitle:"Substack is the home for great writing."}),(0,n.BX)(c.ZP,{method:"post",action:"/api/v1/reader/signup/just_email",loading:!1,autoLock:!0,onSuccess:x,children:[(0,n.tZ)("input",{type:"hidden",name:"publicationIds",value:G.join(",")}),(0,n.tZ)("input",{type:"hidden",name:"selectedCategoryIds",value:X.join(",")}),(0,n.BX)("p",{children:[(0,n.tZ)("label",{for:"email",children:"Your email address"}),(0,n.tZ)("input",{type:"email",name:"email","aria-label":"Email",value:A,tabIndex:0,onInput:e=>{C(e.target.value)},onChange:e=>{C(e.target.value)}}),P&&(0,n.BX)("div",{className:"error",children:["This email is already registered with Substack. Please"," ",(0,n.tZ)("a",{native:!0,href:(0,v.Zdb)(),children:"sign in to continue"}),"."]}),T&&(0,n.tZ)("div",{className:"error",children:"We have sent you a confirmation email. Please check your inbox before continuing."})]}),(0,n.tZ)("div",{id:"error-container"}),(0,n.BX)(b.tu,{gap:16,children:[(0,n.BX)(b.gq,{as:"label",gap:8,className:"checkboxLabel-gCoESV",children:[(0,n.tZ)(m.X,{checked:k,onChange:e=>{U(e)},size:"sm"}),(0,n.tZ)(b.tu,{flex:"grow",children:(0,n.BX)(g.xv.B3,{as:"span",textAlign:"left",children:["I agree to Substack’s"," ",(0,n.tZ)("a",{href:(0,v._QN)(),target:"_blank",children:"Terms of Use"})," ","and acknowledge its"," ",(0,n.tZ)("a",{href:(0,v.WFt)(),target:"_blank",children:"Information Collection Notice"})," ","and"," ",(0,n.tZ)("a",{href:(0,v.Zzu)(),target:"_blank",children:"Privacy Policy"})]})})]}),(0,n.tZ)("button",{className:l()("button primary",{disabled:!k},"noMargin-hNmNqv"),type:"submit",disabled:!k,children:y[E.c.CATEGORIES]&&(null===(r=y[E.c.CATEGORIES])||void 0===r?void 0:r.publications.length)?"Subscribe and join Substack":"Get started"}),(0,n.BX)(g.xv.B3,{children:["Already have a Substack account?"," ",(0,n.tZ)("a",{native:!0,href:(0,v.Zdb)(),children:"Sign in"})]})]})]})]})}function N(e){let{title:t,subtitle:i}=e;return(0,n.BX)("div",{className:"headings",children:[(0,n.tZ)(d.Z,{className:"substack",width:68,height:68}),(0,n.tZ)("h3",{children:t}),i&&(0,n.tZ)("p",{children:i})]})}},7759:function(e,t,i){i.d(t,{Z:()=>u});var n=i(16584),a=i(30396),r=i(68833),l=i(15771),o=i(19081),s=i(58175),c=i(76560),d=i(60308);let u=e=>{let{setStep:t,entry:i}=e;return(0,a.d4)(()=>{(0,r.j)(r.FP.READER_ONBOARDING_START_WRITING_STEP_STARTED,{entry:i})}),(0,n.BX)(o.tu,{alignItems:"center",gap:48,paddingBottom:120,children:[(0,n.tZ)("img",{className:"image-eElYa7",src:(0,d.zF4)("/img/reader_onboarding/jobpage_penholder.png",150)}),(0,n.BX)(o.tu,{gap:4,children:[(0,n.tZ)(s.xv.H1,{children:"Want to start writing on Substack?"}),(0,n.tZ)(s.xv.B3,{color:"secondary",children:"Write posts, grow your audience, and make money on Substack"})]}),(0,n.BX)(o.tu,{className:"buttonGroup-BqeO0U",gap:4,children:[(0,n.tZ)(l.zx,{size:"lg",onClick:()=>t(c.c.CREATE_PUBLICATION),children:"Create my publication"}),(0,n.tZ)(l.zx,{size:"lg",priority:"secondary",onClick:()=>{(0,r.j)(r.FP.READER_ONBOARDING_START_WRITING_STEP_SKIPPED,{entry:i}),t(c.c.APP_UPSELL)},children:"Skip for now"})]})]})}},29191:function(e,t,i){i.d(t,{Z:()=>s});var n=i(16584),a=i(55438),r=i(68833),l=i(15771),o=i(76560);let s=e=>{let{pub:t=null,profile:i,entry:s,setStep:c}=e;return(0,n.BX)("div",{className:"welcome-step",children:[(0,n.BX)("div",{className:"headings",children:[(0,n.tZ)(a.Z,{className:"substack",width:68,height:68}),(0,n.tZ)("h3",{children:"You're all set up"}),(0,n.BX)("p",{children:["You will now start receiving new posts from"," ",i?(0,n.BX)(n.HY,{children:[(0,n.tZ)("b",{children:i.name})," and the other writers"]}):t?(0,n.BX)(n.HY,{children:[(0,n.tZ)("b",{children:t.name})," and the other publications"]}):"the publications"," ","you subscribed to. Happy reading!"]})]}),(0,n.tZ)("div",{className:"spacer"}),(0,n.tZ)("div",{className:"spacer"}),(0,n.tZ)("div",{className:"modal-ctas",children:(0,n.BX)(l.zx,{priority:"primary",onClick:()=>{(0,r.j)(r.FP.READER_ONBOARDING_START_READING_CLICKED,{entry:s}),c(o.c.EXIT)},children:["Start reading",i?" ".concat(i.name):t?" ".concat(t.name):""]})})]})}},76560:function(e,t,i){i.d(t,{c:()=>n});let n={SIGNUP:"SIGNUP",PUB_LANDING:"PUB_LANDING",PUB_SIGNUP:"PUB_SIGNUP",CATEGORIES:"CATEGORIES",CATEGORIES_SUGGESTIONS:"CATEGORIES_SUGGESTIONS",PROFILE:"PROFILE",START_WRITING:"START_WRITING",CREATE_PUBLICATION:"CREATE_PUBLICATION",CREATE_PUBLICATION_SUCCESS:"CREATE_PUBLICATION_SUCCESS",WELCOME:"WELCOME",ERROR:"ERROR",EXIT:"EXIT",APP_UPSELL:"APP_UPSELL"}},54093:function(e,t,i){i.d(t,{p:()=>n});let n=7}}]);